import{d as z,by as H,h as B,E as I,cc as K,ch as Q,c7 as J,c as v,bv as X,cl as Z,ad as tt,K as et,r as c,e as n,o,w as i,j as l,f as a,m as g,q as R,k as r,_ as b,t as p,a as _,y as w,D as y,Q as N,U as it,T as at,bs as lt,bt as ot}from"./index-jY1EWd09.js";import{_ as rt}from"./GameConfigActionArchive.vue_vue_type_script_setup_true_lang-C-TX7Hm5.js";import{_ as st}from"./GameConfigActionPublish.vue_vue_type_script_setup_true_lang-CgSuEWlv.js";import{C as T}from"./CoreUiPlacement-BNT2Q2Hu.js";import{_ as nt}from"./GameConfigBuildModal.vue_vue_type_script_setup_true_lang-Cdx6kZFB.js";import{_ as ut}from"./MTabLayout.vue_vue_type_script_setup_true_lang-B1ekLQtC.js";import{_ as dt}from"./MRawDataCard.vue_vue_type_script_setup_true_lang-Db7v8Vrj.js";import{_ as mt,a as ft}from"./MViewContainer.vue_vue_type_script_setup_true_lang-C_1W2rCL.js";import{_ as vt}from"./MActionModalButton.vue_vue_type_script_setup_true_lang-CTycXHot.js";import{_ as gt}from"./MInputText.vue_vue_type_script_setup_true_lang-Wwv8TYAB.js";import{_ as pt}from"./MInputTextArea.vue_vue_type_script_setup_true_lang-BahEDGWU.js";import"./MInputCheckbox.vue_vue_type_script_setup_true_lang-Bzg4Lkt_.js";import"./MInputHintMessage.vue_vue_type_script_setup_true_lang-CYiRxbPX.js";import"./MActionModal.vue_vue_type_script_setup_true_lang-CihjvaoM.js";import"./index-qe4CXcF2.js";import"./MInputSingleSelectRadio-BM2VfYc3.js";import"./index-Dec9dGh3.js";import"./MetaGeneratedForm.vue_vue_type_script_setup_true_lang-C4tXbiPC.js";import"./GeneratedUiFormDynamicComponent.vue_vue_type_script_setup_true_lang-YgpMK99r.js";import"./MInputMultiSelectCheckbox.vue_vue_type_script_setup_true_lang-BmEacL49.js";import"./MInputSingleSelectDropdown.vue_vue_type_script_setup_true_lang-CqJL3vnO.js";import"./MSingleColumnLayout-BSf_YwiY.js";import"./debounce-DkFP0rfT.js";import"./isSymbol-B-tfGeoT.js";const bt={class:"font-weight-bold"},ct={key:1,class:"text-muted tw-italic"},_t={key:2,class:"text-muted tw-italic"},wt={key:1,class:"text-muted tw-italic"},yt={class:"font-weight-bold"},Ct={class:"font-weight-bold"},ht={key:0,class:"text-monospace small"},kt={key:1,class:"text-muted tw-italic"},xt={key:0,class:"text-monospace small"},Qt=z({__name:"GameConfigDetailView",setup(St){const D=lt(),C=H();B();const{refresh:$}=I(K());if(C.params.id===void 0)throw new Error("id route param is required.");const{data:t,error:V,refresh:G}=I(Q(J(C.params.id))),m=v(()=>t.value?.id);X().setDynamicTitle(t,u=>`View ${u.value?.name??"Config"}`);const h=v(()=>t.value?.contents?.serverLibraries?.PlayerExperiments??0),k=v(()=>{const u=[];if(t.value?.publishBlockingErrors.length)u.push({title:"Unpublishable Game Config",message:"This game config has errors and can not be published.",variant:"danger",dataTest:"cannot-publish-alert"});else if(t.value?.status==="Building")u.push({title:"Config Building...",message:"This game config is still building and has no content to view for now.",variant:"warning",dataTest:"building-alert"});else if(t.value?.libraryImportErrors&&Object.keys(t.value.libraryImportErrors).length>0)u.push({title:"Library Errors",message:"One or more libraries failed to import.",variant:"danger",dataTest:"libraries-fail-to-parse-alert"});else if(t.value?.buildReportSummary?.totalLogLevelCounts.Warning){const e=t.value.buildReportSummary.totalLogLevelCounts.Warning??0;u.push({title:`${t.value.buildReportSummary.totalLogLevelCounts.Warning} Build Warnings`,message:`There ${Z(e,"was","were")} ${tt(e,"warning",!0)} when building this config.
        You can still publish it, but it may not work as expected. You can view the full build log for more information.`,variant:"warning",dataTest:"build-warnings-alert"})}return u}),O=v(()=>k.value.find(u=>u.variant==="danger")?"danger":k.value.find(u=>u.variant==="warning")?"warning":void 0),f=B({name:"",description:"",isArchived:!1});function W(){f.value={name:t.value?.name??"",description:t.value?.description??"",isArchived:t.value?.isArchived??!1}}const{showSuccessNotification:P}=ot();async function U(){const u={name:f.value.name,description:f.value.description,isArchived:f.value.isArchived};await D.post(`/gameConfig/${m.value}`,u),P("Game config updated."),$(),G()}const F=v(()=>t.value?.isActive?"Cannot diff this config against itself.":t.value?.status==="Building"?"Cannot diff a config while it's being built":t.value?.fullConfigVersion?void 0:"Cannot diff a config that failed to build."),E=B(0);et(t,u=>{if(u&&u.publishBlockingErrors.length>0&&!C.query.tab){for(const e of u.publishBlockingErrors)if(e.errorType==="BlockingMessages"){E.value=1;break}}},{immediate:!0});const M=v(()=>[{label:"Details"},{label:"Build Log",highlighted:t.value&&t.value.publishBlockingErrors.length>0},{label:"Audit Log"}]),q=v(()=>{let u="Rebuilt copy of "+t.value?.name||t.value?.id;return t.value?.description&&(u+=`
`+t.value.description),u}),j=v(()=>t.value?.status==="Building"?"Cannot rebuild a config while it's being built":t.value?.rebuildBlockedReasons!==null?t.value?.rebuildBlockedReasons.join(`\r
`):void 0);return(u,e)=>{const x=c("fa-icon"),s=c("b-td"),d=c("b-tr"),S=c("b-tbody"),A=c("b-table-simple"),Y=c("meta-username");return o(),n(a(ft),{variant:O.value,"is-loading":!a(t),error:a(V),"full-width":"",alerts:k.value,permission:"api.game_config.view"},{overview:i(()=>[a(t)?(o(),n(a(mt),{key:0,title:a(t).name||"No Name Available",subtitle:a(t).description,id:m.value,"data-testid":"game-config-detail-overview-card"},{buttons:i(()=>[m.value?(o(),n(rt,{key:0,gameConfigId:m.value,"trigger-style":"button"},null,8,["gameConfigId"])):g("",!0),l(a(vt),{"modal-title":"Edit Game Config Archive",action:U,"trigger-button-label":"Edit","ok-button-label":"Update",permission:"api.game_config.edit","trigger-button-full-width":"",onShow:W,"data-testid":"edit-config"},{default:i(()=>[l(a(gt),{class:"tw-mb-2",label:"Name","model-value":f.value.name,variant:f.value.name.length>0?"success":void 0,placeholder:"For example: 1.0.4 release candidate","onUpdate:modelValue":e[0]||(e[0]=L=>f.value.name=L)},null,8,["model-value","variant"]),l(a(pt),{label:"Description","model-value":f.value.description,variant:f.value.description.length>0?"success":void 0,placeholder:"What is unique about this config build that will help you find it later?",rows:3,"onUpdate:modelValue":e[1]||(e[1]=L=>f.value.description=L)},null,8,["model-value","variant"])],void 0,!0),_:1}),l(a(at),{"disabled-tooltip":F.value,to:`diff?newRoot=${m.value}`,"full-width":""},{default:i(()=>[...e[30]||(e[30]=[r("Diff to Active",-1)])],void 0,!0),_:1},8,["disabled-tooltip","to"]),m.value?(o(),n(st,{key:1,gameConfigId:m.value,publishBlocked:a(t)?.publishBlockingErrors.length>0},null,8,["gameConfigId","publishBlocked"])):g("",!0),l(nt,{"default-build-params":a(t)?.contents?.metaData.buildParams,title:"Rebuild "+a(t).name,"ok-button-label":"Rebuild","trigger-button-label":"Rebuild","default-game-config-name":"Copy of "+a(t).name||a(t).id,"default-game-config-description":q.value,mode:"rebuild","trigger-button-disabled-tooltip":j.value},null,8,["default-build-params","title","default-game-config-name","default-game-config-description","trigger-button-disabled-tooltip"])]),default:i(()=>[R("span",bt,[l(x,{icon:"chart-bar"}),e[2]||(e[2]=r(" Overview",-1))]),l(A,{small:"",responsive:""},{default:i(()=>[l(S,null,{default:i(()=>[l(d,null,{default:i(()=>[l(s,null,{default:i(()=>[...e[3]||(e[3]=[r("Status",-1)])],void 0,!0),_:1}),l(s,{class:"tw-text-right"},{default:i(()=>[a(t).isArchived?(o(),n(a(b),{key:0,class:"tw-mr-1",variant:"neutral"},{default:i(()=>[...e[4]||(e[4]=[r("Archived",-1)])],void 0,!0),_:1})):g("",!0),a(t).isActive?(o(),n(a(b),{key:1,class:"tw-mr-1",variant:"success"},{default:i(()=>[...e[5]||(e[5]=[r("Active",-1)])],void 0,!0),_:1})):(o(),n(a(b),{key:2},{default:i(()=>[...e[6]||(e[6]=[r("Not active",-1)])],void 0,!0),_:1}))],void 0,!0),_:1})],void 0,!0),_:1}),l(d,null,{default:i(()=>[l(s,null,{default:i(()=>[...e[7]||(e[7]=[r("Experiments",-1)])],void 0,!0),_:1}),h.value===void 0?(o(),n(s,{key:0,class:"text-right text-muted tw-italic"},{default:i(()=>[...e[8]||(e[8]=[r("Loading...",-1)])],void 0,!0),_:1})):h.value>0?(o(),n(s,{key:1,class:"tw-text-right"},{default:i(()=>[r(p(h.value),1)],void 0,!0),_:1})):(o(),n(s,{key:2,class:"text-right text-muted tw-italic"},{default:i(()=>[...e[9]||(e[9]=[r("None",-1)])],void 0,!0),_:1}))],void 0,!0),_:1}),l(d,null,{default:i(()=>[l(s,null,{default:i(()=>[...e[10]||(e[10]=[r("Last Published At",-1)])],void 0,!0),_:1}),l(s,{class:"tw-text-right"},{default:i(()=>[a(t)?.publishedAt?(o(),n(a(w),{key:0,instant:a(y).fromISO(a(t)?.publishedAt),showAs:"relativeSentenceCase"},null,8,["instant"])):a(t)?.isActive?(o(),_("span",ct,"No time recorded")):(o(),_("span",_t,"Never"))],void 0,!0),_:1})],void 0,!0),_:1}),l(d,null,{default:i(()=>[l(s,null,{default:i(()=>[...e[11]||(e[11]=[r("Last Unpublished At",-1)])],void 0,!0),_:1}),l(s,{class:"tw-text-right"},{default:i(()=>[a(t)?.unpublishedAt?(o(),n(a(w),{key:0,instant:a(y).fromISO(a(t)?.unpublishedAt),showAs:"relativeSentenceCase"},null,8,["instant"])):(o(),_("span",wt,"Never"))],void 0,!0),_:1})],void 0,!0),_:1})],void 0,!0),_:1})],void 0,!0),_:1}),R("span",yt,[l(x,{icon:"chart-bar"}),e[12]||(e[12]=r(" Build Status",-1))]),l(A,{small:"",responsive:""},{default:i(()=>[l(S,null,{default:i(()=>[l(d,null,{default:i(()=>[l(s,null,{default:i(()=>[...e[13]||(e[13]=[r("Build Status",-1)])],void 0,!0),_:1}),l(s,{class:"tw-text-right"},{default:i(()=>[a(t)?.status==="Success"?(o(),n(a(b),{key:0,variant:"success"},{default:i(()=>[r(p(a(t)?.status),1)],void 0,!0),_:1})):g("",!0),a(t)?.status==="Failed"?(o(),n(a(b),{key:1,variant:"danger"},{default:i(()=>[r(p(a(t)?.status),1)],void 0,!0),_:1})):g("",!0),a(t)?.status==="Building"?(o(),n(a(b),{key:2,variant:"primary"},{default:i(()=>[r(p(a(t)?.status),1)],void 0,!0),_:1})):g("",!0)],void 0,!0),_:1})],void 0,!0),_:1}),l(d,null,{default:i(()=>[l(s,null,{default:i(()=>[...e[14]||(e[14]=[r("Built By",-1)])],void 0,!0),_:1}),l(s,{class:"tw-text-right"},{default:i(()=>[a(t).source==="disk"?(o(),n(a(b),{key:0},{default:i(()=>[...e[15]||(e[15]=[r("Built-in with the server",-1)])],void 0,!0),_:1})):(o(),n(Y,{key:1,username:a(t).source},null,8,["username"]))],void 0,!0),_:1})],void 0,!0),_:1}),l(d,{class:N({"text-danger":a(t).buildReportSummary?.totalLogLevelCounts.Error})},{default:i(()=>[l(s,null,{default:i(()=>[...e[16]||(e[16]=[r("Logged Errors",-1)])],void 0,!0),_:1}),a(t)?.buildReportSummary?.totalLogLevelCounts.Error?(o(),n(s,{key:0,class:"tw-text-right"},{default:i(()=>[r(p(a(t).buildReportSummary?.totalLogLevelCounts.Error),1)],void 0,!0),_:1})):a(t)?.buildReportSummary===null?(o(),n(s,{key:1,class:"text-right text-muted tw-italic"},{default:i(()=>[...e[17]||(e[17]=[r("Not available",-1)])],void 0,!0),_:1})):(o(),n(s,{key:2,class:"text-right text-muted tw-italic"},{default:i(()=>[...e[18]||(e[18]=[r("None",-1)])],void 0,!0),_:1}))],void 0,!0),_:1},8,["class"]),l(d,{class:N({"text-warning":a(t)?.buildReportSummary?.totalLogLevelCounts.Warning})},{default:i(()=>[l(s,null,{default:i(()=>[...e[19]||(e[19]=[r("Logged Warnings",-1)])],void 0,!0),_:1}),a(t)?.buildReportSummary?.totalLogLevelCounts.Warning?(o(),n(s,{key:0,class:"tw-text-right"},{default:i(()=>[r(p(a(t).buildReportSummary?.totalLogLevelCounts.Warning),1)],void 0,!0),_:1})):a(t)?.buildReportSummary===null?(o(),n(s,{key:1,class:"text-right text-muted tw-italic"},{default:i(()=>[...e[20]||(e[20]=[r("Not available",-1)])],void 0,!0),_:1})):(o(),n(s,{key:2,class:"text-right text-muted tw-italic"},{default:i(()=>[...e[21]||(e[21]=[r("None",-1)])],void 0,!0),_:1}))],void 0,!0),_:1},8,["class"])],void 0,!0),_:1})],void 0,!0),_:1}),R("span",Ct,[l(x,{icon:"chart-bar"}),e[22]||(e[22]=r(" Technical Details",-1))]),l(A,{small:"",responsive:""},{default:i(()=>[l(S,null,{default:i(()=>[l(d,null,{default:i(()=>[l(s,null,{default:i(()=>[...e[23]||(e[23]=[r("Built At",-1)])],void 0,!0),_:1}),l(s,{class:"tw-text-right"},{default:i(()=>[l(a(w),{instant:a(y).fromISO(a(t)?.buildStartedAt),showAs:"relativeSentenceCase"},null,8,["instant"])],void 0,!0),_:1})],void 0,!0),_:1}),l(d,null,{default:i(()=>[l(s,null,{default:i(()=>[...e[24]||(e[24]=[r("Last Modified At",-1)])],void 0,!0),_:1}),l(s,{class:"tw-text-right"},{default:i(()=>[a(t)?(o(),n(a(w),{key:0,instant:a(y).fromISO(a(t)?.lastModifiedAt),showAs:"relativeSentenceCase"},null,8,["instant"])):g("",!0)],void 0,!0),_:1})],void 0,!0),_:1}),l(d,null,{default:i(()=>[l(s,null,{default:i(()=>[...e[25]||(e[25]=[r("Full Config Archive Version",-1)])],void 0,!0),_:1}),a(t)?(o(),n(s,{key:1,class:"tw-text-right"},{default:i(()=>[a(t)?.fullConfigVersion?(o(),_("div",ht,p(a(t).fullConfigVersion),1)):(o(),_("div",kt,"Not available"))],void 0,!0),_:1})):(o(),n(s,{key:0,class:"text-right text-muted tw-italic"},{default:i(()=>[...e[26]||(e[26]=[r("Loading...",-1)])],void 0,!0),_:1}))],void 0,!0),_:1}),l(d,null,{default:i(()=>[l(s,null,{default:i(()=>[...e[27]||(e[27]=[r("Client Facing Version",-1)])],void 0,!0),_:1}),a(t)?(o(),n(s,{key:1,class:"tw-text-right"},{default:i(()=>[a(t)?.cdnVersion?(o(),_("div",xt,p(a(t).cdnVersion),1)):(o(),n(a(it),{key:1,class:"text-muted tw-italic",content:"Only available for the currently active game config."},{default:i(()=>[...e[29]||(e[29]=[r("Not available",-1)])],void 0,!0),_:1}))],void 0,!0),_:1})):(o(),n(s,{key:0,class:"text-right text-muted tw-italic"},{default:i(()=>[...e[28]||(e[28]=[r("Loading...",-1)])],void 0,!0),_:1}))],void 0,!0),_:1})],void 0,!0),_:1})],void 0,!0),_:1})],void 0,!0),_:1},8,["title","subtitle","id"])):g("",!0)]),default:i(()=>[l(a(ut),{tabs:M.value,"current-tab":E.value},{"tab-0":i(()=>[l(T,{placementId:"GameConfigs/Details/Tab0",gameConfigId:m.value,alwaysFullWidth:""},null,8,["gameConfigId"])]),"tab-1":i(()=>[l(T,{placementId:"GameConfigs/Details/Tab1",gameConfigId:m.value},null,8,["gameConfigId"])]),"tab-2":i(()=>[l(T,{placementId:"GameConfigs/Details/Tab2",gameConfigId:m.value},null,8,["gameConfigId"])]),_:1},8,["tabs","current-tab"]),l(a(dt),{data:a(t),label:"gameConfigData"},null,8,["data"])]),_:1},8,["variant","is-loading","error","alerts"])}}});export{Qt as default};
