import{d as S,E as $,cc as R,h as A,c as b,ad as r,cl as a,r as N,e as x,o as l,w as m,q as i,j as u,f as c,t as d,a as v,k as T,m as G,ah as V,bs as B,e5 as D,bt as Y}from"./index-jY1EWd09.js";import{_ as j}from"./MActionModalButton.vue_vue_type_script_setup_true_lang-CTycXHot.js";import{_ as E}from"./MInputSwitch.vue_vue_type_script_setup_true_lang-D2jAqk4R.js";import"./MActionModal.vue_vue_type_script_setup_true_lang-CihjvaoM.js";import"./index-qe4CXcF2.js";import"./MInputHintMessage.vue_vue_type_script_setup_true_lang-CYiRxbPX.js";const I={key:0},M={key:1},P={key:0,class:"tw-ml-1"},O={class:"tw-flex tw-justify-end"},U={class:"tw-flex tw-justify-between"},L=S({__name:"RemoveArchivedGameConfigs",setup(q){const{data:f,refresh:w}=$(R()),g=B(),n=A(!1);function _(){n.value=!1}const{showSuccessNotification:k,showErrorNotification:p}=Y();async function y(){const o=await g.delete("gameConfig/deleteArchived");let e;do await D(1e3),e=(await g.get("backgroundTasks?taskId="+o.data)).data;while(e!=null&&!e.completed);e!=null?e.failure===void 0||e.failure==null?k(s.value.removed):(console.error(e.failure),p("Failed to remove archived game configs, see logs for more information.")):p("We lost track of the archived game config removal, likely due to the server restarting."),w()}const t=b(()=>{if(f.value)return f.value.reduce((o,e)=>e.isArchived?o+1:o,0)}),s=b(()=>{const o=t.value??0;return{subtitle:`You have ${r(o,"archived game config",!0)} that ${a(o,"is","are")} not being used.`,prune:`You can prune ${a(o,"it","them")} here to keep your server running smoothly.`,modalDescription:`You currently have ${r(o,"archived game config",!0)}. ${a(o,"This config is","These configs are")} not being used and can be safely removed. Removing ${a(o,"this config","these configs")} will improve your server performance.`,noSeatbelts:`Removing ${a(o,"this","these")} ${r(o,"archived game config",!0)} from the server is permanent - ${a(o,"it","they")} can not be recovered.`,removed:`Removed ${r(o,"archived game config",!0)}.`}});return(o,e)=>{const C=N("MetaNoSeatbelts");return l(),x(c(V),{title:"Remove Archived Configs","is-loading":t.value===void 0},{subtitle:m(()=>[t.value===0?(l(),v("p",I,"You have no archived game configs to remove.")):(l(),v("p",M,[T(d(s.value.subtitle),1),t.value&&t.value>0?(l(),v("span",P,d(s.value.prune),1)):G("",!0)]))]),default:m(()=>[i("div",O,[u(c(j),{"modal-title":"Remove Archived Configs",action:y,"trigger-button-label":"Open Removal Menu","trigger-button-disabled-tooltip":t.value===0?"There are no archived game configs to remove.":void 0,"ok-button-label":"Remove","ok-button-disabled-tooltip":n.value?void 0:"Toggle the confirmation switch to enable.",permission:"api.game_config.delete",onShow:e[1]||(e[1]=h=>_())},{default:m(()=>[i("p",null,d(s.value.modalDescription),1),e[3]||(e[3]=i("h6",{class:"tw-mt-3"},"Confirm",-1)),i("p",U,[e[2]||(e[2]=i("span",{class:"tw-font-normal"},"I know what I am doing",-1)),u(c(E),{"model-value":n.value,name:"confirmRemoval",size:"small","onUpdate:modelValue":e[0]||(e[0]=h=>n.value=h)},null,8,["model-value"])]),u(C,{class:"tw-mt-4",message:s.value.noSeatbelts},null,8,["message"])]),_:1},8,["trigger-button-disabled-tooltip","ok-button-disabled-tooltip"])])],void 0,!0),_:1},8,["is-loading"])}}});export{L as default};
