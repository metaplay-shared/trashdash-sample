import{d as E,E as C,cE as h,c as g,r as z,e as b,o as f,w as a,j as r,f as t,x as N,k as n,t as o,ae as c,q as i,a as $,m as x}from"./index-jY1EWd09.js";import{M as l,a as u}from"./metaListUtils-B-xQ0HnD.js";import{_ as P}from"./MetaAudienceSizeEstimate.vue_vue_type_script_setup_true_lang-wU-8cgN7.js";import{M as V}from"./MSingleColumnLayout-BSf_YwiY.js";import{_ as A}from"./MRawDataCard.vue_vue_type_script_setup_true_lang-Db7v8Vrj.js";import{_ as L,a as M}from"./MViewContainer.vue_vue_type_script_setup_true_lang-C_1W2rCL.js";import"./MAbbreviateNumber.vue_vue_type_script_setup_true_lang-C_9AAI8F.js";import"./numberUtils-CkF0oMe2.js";const k={class:"small text-muted"},D={key:0,class:"small text-muted"},B={class:"font-weight-bold"},F={class:"font-weight-bold"},T={class:"font-weight-bold"},H=E({__name:"SegmentListView",setup(O){const{data:s,error:y}=C(h()),v=g(()=>s.value?.segments),S=[l.asUnsorted(),new l("Name","info.displayName",u.Ascending),new l("Name","info.displayName",u.Descending),new l("Audience Size Estimate","sizeEstimate",u.Ascending),new l("Audience Size Estimate","sizeEstimate",u.Descending)],m=g(()=>s.value?.playerScanErrorCount&&s.value?.scannedPlayersCount?s.value?.playerScanErrorCount/s.value?.scannedPlayersCount*100:0),_=g(()=>{const p=[];return m.value>5&&p.push({variant:"warning",title:`Warning: ${m.value.toFixed(2)}% errors encountered`,message:`The segment size estimator encountered ${m.value.toFixed(2)}% error rate while scanning for players (${s.value?.playerScanErrorCount} out of ${s.value?.scannedPlayersCount} players). This can affect the accuracy of the segment size estimates. See the server logs for more information.`}),p});return(p,e)=>{const w=z("meta-list-card");return f(),b(t(M),{permission:"api.segmentation.view","is-loading":!t(s),error:t(y),alerts:_.value},{overview:a(()=>[r(t(L),{title:"View Player Segments","data-testid":"player-segment-list-overview-card"},{default:a(()=>[e[7]||(e[7]=i("p",{class:"tw-mb-1"},"Player segments are dynamic sets of players based on their game state.",-1)),i("p",k,[e[1]||(e[1]=n("Players can enter and leave segments as their play the game and belong to multiple segments at once. You can define your own properties to segment players with and then create the actual segments in your ",-1)),r(t(c),{to:"/gameConfigs"},{default:a(()=>[...e[0]||(e[0]=[n("game configs",-1)])],void 0,!0),_:1}),e[2]||(e[2]=n(".",-1))]),t(s)?.playerScanErrorCount&&t(s).playerScanErrorCount>0?(f(),$("p",D,[e[3]||(e[3]=n("The segment size estimator encountered (",-1)),i("span",B,o(m.value?.toFixed(2)||0),1),e[4]||(e[4]=n(")% error rate while scanning for players (",-1)),i("span",F,o(t(s).playerScanErrorCount||0),1),e[5]||(e[5]=n(" out of ",-1)),i("span",T,o(t(s).scannedPlayersCount||0),1),e[6]||(e[6]=n(" players scanned). See the server logs for more information.",-1))])):x("",!0)],void 0,!0),_:1})]),default:a(()=>[r(t(V),null,{default:a(()=>[r(w,{title:"All Segments",itemList:v.value,searchFields:["info.displayName","info.description"],sortOptions:S,pageSize:20,emptyMessage:"No player segments. Set them up in your game configs to start using the feature!","data-testid":"player-segment-list-all-segments-card"},{"item-card":a(({item:d})=>[r(t(N),null,{"top-right":a(()=>[r(P,{sizeEstimate:d.sizeEstimate},null,8,["sizeEstimate"])]),"bottom-left":a(()=>[n(o(d.info.description),1)]),"bottom-right":a(()=>[r(t(c),{to:`/segments/${d.info.segmentId}`,"data-testid":"view-segment"},{default:a(()=>[...e[8]||(e[8]=[n("View segment",-1)])],void 0,!0),_:1},8,["to"])]),default:a(()=>[n(o(d.info.displayName),1)],void 0,!0),_:2},1024)]),_:1},8,["itemList"])],void 0,!0),_:1}),r(t(A),{data:t(s)?.segments,label:"segments"},null,8,["data"])],void 0,!0),_:1},8,["is-loading","error","alerts"])}}});export{H as default};
