import{d as k,E as P,c as b,D as o,r as _,e as u,o as l,w as i,j as m,f as t,x,I as M,k as r,t as c,q as h,ae as N,a as E,y as v,B as w,_ as f,e1 as L}from"./index-jY1EWd09.js";import{M as p,a as y,b as $,c as S}from"./metaListUtils-B-xQ0HnD.js";import{g as C}from"./leagueUtils-BqF6ffxm.js";import{a as A}from"./leagues-Dvm7dNz9.js";const B={key:0},V={key:1},R=k({__name:"LeagueSeasonsCard",props:{leagueId:{}},setup(g){const T=g,{data:s}=P(A(T.leagueId)),D=b(()=>{const d=[];if(s.value.state.historicSeasons){const e=s.value.state.historicSeasons.map(n=>({name:"Season "+n.seasonId,id:n.seasonId,endTime:o.fromISO(n.endTime),startTime:o.fromISO(n.startTime),totalParticipants:n.totalParticipants,startedEarly:n.startedEarly,endedEarly:n.endedEarly,onSchedule:!n.startedEarly&&!n.endedEarly}));d.push(...e)}if(s.value.state.currentSeason){const e=s.value.state.currentSeason,n={name:"Season "+e.seasonId,id:e.seasonId,endTime:o.fromISO(e.endTime),startTime:o.fromISO(e.startTime),totalParticipants:s.value.currentParticipantCount,startedEarly:e.startedEarly,endedEarly:e.endedEarly,onSchedule:!e.startedEarly&&!e.endedEarly,currentSeason:!0};d.push(n)}return d}),I=[new p("Start time","startTime",y.Descending),new p("Start time","startTime",y.Ascending),new p("Participants","totalParticipants",y.Descending),new p("Participants","totalParticipants",y.Ascending)],O=[new $("startedEarly",[new S("Started early",d=>d.startedEarly,!1),new S("Ended early",d=>d.endedEarly,!1),new S("On schedule",d=>d.onSchedule,!1)])];return(d,e)=>{const n=_("meta-list-card");return l(),u(n,{title:"All Seasons","item-list":D.value,searchFields:["name"],"sort-options":I,emptyMessage:"No seasons are available to view.",filterSets:O,"data-testid":"league-seasons-list-card"},{"item-card":i(({item:a})=>[m(t(x),null,M({"top-right":i(()=>[a.startedEarly&&!a.endedEarly?(l(),u(t(f),{key:0,variant:"warning"},{default:i(()=>[...e[1]||(e[1]=[r("Started Early",-1)])],void 0,!0),_:1})):!a.startedEarly&&a.endedEarly?(l(),u(t(f),{key:1,variant:"warning"},{default:i(()=>[...e[2]||(e[2]=[r("Ended Early",-1)])],void 0,!0),_:1})):a.startedEarly&&a.endedEarly?(l(),u(t(f),{key:2,variant:"warning"},{default:i(()=>[...e[3]||(e[3]=[r("Started & Ended Early",-1)])],void 0,!0),_:1})):(l(),u(t(f),{key:3,variant:"success"},{default:i(()=>[...e[4]||(e[4]=[r("On Schedule",-1)])],void 0,!0),_:1}))]),"bottom-left":i(()=>[a.endTime.diffNow().toMillis()>0&&t(s).schedule?(l(),E("span",B,[r(c(a.startTime>t(o).utc()?"Starting":"Started")+" ",1),m(t(v),{instant:t(o).fromISO(a.startTime)},null,8,["instant"]),e[5]||(e[5]=r(" and will end in ",-1)),m(t(w),{duration:a.endTime.diffNow(),showAs:"exactDuration",hideMilliseconds:!0},null,8,["duration"]),e[6]||(e[6]=r(".",-1))])):(l(),E("span",V,[e[7]||(e[7]=r("Ended ",-1)),m(t(v),{instant:t(o).fromISO(a.endTime)},null,8,["instant"]),e[8]||(e[8]=r(" after running for ",-1)),m(t(w),{duration:a.endTime.diff(a.startTime),showAs:"exactDuration",hideMilliseconds:""},null,8,["duration"]),e[9]||(e[9]=r(".",-1))]))]),"bottom-right":i(()=>[h("div",null,c(a.totalParticipants)+" participants",1),m(t(N),{to:`/leagues/${g.leagueId}/${a.id}`,permission:"api.leagues.view"},{default:i(()=>[...e[10]||(e[10]=[r("View season",-1)])],void 0,!0),_:1},8,["to"])]),default:i(()=>[r(c(a.name),1)],void 0,!0),_:2},[a.currentSeason&&t(s).enabled?{name:"badge",fn:i(()=>[t(s).enabled?(l(),u(t(f),{key:0,variant:t(C)(t(s).currentOrNextSeasonSchedule?.currentPhase.phase)},{default:i(()=>[r(c(t(L)(t(s).currentOrNextSeasonSchedule?.currentPhase.phase)),1)],void 0,!0),_:1},8,["variant"])):(l(),u(t(f),{key:1,variant:"danger"},{default:i(()=>[...e[0]||(e[0]=[r("Disabled",-1)])],void 0,!0),_:1}))]),key:"0"}:void 0]),1024)]),_:1},8,["item-list"])}}});export{R as default};
