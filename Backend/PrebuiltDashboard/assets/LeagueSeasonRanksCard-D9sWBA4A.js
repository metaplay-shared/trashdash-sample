import{d as B,af as E,E as O,c as g,h as S,r as F,a as y,o as v,e as $,m as U,j as d,f as t,w as n,x as j,k as o,t as s,ae as q,ad as w,U as z,q as p,F as G,bs as H}from"./index-jY1EWd09.js";import{M as m,a as c}from"./metaListUtils-B-xQ0HnD.js";import{b as J}from"./leagues-Dvm7dNz9.js";import{_}from"./MAbbreviateNumber.vue_vue_type_script_setup_true_lang-C_9AAI8F.js";import{_ as K}from"./MInputNumber.vue_vue_type_script_setup_true_lang-B50CLeRK.js";import{_ as Q}from"./MActionModal.vue_vue_type_script_setup_true_lang-CihjvaoM.js";import"./numberUtils-CkF0oMe2.js";import"./index-DtO9IDi2.js";import"./MInputHintMessage.vue_vue_type_script_setup_true_lang-CYiRxbPX.js";import"./index-qe4CXcF2.js";const W={key:0},X={key:1},di=B({__name:"LeagueSeasonRanksCard",props:{leagueId:{},seasonId:{}},setup(V){const r=V,k=E(),I=H(),{data:f}=O(J(r.leagueId,r.seasonId)),h=g(()=>{const{ranks:l}=f.value;return l.map((e,b)=>{const i={name:e.rankName,description:e.description,id:b,totalParticipants:e.totalParticipants,totalDivisions:e.numDivisions};return f.value.isCurrent||(i.historicalData={numPromotions:e.numPromotions,numDemotions:e.numDemotions,numDropped:e.numDropped}),i})}),C=[new m("Rank","id",c.Descending),new m("Rank","id",c.Ascending),new m("Name","name",c.Ascending),new m("Name","name",c.Descending),new m("Participants","totalParticipants",c.Ascending),new m("Participants","totalParticipants",c.Descending)],a=S(),N=g(()=>{if(a.value!==void 0)return h.value[a.value]?.name}),P=S();function M(l){a.value=l,P.value?.open(l)}function R(){u.value=void 0}async function L(){a.value!==void 0&&u.value!==void 0&&await T(a.value,u.value)}const D=g(()=>{if(a.value!==void 0)return h.value[a.value]?.totalDivisions}),u=S(),A=g(()=>u.value!==void 0),T=async(l,e)=>{const i=(await I.get(`/divisions/id/${r.leagueId}/${r.seasonId}/${l}/${e}/`)).data,x=`/leagues/${r.leagueId}/${r.seasonId}/${i}`;await k.push(x)};return(l,e)=>{const b=F("meta-list-card");return v(),y(G,null,[t(f)?(v(),$(b,{key:0,title:"All Ranks",itemList:h.value,searchFields:["name","description"],sortOptions:C,pageSize:10,"data-testid":"league-season-ranks-card"},{"item-card":n(({item:i})=>[d(t(j),null,{"top-right":n(()=>[p("span",null,[d(t(_),{number:i.totalParticipants},null,8,["number"]),o(" "+s(t(w)(i.totalParticipants,"participant",!1)),1)])]),"bottom-left":n(()=>[p("div",null,s(i.description),1),i.historicalData?(v(),y("div",W,[d(t(_),{number:i.historicalData.numPromotions},null,8,["number"]),o(" "+s(t(w)(i.historicalData.numPromotions,"promotion",!1))+" | ",1),d(t(_),{number:i.historicalData.numDemotions},null,8,["number"]),o(" "+s(t(w)(i.historicalData.numDemotions,"demotion",!1))+" | ",1),d(t(_),{number:i.historicalData.numDropped},null,8,["number"]),e[1]||(e[1]=o(" dropped",-1))])):(v(),y("div",X,"Statistics not available yet."))]),"bottom-right":n(()=>[i.totalDivisions>0?(v(),$(t(q),{key:0,"disabled-tooltip":i.totalDivisions===0?"There are no divisions available to view for this rank.":void 0,onClick:x=>M(i.id),"data-testid":"view-division-button-"+i.id},{default:n(()=>[o(s(t(w)(i.totalDivisions,"division",!0)),1)],void 0,!0),_:2},1032,["disabled-tooltip","onClick","data-testid"])):(v(),$(t(z),{key:1,content:"There are no divisions available to view for this rank."},{default:n(()=>[...e[2]||(e[2]=[o("View division",-1)])],void 0,!0),_:1}))]),default:n(()=>[o(s(i.name),1)],void 0,!0),_:2},1024)]),_:1},8,["itemList"])):U("",!0),d(t(Q),{ref_key:"viewDivisionModal",ref:P,title:"View Division",action:L,"ok-button-label":"View Division","ok-button-disabled-tooltip":A.value?void 0:"Select a division to view.","disable-safety-lock":"",onShow:R,"data-testid":"view-division-modal"+a.value},{default:n(()=>[p("div",null,[e[3]||(e[3]=o("Select a division to view from ",-1)),p("strong",null,s(N.value),1),e[4]||(e[4]=o(" of ",-1)),p("strong",null,s(t(f).displayName),1),d(t(K),{label:"Division Index","model-value":u.value,placeholder:"Enter division index...",min:0,max:(D.value??1)-1,"hint-message":(D.value??1)===1?"There is only one division available in this rank, with the index 0.":`There are a total of ${D.value??1} divisions available, indexed from 0 to ${(D.value??1)-1}.`,"onUpdate:modelValue":e[0]||(e[0]=i=>u.value=i),"data-testid":"division-index-input"+a.value},null,8,["model-value","max","hint-message","data-testid"])])],void 0,!0),_:1},8,["ok-button-disabled-tooltip","data-testid"])],64)}}});export{di as default};
