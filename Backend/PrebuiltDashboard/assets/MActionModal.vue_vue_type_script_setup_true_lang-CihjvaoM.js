import{d as V,h as g,c as h,bn as q,ak as H,aj as B,bH as K,K as U,e as P,o,aW as A,j as r,bI as $,w as i,a as n,m as w,n as v,q as a,t as L,a7 as c,bl as G,T as k,k as m,bm as J,I as W,bJ as F,al as Q}from"./index-jY1EWd09.js";import{m as R,c as X}from"./index-qe4CXcF2.js";const Y={key:0,class:"tw-pointer-events-auto tw-fixed tw-inset-0 tw-z-50 tw-overflow-y-auto tw-@container"},Z=["data-testid"],_={class:"tw-overflow-hidden tw-overflow-ellipsis tw-font-bold tw-text-neutral-900",role:"heading"},tt={key:0,class:"tw-my-14 tw-flex tw-animate-bounce tw-justify-center tw-italic tw-text-neutral-500"},et={key:1},at={class:"tw-flex tw-justify-end"},st={key:2},ot={key:0,class:"tw-mt-4 tw-flex tw-justify-end"},lt={key:3},nt={class:"tw-relative tw-z-10 tw-mb-4 tw-gap-8 tw-space-y-8 @4xl:tw-flex @4xl:tw-space-y-0"},it={class:"tw-min-w-0 @4xl:tw-flex-1"},dt={key:0,class:"tw-min-w-0 @4xl:tw-flex-1"},rt={key:0,class:"tw-pb-3 @4xl:tw-flex-1"},ut={class:"tw-mr-1"},ft=V({__name:"MActionModal",props:{title:{},action:{},variant:{default:"primary"},okButtonLabel:{default:"Ok"},okButtonDisabledTooltip:{default:void 0},disableSafetyLock:{type:Boolean,default:!1},modalSize:{default:"default"},dataTestid:{default:void 0},okButtonDisabled:{default:void 0}},emits:["ok","cancel","show","hide"],setup(s,{expose:S,emit:z}){const x=s,b=g(!1),y=h(()=>f.value?"loading":d.value?"error":b.value?"success":"default"),p=z;function j(){f.value=!1,d.value=void 0,b.value=!1,l.value.setOpen(!0),p("show")}function u(){l.value.setOpen(!1)}S({open:j,close:u});const T=q(),M=h(()=>{const t={default:"tw-max-w-lg",large:"tw-max-w-5xl"};return T["right-panel"]?t.large:t[x.modalSize]}),f=g(!1),d=g();async function O(){f.value=!0;try{b.value=!0;const t=x.action();t instanceof Promise&&await t,f.value=!1,p("ok"),T["result-panel"]||u()}catch(t){f.value=!1,t instanceof F||t instanceof Error?d.value=t:d.value=new Error("Unknown error"),console.error(t)}}function D(){p("cancel"),u()}const I=H(R,{id:B("modal"),closeOnInteractOutside:!1,onOpenChange:t=>{t.open||p("hide")}}),l=h(()=>X(I,Q)),{registerModal:E,unregisterModal:N}=K(),C=B("modal-instance");return U(()=>l.value.open,t=>{t?E(C):N(C)},{immediate:!0}),(t,e)=>(o(),P(A,{to:"body"},[r($,{name:"backdrop-fade"},{default:i(()=>[l.value.open?(o(),n("div",v({key:0},l.value.getBackdropProps(),{class:"tw-pointer-events-none tw-fixed tw-inset-0 tw-z-50"}),null,16)):w("",!0)],void 0,!0),_:1}),r($,{name:"modal-fade"},{default:i(()=>[l.value.open?(o(),n("div",Y,[a("div",v(l.value.getPositionerProps(),{class:"tw-relative tw-p-1 @md:tw-mb-32 @md:tw-px-5"},{"data-testid":s.dataTestid}),[a("div",v(l.value.getContentProps(),{class:"tw-mx-auto tw-rounded-lg tw-bg-white tw-p-4 tw-shadow-xl tw-transition-transform tw-duration-1000 tw-@container @md:tw-mt-24 @md:tw-w-full @md:tw-px-5 @md:tw-pt-3.5"},{class:M.value}),[a("div",v(l.value.getTitleProps(),{class:"tw-mb-2 tw-flex tw-justify-between"}),[a("span",_,L(s.title),1),a("span",null,[c(t.$slots,"modal-subtitle")]),a("button",{class:"tw-relative -tw-top-0.5 tw-inline-flex tw-h-7 tw-w-7 tw-shrink-0 tw-items-center tw-justify-center tw-rounded tw-font-semibold hover:tw-bg-neutral-100 active:tw-bg-neutral-200",onClick:u},[...e[0]||(e[0]=[a("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",class:"tw-w-6 tw-h-6"},[a("path",{"fill-rule":"evenodd",d:"M5.47 5.47a.75.75 0 011.06 0L12 10.94l5.47-5.47a.75.75 0 111.06 1.06L13.06 12l5.47 5.47a.75.75 0 11-1.06 1.06L12 13.06l-5.47 5.47a.75.75 0 01-1.06-1.06L10.94 12 5.47 6.53a.75.75 0 010-1.06z","clip-rule":"evenodd"})],-1)])])],16),e[8]||(e[8]=a("div",{class:"tw-mb-3 tw-border-b tw-border-neutral-200 @md:-tw-mx-5"},null,-1)),y.value==="loading"?(o(),n("div",tt,"Loading, please hold...")):y.value==="error"?(o(),n("div",et,[e[2]||(e[2]=a("p",null,"Oh snap, something went wrong while trying to perform the action. Here's what we know:",-1)),d.value?(o(),P(G,{key:0,class:"tw-my-4",error:d.value},null,8,["error"])):w("",!0),a("div",at,[r(k,{variant:"neutral",onClick:u},{default:i(()=>[...e[1]||(e[1]=[m("Close",-1)])],void 0,!0),_:1})])])):y.value==="success"?(o(),n("div",st,[c(t.$slots,"result-panel",{},()=>[e[3]||(e[3]=a("p",{class:"tw-my-14 tw-flex tw-justify-center tw-italic tw-text-neutral-500"},"Success!",-1))]),t.$slots["result-panel"]?(o(),n("div",ot,[r(k,v(t.$attrs,{variant:"neutral",onClick:u,"data-testid":s.dataTestid?s.dataTestid+"-close":void 0}),{default:i(()=>[...e[4]||(e[4]=[m("Close",-1)])],void 0,!0),_:1},16,["data-testid"])])):w("",!0)])):(o(),n("div",lt,[a("div",nt,[a("div",it,[c(t.$slots,"default",{},()=>[e[5]||(e[5]=m("Default modal content goes here...",-1))])]),t.$slots["right-panel"]?(o(),n("div",dt,[c(t.$slots,"right-panel")])):w("",!0)]),t.$slots["bottom-panel"]?(o(),n("div",rt,[c(t.$slots,"bottom-panel")])):w("",!0),e[7]||(e[7]=a("div",{class:"tw-mb-2 tw-border-b tw-border-neutral-200 @md:-tw-mx-5"},null,-1)),r(J,{class:"tw-relative tw-z-0"},{default:i(()=>[r(k,{variant:s.variant,"disabled-tooltip":s.okButtonDisabledTooltip,safetyLock:!s.disableSafetyLock,onClick:O,"data-testid":s.dataTestid?s.dataTestid+"-ok-button":void 0},W({default:i(()=>[m(L(s.okButtonLabel),1)]),_:2},[t.$slots["ok-button-icon"]?{name:"icon",fn:i(()=>[a("span",ut,[c(t.$slots,"ok-button-icon")])]),key:"0"}:void 0]),1032,["variant","disabled-tooltip","safetyLock","data-testid"]),r(k,{variant:"neutral",onClick:D,"data-testid":s.dataTestid?s.dataTestid+"-cancel-button":void 0},{default:i(()=>[...e[6]||(e[6]=[m("Cancel",-1)])],void 0,!0),_:1},8,["data-testid"])],void 0,!0),_:3})]))],16)],16,Z)])):w("",!0)],void 0,!0),_:3})]))}});export{ft as _};
