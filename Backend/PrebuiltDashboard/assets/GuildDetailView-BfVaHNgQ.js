import{d as y,r as A,e as d,o as u,f as e,ah as k,w as r,q as l,j as a,C as h,E as _,m as b,k as c,ae as I,by as D,c as w,c7 as $,cD as C,bv as S,I as T,bl as z,a6 as v}from"./index-jY1EWd09.js";import{C as p}from"./CoreUiPlacement-BNT2Q2Hu.js";import{a as x}from"./guilds-CRHZJ8UJ.js";import{_ as N}from"./OverviewList.vue_vue_type_script_setup_true_lang-CiOmK19T.js";import{_ as B,a as F}from"./MViewContainer.vue_vue_type_script_setup_true_lang-C_1W2rCL.js";import{_ as P}from"./MAbbreviateNumber.vue_vue_type_script_setup_true_lang-C_9AAI8F.js";import{_ as V}from"./MRawDataCard.vue_vue_type_script_setup_true_lang-Db7v8Vrj.js";import"./MetaLanguageLabel.vue_vue_type_script_setup_true_lang-NRhcXYbH.js";import"./utils-B01yCWQ7.js";import"./MCountryCode.vue_vue_type_script_setup_true_lang-D7nERO0M.js";import"./numberUtils-CkF0oMe2.js";const E={class:"tw-flex tw-flex-wrap tw-justify-center tw-gap-y-3 tw-@container"},O={class:"tw-basis-full tw-pr-1.5 tw-@container @sm:tw-basis-1/2 @xl:tw-basis-1/3"},W={class:"tw-basis-full tw-pr-1.5 tw-@container @sm:tw-basis-1/2 @xl:tw-basis-1/3"},j={class:"tw-basis-full tw-pr-1.5 tw-@container @sm:tw-basis-1/2 @xl:tw-basis-1/3"},L=y({__name:"GuildAdminActionsCard",props:{guildId:{}},setup(m){return(g,s)=>{const t=A("fa-icon");return u(),d(e(k),{title:"Admin Tools",id:"guild-admin-actions-card"},{icon:r(()=>[a(t,{icon:"wrench",size:"sm"})]),default:r(()=>[l("div",E,[l("div",O,[s[0]||(s[0]=l("div",{class:"tw-mx-0.5 tw-mb-1 tw-font-bold tw-leading-6"},"Gentle Actions",-1)),a(p,{class:"tw-mx-0.5",placementId:"Guilds/Details/AdminActions:Gentle",guildId:m.guildId,alwaysFullWidth:"",smallBottomMargin:""},null,8,["guildId"])]),l("div",W,[s[1]||(s[1]=l("div",{class:"tw-mx-0.5 tw-mb-1 tw-font-bold tw-leading-6"},"Disruptive Actions",-1)),a(p,{class:"tw-mx-0.5",placementId:"Guilds/Details/AdminActions:Disruptive",guildId:m.guildId,alwaysFullWidth:"",smallBottomMargin:""},null,8,["guildId"])]),l("div",j,[s[2]||(s[2]=l("div",{class:"tw-mx-0.5 tw-mb-1 tw-font-bold tw-leading-6"},"Dangerous Actions",-1)),a(p,{class:"tw-mx-0.5",placementId:"Guilds/Details/AdminActions:Dangerous",guildId:m.guildId,alwaysFullWidth:"",smallBottomMargin:""},null,8,["guildId"])])])],void 0,!0),_:1})}}}),M=y({__name:"GuildOverviewCard",props:{guildId:{}},setup(m){const g=h(),s=m,{data:t}=_(x(s.guildId));return(f,o)=>e(t)?(u(),d(e(B),{key:0,id:e(t).model.guildId,title:e(t).model.displayName||"☠️ Closed","sub-title":e(t).model.description},{caption:r(()=>[o[0]||(o[0]=c("Save file size: ",-1)),a(e(I),{permission:"api.database.inspect_entity",to:`/entities/${e(t).model.guildId}/dbinfo`,"data-testid":"model-size-link"},{default:r(()=>[a(e(P),{number:e(t).persistedSize,unit:"byte"},null,8,["number"])],void 0,!0),_:1},8,["to"])]),default:r(()=>[a(N,{listTitle:"Overview",icon:"chart-bar",sourceObject:e(t),items:e(g).overviewLists.guild},null,8,["sourceObject","items"])],void 0,!0),_:1},8,["id","title","sub-title"])):b("",!0)}}),q={class:"tw-mx-auto tw-mb-10 tw-max-w-2xl tw-@container"},ie=y({__name:"GuildDetailView",setup(m){const g=D(),s=w(()=>{if(g.params.id===void 0)throw new Error("id route param is required.");return $(g.params.id)}),{data:t,error:f}=_(x(s.value)),o=w(()=>{if(f.value)if(C.isAxiosError(f.value)){const n=f.value;return n.response?.status===400?"error-bad-id":n.response?.status===404?"error-not-found":"error-unknown"}else return"error-unknown";else return t.value?.isInitialized===!1?"error-entity-uninitialized":t.value?"success":"loading"});S().setDynamicTitle(t,n=>`Manage ${n.value?.model.displayName??"Guild"}`);const G=w(()=>{const n=[];return t.value?.model&&(t.value.model.lifecyclePhase==="Closed"?n.push({title:"☠️ Guild Closed",message:"This guild has no players and has been closed.",variant:"danger",dataTest:"guild-closed-alert"}):(t.value.model.lifecyclePhase==="WaitingForSetup"||t.value.model.lifecyclePhase==="WaitingForLeader")&&n.push({title:"Guild-in-Progress",message:"All our actors are busy creating this guild and will be with you momentarily, please hold.",variant:"warning",dataTest:"guild-in-progress-alert"})),n});return(n,i)=>(u(),d(e(F),{alerts:G.value,"is-loading":o.value==="loading"},T({overview:r(()=>[a(M,{guildId:s.value},null,8,["guildId"])]),default:r(()=>[l("div",q,[a(L,{guildId:s.value},null,8,["guildId"])]),i[6]||(i[6]=l("h3",{class:"tw-my-5"},"Game State",-1)),a(p,{placementId:"Guilds/Details/GameState",guildId:s.value},null,8,["guildId"]),i[7]||(i[7]=l("h3",{class:"tw-my-5"},"Guild & Admin Logs",-1)),a(p,{placementId:"Guilds/Details/GuildAdminLogs",guildId:s.value},null,8,["guildId"]),a(e(V),{data:e(t),label:"guild"},null,8,["data"])]),_:2},[o.value.includes("error")?{name:"errors",fn:r(()=>[o.value==="error-bad-id"||o.value==="error-unknown"?(u(),d(e(z),{key:0,error:e(f)},null,8,["error"])):o.value==="error-not-found"?(u(),d(e(v),{key:1,title:"Guild Not Found",variant:"danger"},{default:r(()=>[...i[0]||(i[0]=[c("This guild does not exist. Are you looking in the correct deployment?",-1)])],void 0,!0),_:1})):o.value==="error-entity-uninitialized"?(u(),d(e(v),{key:2,title:"Guild Not Initialized",variant:"danger"},{default:r(()=>[...i[1]||(i[1]=[c("This guild has not yet been initialized. This is likely a temporary state for a new guild, but indicates a problem if the state persists.",-1)])],void 0,!0),_:1})):b("",!0),o.value==="error-unknown"||o.value==="error-entity-uninitialized"?(u(),d(e(v),{key:3,class:"tw-mt-3",title:"Debugging",variant:"danger"},{default:r(()=>[i[5]||(i[5]=l("p",null,"The following tool may be able to give you more information about this error:",-1)),l("ul",null,[l("li",null,[i[3]||(i[3]=c("Use ",-1)),a(e(I),{to:`/entities/${s.value}/dbinfo`,permission:"api.database.inspect_entity","data-testid":"model-size-link"},{default:r(()=>[...i[2]||(i[2]=[c("save file inspector",-1)])],void 0,!0),_:1},8,["to"]),i[4]||(i[4]=c(" to inspect entity data saved on the database.",-1))])])],void 0,!0),_:1})):b("",!0)]),key:"0"}:void 0]),1032,["alerts","is-loading"]))}});export{ie as default};
