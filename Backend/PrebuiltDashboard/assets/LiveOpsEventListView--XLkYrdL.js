import{d as P,c as j,bJ as L,e as l,o,f as e,w as a,j as n,s as Y,m as b,bl as M,v as U,x as g,k as d,y as N,D as C,t as O,q as p,_ as B,a as _,B as $,z as E,I as z,ae as J,h as S,K as q,bs as Q,cl as X,ad as Z,E as F}from"./index-jY1EWd09.js";import{_ as ee,a as te}from"./LiveOpsEventFormModalButton.vue_vue_type_script_setup_true_lang-C21I4XN8.js";import ae from"./MetaListCard-1ZrdC8ii.js";import{d as K}from"./debounce-DkFP0rfT.js";import{_ as ie}from"./MActionModalButton.vue_vue_type_script_setup_true_lang-CTycXHot.js";import{_ as oe}from"./MInputSingleFileContents.vue_vue_type_script_setup_true_lang-yY85JcDy.js";import{_ as ne}from"./MInputSingleSelectSwitch.vue_vue_type_script_setup_true_lang-DPh05re_.js";import{C as se}from"./CoreUiPlacement-BNT2Q2Hu.js";import{_ as re,l as le}from"./dataSourceUtils-Di-chQ61.js";import{b as ue,a as de}from"./liveOpsEvents-DY308ck4.js";import{M as ve}from"./MSingleColumnLayout-BSf_YwiY.js";import{_ as R}from"./MRawDataCard.vue_vue_type_script_setup_true_lang-Db7v8Vrj.js";import{_ as pe,a as me}from"./MViewContainer.vue_vue_type_script_setup_true_lang-C_1W2rCL.js";import"./MInputTextArea.vue_vue_type_script_setup_true_lang-BahEDGWU.js";import"./MInputHintMessage.vue_vue_type_script_setup_true_lang-CYiRxbPX.js";import"./actionDebouncer-D31HA7Ay.js";import"./axiosActionHandler-Di1afWRT.js";import"./MetaGeneratedForm.vue_vue_type_script_setup_true_lang-C4tXbiPC.js";import"./GeneratedUiFormDynamicComponent.vue_vue_type_script_setup_true_lang-YgpMK99r.js";import"./MInputMultiSelectCheckbox.vue_vue_type_script_setup_true_lang-BmEacL49.js";import"./MInputCheckbox.vue_vue_type_script_setup_true_lang-Bzg4Lkt_.js";import"./MInputSingleSelectDropdown.vue_vue_type_script_setup_true_lang-CqJL3vnO.js";import"./PlayerSegmentsInput.vue_vue_type_script_setup_true_lang-0j5ld439.js";import"./numberUtils-CkF0oMe2.js";import"./MInputToggleGroup.vue_vue_type_script_setup_true_lang-BfBi0Sfr.js";import"./MInputSwitch.vue_vue_type_script_setup_true_lang-D2jAqk4R.js";import"./MInputText.vue_vue_type_script_setup_true_lang-Wwv8TYAB.js";import"./MInputDuration.vue_vue_type_script_setup_true_lang-Cl7Z5XKO.js";import"./MInputNumber.vue_vue_type_script_setup_true_lang-B50CLeRK.js";import"./index-DtO9IDi2.js";import"./MInputDateTime.vue_vue_type_script_setup_true_lang-BJgw3K8v.js";import"./metaListUtils-B-xQ0HnD.js";import"./utils-B01yCWQ7.js";import"./_baseIteratee-FGZghVLZ.js";import"./isSymbol-B-tfGeoT.js";import"./identity-DKeuBCMA.js";import"./MInputSingleSelectRadio-BM2VfYc3.js";import"./index-Dec9dGh3.js";import"./button-group-DH69WWlM.js";import"./MActionModal.vue_vue_type_script_setup_true_lang-CihjvaoM.js";import"./index-qe4CXcF2.js";import"./MInputSingleFile-DnTld9Jz.js";import"./MAbbreviateNumber.vue_vue_type_script_setup_true_lang-C_9AAI8F.js";var T=(s=>(s.Disallow="Disallow",s.Overwrite="Overwrite",s.KeepOld="KeepOld",s))(T||{}),G=(s=>(s.ConflictError="ConflictError",s.GeneralError="GeneralError",s.CreateNew="CreateNew",s.OverwriteExisting="OverwriteExisting",s.IgnoreDueToExisting="IgnoreDueToExisting",s))(G||{});const ce={key:0},fe={key:1,class:"tw-italic tw-text-neutral-500"},we={key:0},ge={key:1,class:"tw-italic tw-text-neutral-500"},be={key:0},ye={key:1,class:"tw-italic tw-text-neutral-500"},he={key:0},_e={key:1,class:"tw-italic tw-text-neutral-500"},H=P({__name:"LiveOpsEventImportListCard",props:{listMode:{},isImportValid:{type:Boolean},importResults:{}},setup(s){const I=s,x=j(()=>{if(I.importResults===void 0)return;if(I.importResults.length===0)return[];const c=I.importResults.map(r=>{const u=f(r.diagnostics);return{...r,badgeVariant:k(r.outcome,u),badgeText:w[r.outcome].badgeName,displayError:D(r.outcome,u)}}),i={danger:0,warning:1,success:2,primary:3,neutral:4};return c.sort((r,u)=>i[r.badgeVariant]-i[u.badgeVariant])});function f(c){return Object.values(c).flatMap(i=>i)}const w={ConflictError:{message:"The event cannot be imported because an event already exists with the same ID.",variant:"danger",badgeName:"Conflict"},GeneralError:{message:"The event cannot be imported due to an error. More details can be found below.",variant:"danger",badgeName:"Error"},CreateNew:{message:"The import will cause a new event to be created in this environment, but there are warnings that you might want to take into consideration.",variant:"success",badgeName:"Create New"},OverwriteExisting:{message:"The import will overwrite the existing event in this environment.",variant:"warning",badgeName:"Overwrite"},IgnoreDueToExisting:{message:"The import will be ignored because the event already exists in this environment.",variant:"warning",badgeName:"Keep Old"}};function k(c,i){return c===G.CreateNew&&i.some(r=>r.level==="Warning")?"warning":w[c].variant}function D(c,i){if(i.length>0){const t=new L(w[c].badgeName,w[c].message),r={Error:0,Warning:1,Info:2,Uneditable:3};return i.sort((u,h)=>r[u.level]-r[h.level]).forEach(u=>{t.addDetail(u.level,u.message??"No reason provided.")}),t}else return}return(c,i)=>(o(),l(e(ae),{title:s.listMode==="preview"?"Import Preview":"Import Results",dangerous:!s.isImportValid,"item-list":x.value,"page-size":s.listMode==="preview"?4:6,"empty-message":"No results available to preview yet."},{"item-card":a(({item:t})=>[n(e(Y),{"extra-m-list-item-margin":"","hide-collapse":s.listMode==="result"},{header:a(()=>[n(e(g),{"no-left-padding":""},z({"bottom-left":a(()=>[d(O(t.eventId),1)]),"top-right":a(()=>[n(e(B),{variant:t.badgeVariant},{default:a(()=>[d(O(t.badgeText),1)],void 0,!0),_:2},1032,["variant"])]),default:a(()=>[t?.eventInfo?.displayName?(o(),_("span",ce,O(t?.eventInfo?.displayName),1)):(o(),_("span",fe,"No Name Available"))],void 0,!0),_:2},[s.listMode==="result"&&s.isImportValid?{name:"bottom-right",fn:a(()=>[n(e(J),{to:`/liveOpsEvents/${t.eventId}`},{default:a(()=>[...i[0]||(i[0]=[d("View event",-1)])],void 0,!0),_:1},8,["to"])]),key:"0"}:void 0]),1024)]),default:a(()=>[t.displayError?(o(),l(e(M),{key:0,class:"tw-mb-3",error:t.displayError},null,8,["error"])):b("",!0),t.eventInfo?(o(),l(e(U),{key:1,"show-border":"",striped:""},{default:a(()=>[n(e(g),{condensed:""},{"top-right":a(()=>[n(e(N),{instant:e(C).fromISO(t.eventInfo.createdAt),showAs:"dateTime"},null,8,["instant"])]),default:a(()=>[i[1]||(i[1]=d("Created At",-1))],void 0,!0),_:2},1024),n(e(g),{condensed:""},{"top-right":a(()=>[d(O(t.eventInfo.eventTypeName),1)]),default:a(()=>[i[2]||(i[2]=d("Event Type",-1))],void 0,!0),_:2},1024),t.eventInfo.useSchedule?b("",!0):(o(),l(e(g),{key:0,condensed:""},{"top-right":a(()=>[...i[3]||(i[3]=[p("span",{class:"tw-italic tw-text-neutral-500"},"None",-1)])]),default:a(()=>[i[4]||(i[4]=d("Schedule",-1))],void 0,!0),_:1})),t.eventInfo.useSchedule?(o(),l(e(g),{key:1,condensed:""},{"top-right":a(()=>[n(e(B),null,{default:a(()=>[d(O(t.eventInfo.schedule?.isPlayerLocalTime?"Player Local":"UTC"),1)],void 0,!0),_:2},1024)]),default:a(()=>[i[5]||(i[5]=d("Time Mode",-1))],void 0,!0),_:2},1024)):b("",!0),t.eventInfo.useSchedule?(o(),l(e(g),{key:2,condensed:""},{"top-right":a(()=>[t.eventInfo.schedule?.enabledStartTime?(o(),l(e(N),{key:0,instant:e(C).fromISO(t.eventInfo.schedule.enabledStartTime),"disable-tooltip":t.eventInfo.schedule?.isPlayerLocalTime,showAs:"dateTime"},null,8,["instant","disable-tooltip"])):b("",!0)]),default:a(()=>[i[6]||(i[6]=d("Start Time",-1))],void 0,!0),_:2},1024)):b("",!0),t.eventInfo.useSchedule?(o(),l(e(g),{key:3,condensed:""},{"top-right":a(()=>[t.eventInfo.schedule?.enabledEndTime?(o(),l(e(N),{key:0,instant:e(C).fromISO(t.eventInfo.schedule.enabledEndTime),"disable-tooltip":t.eventInfo.schedule?.isPlayerLocalTime,showAs:"dateTime"},null,8,["instant","disable-tooltip"])):b("",!0)]),default:a(()=>[i[7]||(i[7]=d("End Time",-1))],void 0,!0),_:2},1024)):b("",!0),t.eventInfo.useSchedule?(o(),l(e(g),{key:4,condensed:""},{"top-right":a(()=>[t.eventInfo.schedule?.previewDuration&&t.eventInfo.schedule?.previewDuration!=="P0Y0M0DT0H0M0S"?(o(),_("span",we,[n(e($),{duration:e(E).fromISO(t.eventInfo.schedule.previewDuration)},null,8,["duration"])])):(o(),_("span",ge,"None"))]),default:a(()=>[i[8]||(i[8]=d("Preview duration",-1))],void 0,!0),_:2},1024)):b("",!0),t.eventInfo?.useSchedule?(o(),l(e(g),{key:5,condensed:""},{"top-right":a(()=>[t.eventInfo.schedule?.previewDuration&&t.eventInfo.schedule?.endingSoonDuration!=="P0Y0M0DT0H0M0S"?(o(),_("span",be,[n(e($),{duration:e(E).fromISO(t.eventInfo.schedule.endingSoonDuration)},null,8,["duration"])])):(o(),_("span",ye,"None"))]),default:a(()=>[i[9]||(i[9]=d("Ending Soon Duration",-1))],void 0,!0),_:2},1024)):b("",!0),t.eventInfo.useSchedule?(o(),l(e(g),{key:6,condensed:""},{"top-right":a(()=>[t.eventInfo.schedule?.reviewDuration&&t.eventInfo.schedule?.reviewDuration!=="P0Y0M0DT0H0M0S"?(o(),_("span",he,[n(e($),{duration:e(E).fromISO(t.eventInfo?.schedule?.reviewDuration)},null,8,["duration"])])):(o(),_("span",_e,"None"))]),default:a(()=>[i[10]||(i[10]=d("Review Duration",-1))],void 0,!0),_:2},1024)):b("",!0)],void 0,!0),_:2},1024)):(o(),l(e(U),{key:2,"show-border":"",striped:""},{default:a(()=>[n(e(g),{condensed:""},{default:a(()=>[...i[11]||(i[11]=[p("span",{class:"tw-italic tw-text-neutral-500"},"No event info available",-1)])],void 0,!0),_:1})],void 0,!0),_:1}))],void 0,!0),_:2},1032,["hide-collapse"])]),_:1},8,["title","dangerous","item-list","page-size"]))}}),Ie={class:"tw-space-y-4"},De=P({__name:"LiveOpsEventActionImport",setup(s){const I=Q();function x(){f.value=void 0,D.value=T.Disallow,r.value=[]}const f=S();function w(v){k(v),r.value=void 0,u.value=[],h.value=!1}const k=K(v=>{f.value===v&&(f.value=void 0),f.value=v},300),D=S(T.Disallow),c=[{value:T.Disallow,label:"Disallow"},{value:T.Overwrite,label:"Overwrite"},{value:T.KeepOld,label:"Keep Old"}];function i(v){t(v),r.value=void 0,u.value=[],h.value=!1}const t=K(v=>{D.value=v},300);q([f,D],async()=>{await V(!0)},{deep:!0});const r=S([]),u=S([]),h=S(!1);async function V(v){if(f.value){const m={validateOnly:v,conflictPolicy:D.value,package:f.value},y=(await I.post("/importLiveOpsEvents",m)).data;r.value=y.eventResults,u.value=y.generalDiagnostics,h.value=y.isValid}else r.value=[],u.value=[]}const A=j(()=>{if(u.value.length>0){const v=u.value.length,m=new L("Validation Failed",`There ${X(v,"was","were")} ${Z(v,"error",!0)} while validating the import file.`,"Error");return u.value.forEach(y=>{m.addDetail(y.level,y.message??"No reason provided.")}),m}else return}),W=new L("Import Failed",`This is most likely because the server state changed between validation and import.
  The events listed below have not been imported and no server state was changed by this operation.`,"Error");return(v,m)=>(o(),l(e(ie),{"modal-title":"Import LiveOps Events",action:()=>V(!1),"trigger-button-label":"Import","ok-button-label":"Import Events","ok-button-disabled-tooltip":h.value?void 0:"Upload a valid file to proceed.",permission:"api.liveops_events.import","trigger-button-full-width":"",onShow:x},{default:a(()=>[p("div",Ie,[m[2]||(m[2]=p("div",null,"You can import LiveOps Events into this environment by uploading a LiveOps Event JSON file. This allows you to move events between environments.",-1)),n(e(oe),{"model-value":f.value,label:"Upload a File","accepted-file-types":".json","onUpdate:modelValue":m[0]||(m[0]=y=>w(y))},null,8,["model-value"]),n(e(ne),{class:"tw-mt-3","model-value":D.value,label:"Conflict Policy",options:c,"onUpdate:modelValue":m[1]||(m[1]=y=>i(y))},null,8,["model-value"]),m[3]||(m[3]=p("div",{class:"tw-space-y-0.5 tw-text-xs tw-text-neutral-500"},[p("p",null,"Conflict policy determines how to deal with conflicting events during import:"),p("p",null,[p("span",{class:"tw-font-semibold"},"Disallow"),d(" - Duplicate events will not be allowed.")]),p("p",null,[p("span",{class:"tw-font-semibold"},"Overwrite"),d(" - Duplicate events will overwrite existing ones.")]),p("p",null,[p("span",{class:"tw-font-semibold"},"Keep Old"),d(" - Duplicate events will be ignored.")])],-1))])]),"right-panel":a(()=>[A.value?(o(),l(e(M),{key:0,error:A.value},null,8,["error"])):(o(),l(H,{key:1,"list-mode":"preview","is-import-valid":h.value,"import-results":r.value},null,8,["is-import-valid","import-results"]))]),"result-panel":a(()=>[h.value?b("",!0):(o(),l(e(M),{key:0,class:"tw-mb-3",error:e(W)},null,8,["error"])),n(H,{"list-mode":"result","is-import-valid":h.value,"import-results":r.value},null,8,["is-import-valid","import-results"])]),_:1},8,["action","ok-button-disabled-tooltip"]))}}),mt=P({__name:"LiveOpsEventListView",setup(s){const{data:I}=F(ue()),{data:x}=F(de());return(f,w)=>(o(),l(e(me),{permission:"api.liveops_events.view","full-width":""},{overview:a(()=>[n(e(pe),{title:"LiveOps Events","data-testid":"live-ops-event-list-overview-card"},{buttons:a(()=>[n(ee,{"form-mode":"create"}),n(De),n(te)]),default:a(()=>[w[0]||(w[0]=p("p",{class:"tw-mb-1"},"LiveOps Events are dynamic in-game events that you can create and manage on this page.",-1)),w[1]||(w[1]=p("p",{class:"tw-text-xs tw-text-neutral-500"},"LiveOps Events are under active development and not yet feature-complete. They are safe to use in production but the UI and underlying API will change over the next few releases as we continue to work on them.",-1))],void 0,!0),_:1})]),default:a(()=>[n(re,{class:"tw-mb-4","start-expanded":"","initial-expanded-data-sources":[e(le)]},null,8,["initial-expanded-data-sources"]),n(se,{class:"tw-mx-auto tw-max-w-6xl",placementId:"LiveOpsEvents/List"}),n(e(ve),null,{default:a(()=>[n(e(R),{data:e(I),label:"liveOpsEventsData"},null,8,["data"]),n(e(R),{data:e(x),label:"liveOpsEventTypesData"},null,8,["data"])],void 0,!0),_:1})]),_:1}))}});export{mt as default};
