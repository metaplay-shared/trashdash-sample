import{d as K,ab as j,dU as q,c as _,b7 as H,ad as Y,h as W,K as J,r as u,e as Q,o as r,w as a,j as i,f as s,x as d,_ as y,k as n,t as m,a as p,m as X,q as g,bj as Z,v as ee,F as se,b as te,dV as ae,ag as ie,dW as oe}from"./index-jY1EWd09.js";import{M as c,a as v,b as S,c as h}from"./metaListUtils-B-xQ0HnD.js";import{_ as ne}from"./MInputMultiSelectCheckbox.vue_vue_type_script_setup_true_lang-BmEacL49.js";import{_ as U}from"./MRawDataCard.vue_vue_type_script_setup_true_lang-Db7v8Vrj.js";import{_ as x}from"./MInputSwitch.vue_vue_type_script_setup_true_lang-D2jAqk4R.js";import{a as le}from"./MViewContainer.vue_vue_type_script_setup_true_lang-C_1W2rCL.js";import"./MInputCheckbox.vue_vue_type_script_setup_true_lang-Bzg4Lkt_.js";import"./MInputHintMessage.vue_vue_type_script_setup_true_lang-CYiRxbPX.js";const re={key:0,class:"text-right"},me={key:1},ue={class:"font-weight-bold mr-2",style:{"padding-top":"0.1rem"}},de={key:0,class:"tw-italic"},pe={key:0,class:"tw-mb-4"},ce={key:1,class:"text-muted mt-4 tw-text-center tw-italic"},Se=K({__name:"UserView",setup(ve){const V=j(),l=q(),E=H(),{setDeveloperUiEnabled:N,isDeveloperUiEnabled:O}=ie(),{isSafetyLockEnabled:k,setSafetyLockEnabled:I}=ae(),b=_(()=>l.auth.serverPermissions.map(t=>({permissionDetails:t,hasPermission:E.doesHavePermission(t.name)}))),T=[c.asUnsorted(),new c("Name","permissionDetails.name",v.Ascending),new c("Name","permissionDetails.name",v.Descending),new c("Group","permissionDetails.group",v.Ascending),new c("Group","permissionDetails.group",v.Descending),new c("Type","permissionDetails.type",v.Ascending),new c("Type","permissionDetails.type",v.Descending)],$=_(()=>[new S("hasPermission",[new h("Has permission",t=>t.hasPermission,!0),new h("Does not have permission",t=>!t.hasPermission)]),new S("group",b.value.map(t=>t.permissionDetails.group).filter((t,e,f)=>f.indexOf(t)===e).map(t=>new h(t,e=>e.permissionDetails.group===t))),new S("type",b.value.map(t=>t.permissionDetails.type).filter((t,e,f)=>f.indexOf(t)===e).map(t=>new h(t,e=>e.permissionDetails.type===t)))]);function C(t){return t.permissionDetails.name}const F=[...l.auth.serverRoles].sort().map(t=>({label:t,value:t})),w=_(()=>[...l.auth.userRoles].sort()),M=_(()=>{const t=l.auth.userAssumedRoles.length>0?"Assumed Role":"Role";return Y(w.value.length,t,!1)}),L=l.auth.canAssumeRoles,D=W(l.auth.userAssumedRoles);return J(D,async t=>{await oe(t)}),(t,e)=>{const f=u("b-avatar"),A=u("b-row"),B=u("fa-icon"),P=u("b-card"),z=u("meta-list-card"),R=u("b-col"),G=u("b-card-title");return r(),Q(s(le),null,{overview:a(()=>[i(P,{class:"shadow-sm mb-3","data-testid":"user-overview-card"},{default:a(()=>[i(A,{class:"mb-5","align-h":"center"},{default:a(()=>[i(f,{src:s(l).auth.userDetails.picture,variant:"light",size:"7em"},null,8,["src"])],void 0,!0),_:1}),i(s(ee),{showBorder:""},{default:a(()=>[i(s(d),null,{"top-right":a(()=>[n(m(s(l).auth.userDetails.name),1)]),default:a(()=>[e[3]||(e[3]=n("Name",-1))],void 0,!0),_:1}),i(s(d),null,{"top-right":a(()=>[n(m(s(l).auth.userDetails.email),1)]),default:a(()=>[e[4]||(e[4]=n("Email",-1))],void 0,!0),_:1}),i(s(d),null,{"top-right":a(()=>[n(m(s(l).auth.userDetails.id),1)]),default:a(()=>[e[5]||(e[5]=n("ID",-1))],void 0,!0),_:1}),i(s(d),null,{"top-right":a(()=>[w.value.length>0?(r(),p("span",re,[(r(!0),p(se,null,te(w.value,o=>(r(),p("div",{key:o},m(o),1))),128))])):(r(),p("span",me,[...e[6]||(e[6]=[g("span",{class:"text-warning"},"None ðŸ˜¢",-1)])]))]),default:a(()=>[n(m(M.value),1)],void 0,!0),_:1}),i(s(d),null,{default:a(()=>[g("div",ue,[e[7]||(e[7]=n("Engage Safety Locks",-1)),i(s(y),{class:"tw-ml-1",shape:"pill"},{default:a(()=>[i(B,{icon:s(k)?"lock":"lock-open",style:{width:"0.5rem"}},null,8,["icon"])],void 0,!0),_:1})])]),"top-right":a(()=>[i(s(x),{"model-value":s(k),name:"safetyToggleEnabled",size:"small","onUpdate:modelValue":e[0]||(e[0]=o=>s(I)(o))},null,8,["model-value"])]),_:1}),i(s(d),null,{"top-right":a(()=>[i(s(x),{"model-value":s(O),name:"isDeveloperUiShown",size:"small",permission:"dashboard.developer_mode","onUpdate:modelValue":e[1]||(e[1]=o=>s(N)(o))},null,8,["model-value"])]),default:a(()=>[e[9]||(e[9]=n("Show Developer UI",-1)),i(s(y),{class:"tw-ml-0.5",tooltip:"Adds advanced technical information onto most pages.",shape:"pill"},{default:a(()=>[...e[8]||(e[8]=[n("?",-1)])],void 0,!0),_:1})],void 0,!0),_:1})],void 0,!0),_:1})],void 0,!0),_:1})]),default:a(()=>[i(A,{"align-h":"center"},{default:a(()=>[i(R,{lg:"6"},{default:a(()=>[i(z,{title:"Permissions",description:"These are the combined permissions granted by all your roles.",emptyMessage:"You have no permissions on this user account!",searchFields:["permissionDetails.group","permissionDetails.name","permissionDetails.description"],itemList:b.value,getItemKey:C,sortOptions:T,defaultSortOption:1,filterSets:$.value,"data-testid":"user-permissions-card"},{"item-card":a(o=>[i(s(d),null,{"bottom-left":a(()=>[o.item.hasPermission?X("",!0):(r(),p("div",de,"You do not have this permission.")),g("div",null,m(o.item.permissionDetails.description),1)]),"top-right":a(()=>[n(m(o.item.permissionDetails.group),1)]),default:a(()=>[i(s(y),{variant:o.item.hasPermission?"success":"neutral"},{default:a(()=>[n(m(o.item.permissionDetails.name),1)],void 0,!0),_:2},1032,["variant"])],void 0,!0),_:2},1024)]),_:1},8,["itemList","filterSets"])],void 0,!0),_:1}),i(R,{lg:"6"},{default:a(()=>[i(P,{class:"shadow-sm mb-3",style:Z(s(L)?"":"bg-light"),"data-testid":"assume-role-card"},{default:a(()=>[i(G,null,{default:a(()=>[...e[10]||(e[10]=[n("Assume Roles",-1)])],void 0,!0),_:1}),s(L)?(r(),p("div",pe,[e[11]||(e[11]=g("div",{class:"small mb-3"},"This is an advanced developer feature for quickly testing different roles.",-1)),i(s(ne),{"model-value":D.value,options:s(F),vertical:"","onUpdate:modelValue":e[2]||(e[2]=o=>D.value=o),"data-testid":"assume-roles-select"},null,8,["model-value","options"])])):(r(),p("div",ce,"Assuming roles is disabled in this environment."))],void 0,!0),_:1},8,["style"])],void 0,!0),_:1})],void 0,!0),_:1}),i(s(U),{data:s(l).auth.userDetails,label:"userDetails"},null,8,["data"]),i(s(U),{data:s(V).liveOpsDashboardInfo.authConfig,label:"authConfig"},null,8,["data"])],void 0,!0),_:1})}}});export{Se as default};
