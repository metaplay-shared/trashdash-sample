import{d as L,c as d,r as S,e as u,o as f,w as i,j as c,f as a,x as T,k as m,t as p,ae as h,q as D,m as b,y as k,D as M}from"./index-jY1EWd09.js";import{M as o,a as r,b as N}from"./metaListUtils-B-xQ0HnD.js";const $={class:"tw-text-red-500"},x=1,C=L({__name:"IncidentHistoryCard",props:{incidents:{},playerName:{},isLimitedTo:{},showMainPageLink:{type:Boolean},showDescription:{type:Boolean}},setup(s){const n=s,w=["type","reason","incidentId"],v=[new o("Time","uploadedAt",r.Ascending),new o("Time","uploadedAt",r.Descending),new o("Type","type",r.Ascending),new o("Type","type",r.Descending)],_=d(()=>[N.asDynamicFilterSet(n.incidents??[],"type",e=>e.type)]),l=d(()=>n.playerName===void 0),g=d(()=>{if(n.showDescription)return"Incidents are reports of situations where a player may have had the game crash or freeze. They should be investigated and fixed!";{let e="";return n.isLimitedTo?e+=`The ${n.isLimitedTo} most recent`:e+="Recent",e+=" incidents (crashes, network errors, etc.) that have happened to ",l.value?e+="any player.":e+=`${n.playerName}.`,e}});return(e,y)=>{const I=S("meta-list-card");return f(),u(I,{title:"Recent Incident History",icon:"ambulance",dangerous:"",itemList:s.incidents,allowPausing:"",searchFields:w,filterSets:_.value,sortOptions:v,defaultSortOption:x,emptyMessage:"No incidents reported.",moreInfoUri:s.showMainPageLink?"/playerIncidents":void 0,moreInfoLabel:s.showMainPageLink?"player incidents":void 0,permission:"api.incident_reports.view",description:g.value},{"item-card":i(t=>[c(a(T),null,{"top-right":i(()=>[c(a(k),{instant:a(M).fromISO(t.item.uploadedAt)},null,8,["instant"])]),"bottom-left":i(()=>[D("div",$,p(t.item.reason),1),l.value?(f(),u(a(h),{key:0,permission:"api.players.view",to:`/players/${t.item.playerId}`},{default:i(()=>[m(p(t.item.playerId),1)],void 0,!0),_:2},1032,["to"])):b("",!0)]),"bottom-right":i(()=>[c(a(h),{permission:"api.incident_reports.view",to:`/players/${t.item.playerId}/${t.item.incidentId}`},{default:i(()=>[...y[0]||(y[0]=[m("View incident",-1)])],void 0,!0),_:1},8,["to"])]),default:i(()=>[m(p(t.item.type),1)],void 0,!0),_:2},1024)]),_:1},8,["itemList","filterSets","moreInfoUri","moreInfoLabel","description"])}}});export{C as _};
