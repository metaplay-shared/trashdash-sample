import{d as X,aj as F,h as x,c,aP as L,K as S,ak as G,aQ as Y,aR as _,a as d,o as r,m as g,q as i,j as ee,e as te,Q as h,f as P,t as V,aS as le,aT as ae,aU as k,aV as y,a7 as H,k as N,n as C,w as ne,F as se,b as oe,aW as ie,aX as re,al as de}from"./index-jY1EWd09.js";import{_ as ue}from"./MInputHintMessage.vue_vue_type_script_setup_true_lang-CYiRxbPX.js";const we=["data-testid"],ce=["for"],ve=["id","placeholder","disabled","onKeydown","data-testid"],ge=["data-testid"],fe={key:0,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",class:"tw-pointer-events-none tw-w-5 tw-h-5","aria-hidden":"true"},be={key:1,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",class:"tw-pointer-events-none tw-w-5 tw-h-5","aria-hidden":"true"},me={key:2,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",class:"tw-pointer-events-none tw-w-5 tw-h-5","aria-hidden":"true"},he=["data-testid"],pe=["data-testid"],xe=["disabled","onClick","onMouseenter","data-testid"],Ve={class:"tw-flex tw-justify-between"},ye={class:"tw-grow tw-overflow-hidden tw-text-ellipsis"},Ce={key:0,class:"tw-ml-2 tw-select-none"},Me=X({__name:"MInputSingleSelectDropdown",props:{modelValue:{},options:{},searchFunction:{type:Function,default:void 0},label:{default:void 0},disabled:{type:Boolean,default:!1},variant:{default:"neutral"},hintMessage:{default:void 0},placeholder:{default:"Select option"},emptyMessage:{default:"No results found"},dataTestid:{default:void 0},minHeight:{default:void 0}},emits:["update:modelValue"],setup(n,{emit:R}){const s=n,O=R,M=F("input-single-select-dropdown"),j=x(),T=x(),f=x(),b=c(()=>s.options.find(l=>"clearedValue"in l)),z=c(()=>s.options.filter(l=>!("clearedValue"in l))),u=c(()=>{const l=s.options.find(e=>{const t="value"in e?e.value:e.clearedValue;return L(t,s.modelValue)});if(l)return l;if(s.modelValue){let e;if(typeof s.modelValue=="object")if("name"in s.modelValue&&typeof s.modelValue.name=="string")e=s.modelValue.name;else if("id"in s.modelValue&&typeof s.modelValue.id<"u")e=`Object ${s.modelValue.id}`;else try{e=JSON.stringify(s.modelValue)}catch{e="[Object]"}else e=String(s.modelValue);return{label:e,value:s.modelValue}}else return}),w=x(""),v=x(0),p=c(()=>w.value?(s.searchFunction??E)(z.value,w.value):z.value);function E(l,e){const t=e.toLowerCase();return l.filter(a=>a.label.toLowerCase().includes(t))}function B(l){if(!o.value.open){o.value.setOpen(!0);return}const e=p.value;if(!e.length)return;const t=e.length-1;let a=v.value;a<0||a>=e.length?a=l==="next"?0:t:(a=l==="next"?a+1:a-1,a<0&&(a=t),a>t&&(a=0));let m=0;const $=e.length;for(;m<$&&e[a].disabled;)if(a=l==="next"?a+1:a-1,a<0&&(a=t),a>t&&(a=0),m++,m>=$)return;v.value=a,D()}function K(){B("next")}function q(){B("previous")}function D(){re(()=>{if(!f.value)return;const l=f.value.children[v.value];if(l){const e=f.value.getBoundingClientRect(),t=l.getBoundingClientRect();t.bottom>e.bottom?f.value.scrollTop+=t.bottom-e.bottom:t.top<e.top&&(f.value.scrollTop-=e.top-t.top)}})}function Q(){if(!o.value.open)return;const l=p.value[v.value];l&&!l.disabled&&I(l)}function I(l){l.disabled||(O("update:modelValue",l.value),o.value.setOpen(!1),T.value?.focus())}function U(l){s.disabled||!b.value||(O("update:modelValue",b.value.clearedValue),o.value.setOpen(!1))}S(()=>s.modelValue,l=>{w.value=""},{immediate:!0}),S(w,l=>{l.length>0&&!o.value.open&&o.value.setOpen(!0)});const Z=G(Y,{id:F("input-single-select-dropdown"),modal:!1,autoFocus:!1,closeOnEscape:!0,portalled:!0,positioning:{offset:{mainAxis:1},sameWidth:!0},onOpenChange:l=>{if(l.open){const e=p.value.findIndex(t=>L(t.value,s.modelValue));v.value=e>=0?e:0}else w.value=""}}),o=c(()=>_(Z,de)),A=c(()=>{const l=s.options.some(a=>"value"in a?a.value===s.modelValue:!1),e=!s.modelValue;let t;if(b.value?t=b.value.clearedValue===s.modelValue||e&&!l:t=e&&!l,!o.value.open&&t)return s.placeholder}),W=c(()=>{switch(s.variant){case"success":return"tw-border-green-500 tw-ring-green-500";case"danger":return"tw-border-red-500 tw-ring-red-500";case"warning":return"tw-border-orange-500 tw-ring-orange-500";default:return"tw-border-neutral-300 tw-ring-neutral-300"}}),J=c(()=>{switch(s.variant){case"success":return"tw-bg-green-500 hover:tw-bg-green-600 active:tw-bg-green-700";case"danger":return"tw-bg-red-500 hover:tw-bg-red-600 active:tw-bg-red-700";case"warning":return"tw-bg-orange-500 hover:tw-bg-orange-600 active:tw-bg-orange-700";default:return""}});return(l,e)=>(r(),d("div",{class:"tw-space-y-1","data-testid":`${n.dataTestid}-root`},[n.label?(r(),d("label",{key:0,for:P(M),class:h(["tw-block tw-text-sm tw-font-bold tw-leading-6",{"tw-text-neutral-400":n.disabled,"tw-text-neutral-900":!n.disabled}])},V(n.label),11,ce)):g("",!0),i("div",C(o.value.getTriggerProps(),{class:"tw-relative tw-isolate tw-flex tw-min-h-9 tw-w-full tw-items-center tw-rounded-md tw-border tw-text-sm tw-text-neutral-900 tw-shadow-sm placeholder:tw-text-neutral-400 focus:tw-ring-2 focus:tw-ring-inset focus:tw-ring-blue-600"},{ref_key:"triggerElement",ref:j,class:[{"tw-rounded-b-none":o.value.open,"tw-bg-neutral-100 tw-cursor-not-allowed tw-select-none":n.disabled,"tw-bg-white":!n.disabled},W.value],style:{minHeight:n.minHeight}}),[le(i("input",{class:h(["tw-absolute tw-inset-0 tw-z-10 tw-grow tw-rounded-md tw-border-none tw-bg-transparent tw-text-sm tw-ring-inset focus:tw-ring-2 focus:tw-ring-blue-600 disabled:tw-cursor-not-allowed disabled:tw-text-neutral-500",{"tw-rounded-b-none":o.value.open,"tw-caret-transparent":!o.value.open}]),ref_key:"inputRef",ref:T,"onUpdate:modelValue":e[0]||(e[0]=t=>w.value=t),id:P(M),placeholder:A.value,disabled:n.disabled,onKeydown:[k(y(K,["prevent"]),["down"]),k(y(q,["prevent"]),["up"]),k(y(Q,["prevent"]),["enter"])],"data-testid":n.dataTestid},null,42,ve),[[ae,w.value]]),i("div",{class:h(["tw-min-w-40 tw-flex-grow tw-overflow-hidden tw-text-ellipsis tw-py-1 tw-pl-3 tw-pr-2",{"tw-text-neutral-500":n.disabled}]),"data-testid":u.value?`${n.dataTestid}-selected-option`:void 0},[w.value.length===0&&u.value&&"label"in u.value&&!o.value.open?H(l.$slots,"option",{key:0,option:{label:u.value.label,value:u.value.value,disabled:u.value.disabled}},()=>[N(V(u.value.label),1)]):g("",!0)],10,ge),i("div",{class:h(["tw-z-10 tw-flex tw-select-none tw-items-center tw-space-x-1",{"tw-pointer-events-none":n.disabled}])},[n.variant==="success"?(r(),d("svg",fe,[...e[2]||(e[2]=[i("path",{class:"tw-text-neutral-50",d:"M3 10 a7 7 0 1 1 14 0 a7 7 0 1 1 -14 0 Z"},null,-1),i("path",{class:"tw-text-green-500","fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z","clip-rule":"evenodd"},null,-1)])])):g("",!0),n.variant==="warning"?(r(),d("svg",be,[...e[3]||(e[3]=[i("path",{class:"tw-text-orange-500","fill-rule":"evenodd",d:"M10 2L2 18h16L10 2z","clip-rule":"evenodd"},null,-1),i("path",{class:"tw-text-orange-50","fill-rule":"evenodd",d:"M9 6h2v6H9V6zm0 8h2v2H9v-2z","clip-rule":"evenodd"},null,-1)])])):n.variant==="danger"?(r(),d("svg",me,[...e[4]||(e[4]=[i("path",{class:"tw-text-neutral-50",d:"M3 10 a7 7 0 1 1 14 0 a7 7 0 1 1 -14 0 Z"},null,-1),i("path",{class:"tw-text-red-500","fill-rule":"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z","clip-rule":"evenodd"},null,-1)])])):g("",!0),b.value&&u.value!==b.value&&!n.disabled?(r(),d("button",{key:3,onClick:y(U,["stop"]),"data-testid":`${n.dataTestid}-clear-button`},[(r(),d("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",class:h(["tw-size-4 tw-fill-neutral-50 tw-p-0.5 tw-rounded-full tw-bg-neutral-400 hover:tw-bg-neutral-500 active:tw-bg-neutral-600 tw-cursor-pointer",J.value])},[...e[5]||(e[5]=[i("path",{d:"M5.28 4.22a.75.75 0 0 0-1.06 1.06L6.94 8l-2.72 2.72a.75.75 0 1 0 1.06 1.06L8 9.06l2.72 2.72a.75.75 0 1 0 1.06-1.06L9.06 8l2.72-2.72a.75.75 0 0 0-1.06-1.06L8 6.94 5.28 4.22Z"},null,-1)])],2))],8,he)):g("",!0),e[6]||(e[6]=i("div",{class:"tw-cursor-pointer tw-pr-3 tw-text-neutral-400 hover:tw-text-neutral-500 active:tw-text-neutral-600"},"▼",-1))],2)],16),ee(ue,{variant:n.variant},{default:ne(()=>[N(V(n.hintMessage),1)],void 0,!0),_:1},8,["variant"]),(r(),te(ie,{to:"body"},[i("div",C(o.value.getPositionerProps(),{style:{zIndex:9999}}),[i("ul",C(o.value.getContentProps(),{class:"tw-max-h-80 tw-overflow-y-auto tw-overflow-x-hidden tw-overflow-ellipsis tw-rounded-b-md tw-border tw-border-neutral-300 tw-bg-white tw-text-sm tw-shadow-md"},{ref_key:"listbox",ref:f,onMousedown:e[1]||(e[1]=y(()=>{},["prevent"])),"data-testid":`${n.dataTestid}-dropdown`}),[(r(!0),d(se,null,oe(p.value,(t,a)=>(r(),d("li",{key:t.label,disabled:t.disabled,class:h(["tw-px-3 tw-py-1.5 last:tw-rounded-b-md",{"!tw-bg-blue-500 hover:!tw-bg-blue-600 !tw-text-white":n.modelValue===t.value,"tw-bg-neutral-200":v.value===a&&n.modelValue!==t.value,"tw-text-neutral-400 tw-bg-neutral-100 tw-cursor-not-allowed tw-italic":t.disabled,"tw-cursor-pointer":!t.disabled}]),onClick:m=>I(t),onMouseenter:m=>v.value=a,"data-testid":`${n.dataTestid}-option-${t.label}`},[H(l.$slots,"option",{option:{label:t.label,value:t.value,disabled:t.disabled}},()=>[i("div",Ve,[i("div",ye,V(t.label),1),n.modelValue===t.value?(r(),d("span",Ce,"✓")):g("",!0)])])],42,xe))),128)),p.value.length===0?(r(),d("li",C({key:0},o.value.getContentProps(),{class:"tw-select-none tw-bg-neutral-200 tw-px-3 tw-py-1 tw-text-sm tw-italic tw-text-neutral-500"}),V(n.emptyMessage),17)):g("",!0)],16,pe)],16)]))],8,we))}});export{Me as _};
