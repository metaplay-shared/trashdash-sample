import{d as I,c as b,h as D,K as c,D as u,i as U,co as k,a as x,o,q as r,e as f,Q as w,j as L,t as p,m as h,w as y,a7 as S,f as E}from"./index-jY1EWd09.js";import{_ as $}from"./MInputDateTime.vue_vue_type_script_setup_true_lang-BJgw3K8v.js";import{_ as j}from"./MInputDuration.vue_vue_type_script_setup_true_lang-Cl7Z5XKO.js";import{_ as V}from"./MInputHintMessage.vue_vue_type_script_setup_true_lang-CYiRxbPX.js";import{_ as B}from"./MInputSwitch.vue_vue_type_script_setup_true_lang-D2jAqk4R.js";const H={class:"tw-space-y-1"},O={"data-testid":"duration-preview"},F={"data-testid":"end-time-preview"},Q=I({__name:"MInputDurationOrEndDateTime",props:{modelValue:{},referenceDateTime:{default:"utcNow"},inputMode:{default:"duration"},label:{default:void 0},disabled:{type:Boolean},hintMessage:{default:void 0}},emits:["update:modelValue","update:duration","update:endDateTime"],setup(a,{emit:_}){const t=a,s=_,v=b(()=>i.value==="duration"?t.label?.duration??"Duration":t.label?.endDateTime??"End (UTC)"),i=D(t.inputMode);c(()=>t.inputMode,e=>{i.value=e},{immediate:!0});const l=D(t.referenceDateTime==="utcNow"?u.utc():t.referenceDateTime.toUTC()),g=b(()=>t.referenceDateTime==="utcNow"?"utcNow":l.value.plus({minutes:1}).startOf("minute"));c(()=>t.referenceDateTime,e=>{l.value=e==="utcNow"?u.utc():e.toUTC()});let T;U(()=>{T=setInterval(()=>{t.referenceDateTime==="utcNow"&&i.value==="duration"&&(l.value=u.utc(),n.value=m(t.modelValue,l.value))},1e3)}),k(()=>{clearInterval(T)});const n=D(m(t.modelValue,l.value));c(()=>t.modelValue,e=>{n.value=m(e,l.value)},{immediate:!0}),c(()=>t.referenceDateTime,e=>{n.value=m(t.modelValue,e==="utcNow"?u.utc():e)});function m(e,d){return d.toUTC().plus(e)}function C(e){e&&(s("update:modelValue",e),s("update:duration",e))}function N(e){if(!e)throw new Error("Invalid date time value in MInputDurationOrEndDateTime",{cause:e});const d=e.diff(l.value,["days","hours","minutes"]);s("update:modelValue",d),s("update:endDateTime",e)}return(e,d)=>(o(),x("div",H,[r("div",{class:w(["tw-flex",{"tw-justify-end":!v.value,"tw-justify-between":v.value}])},[r("label",{class:w(["tw-block tw-text-sm tw-font-bold tw-leading-6",{"tw-text-neutral-400":a.disabled,"tw-text-neutral-900":!a.disabled}])},p(v.value),3),L(B,{"model-value":i.value==="endDateTime",size:"extraSmall",label:"Exact date picker","disabled-tooltip":a.disabled?"Disabled":void 0,"onUpdate:modelValue":d[0]||(d[0]=M=>i.value=M?"endDateTime":"duration"),"data-testid":"input-mode"},null,8,["model-value","disabled-tooltip"])],2),r("div",null,[i.value==="duration"?(o(),f(j,{key:0,"model-value":a.modelValue,disabled:a.disabled,"onUpdate:modelValue":C},null,8,["model-value","disabled"])):h("",!0),i.value==="endDateTime"?(o(),f($,{key:1,"model-value":n.value,"min-date-time":g.value,disabled:a.disabled,"onUpdate:modelValue":N,"data-testid":"end-datetime"},null,8,["model-value","min-date-time","disabled"])):h("",!0)]),i.value==="duration"?(o(),f(V,{key:0},{default:y(()=>[S(e.$slots,"duration-input-hint",{projectedEndDate:n.value.toLocaleString(E(u).DATETIME_FULL_WITH_SECONDS)},()=>[r("span",O,"Selected duration will last until "+p(n.value.toLocaleString(E(u).DATETIME_FULL_WITH_SECONDS))+".",1)])],void 0,!0),_:3})):(o(),f(V,{key:1},{default:y(()=>[S(e.$slots,"end-time-input-hint",{projectedDuration:a.modelValue.shiftTo("days","hours","minutes").toHuman({listStyle:"long",unitDisplay:"short",maximumFractionDigits:0})},()=>[r("span",F,"Selected end time is "+p(a.modelValue.shiftTo("days","hours","minutes").toHuman({listStyle:"long",unitDisplay:"short",maximumFractionDigits:0}))+" after start time.",1)])],void 0,!0),_:3}))]))}});export{Q as _};
