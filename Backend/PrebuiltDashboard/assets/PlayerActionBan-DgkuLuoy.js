import{$ as R,X,bb as Y,d as F,E as J,c as T,h as I,z as S,D as g,r as K,e as f,m as i,f as t,o as l,w as P,q as o,a as r,j as k,t as d,k as n,x as Q,y as c,bs as W,bt as Z}from"./index-jY1EWd09.js";import{a as h}from"./players-Dfl1Givn.js";import{_ as ee}from"./MetaLanguageLabel.vue_vue_type_script_setup_true_lang-NRhcXYbH.js";import{_ as C}from"./MInputSingleSelectDropdown.vue_vue_type_script_setup_true_lang-CqJL3vnO.js";import{_ as ae}from"./MInputDateTime.vue_vue_type_script_setup_true_lang-BJgw3K8v.js";import{_ as te}from"./MInputDuration.vue_vue_type_script_setup_true_lang-Cl7Z5XKO.js";import{_ as ne}from"./MInputText.vue_vue_type_script_setup_true_lang-Wwv8TYAB.js";import{_ as le}from"./MActionModalButton.vue_vue_type_script_setup_true_lang-CTycXHot.js";import"./utils-B01yCWQ7.js";import"./MInputHintMessage.vue_vue_type_script_setup_true_lang-CYiRxbPX.js";import"./MInputSwitch.vue_vue_type_script_setup_true_lang-D2jAqk4R.js";import"./index-DtO9IDi2.js";import"./MInputNumber.vue_vue_type_script_setup_true_lang-B50CLeRK.js";import"./debounce-DkFP0rfT.js";import"./isSymbol-B-tfGeoT.js";import"./MActionModal.vue_vue_type_script_setup_true_lang-CihjvaoM.js";import"./index-qe4CXcF2.js";var oe="[object String]";function A(y){return typeof y=="string"||!X(y)&&R(y)&&Y(y)==oe}const se={class:"tw-space-y-3 tw-rounded-md tw-border tw-border-neutral-200 tw-bg-neutral-50 tw-p-3"},re={class:"tw-font-semibold"},ue={key:0,class:"tw-text-xs"},ie={key:1,class:"tw-text-xs"},de={key:2,class:"tw-text-xs"},me={key:0,class:"tw-space-y-3"},pe={key:1},ve={class:"tw-ml-1 tw-text-xs tw-font-normal tw-text-neutral-500"},be={key:0,class:"tw-mt-3 tw-space-y-2"},fe={class:"tw-mt-1 tw-text-sm"},ye={key:0},we={class:"tw-font-semibold"},ge={key:1},ke={class:"tw-font-semibold"},Be={key:2},De={key:3},Te={class:"tw-font-semibold"},Ie={key:4},Oe={key:5,class:"tw-mt-3"},Se={key:0},Pe={key:0},ce={class:"tw-font-semibold"},_e={key:1},xe={class:"tw-font-semibold"},Ne={class:"tw-font-semibold"},Me={key:1},$e={class:"tw-font-semibold"},Ce={key:2},We=F({__name:"PlayerActionBan",props:{playerId:{}},setup(y){const{showSuccessNotification:E}=Z(),_=y,V=W(),{data:a,refresh:U}=J(h(_.playerId)),w=T(()=>a.value?.model?.playerName||_.playerId),s=I("none"),j=[{label:"Not banned",value:"none"},{label:"Temporarily banned",value:"temporary"},{label:"Permanently banned",value:"permanent"}];function q(v){s.value=v}const x={hour:1,day:24*1,day3:24*3,day7:24*7,day30:24*30,customDuration:void 0,customDate:void 0},p=I("day7"),G=[{label:"1 Hour",value:"hour"},{label:"1 Day",value:"day"},{label:"3 Days",value:"day3"},{label:"7 Days",value:"day7"},{label:"30 Days",value:"day30"},{label:"Custom Time Period",value:"customDuration"},{label:"Custom End Date",value:"customDate"}],B=I(S.fromISO("P7D")),O=g.utc().plus({days:7}),N=T(()=>a.value.model.banInfo?.endTimeOrNull&&A(a.value.model.banInfo?.endTimeOrNull)?a.value.model.banInfo?.endTimeOrNull:O),D=I(O),u=I(void 0),M=T(()=>s.value==="none"&&a.value.model.isBanned||s.value==="permanent"&&!a.value.model.isPermaBanned||s.value==="temporary"&&a.value.model.isPermaBanned||s.value==="temporary"&&!$.value||u.value&&a.value.model.banInfo?.playerMessage!==u.value?!0:!!(!u.value&&a.value.model.banInfo?.playerMessage)),b=T(()=>{if(s.value!=="none"){if(s.value==="permanent")return null;if(p.value==="customDate")return D.value??null;if(B.value){let v=B.value;if(p.value!=="customDuration"){const e=x[p.value];console.assert(e!==void 0),v=S.fromObject({hours:e})}return g.utc().plus(v)}else if(p.value!==void 0){const v=x[p.value];return console.assert(v!==void 0),g.utc().plus(S.fromObject({hours:v}))}else return null}else return null}),$=T(()=>a.value.model.banInfo?.endTimeOrNull&&A(a.value.model.banInfo?.endTimeOrNull)&&b.value?g.fromISO(a.value.model.banInfo?.endTimeOrNull).equals(b.value):!1);async function H(){const v=s.value!=="none";let e=null;v&&(e={endTimeOrNull:b.value,playerMessage:u.value??void 0}),await V.post(`/players/${a.value.id}/ban`,{banInfo:e}),E(`${w.value} ${v?"banned":"un-banned"}.`),U()}function z(){a.value.model.isBanned?(s.value=a.value.model.isPermaBanned?"permanent":a.value.model.isBanned?"temporary":"none",u.value=a.value.model.banInfo?.playerMessage??void 0,p.value=a.value.model.isBanned?"customDate":"day7",D.value=N.value?g.fromISO(N.value):O):(s.value="none",u.value=void 0,p.value="day7",B.value=S.fromISO("P7D"),D.value=O)}return(v,e)=>{const L=K("fa-icon");return t(a)?(l(),f(t(le),{key:0,"modal-title":"Manage Player Ban",action:H,variant:"warning","trigger-button-label":t(a).model.isBanned?"Edit Player Ban":"Ban Player","ok-button-label":t(a).model.isBanned&&s.value==="none"?"Un-ban Player":"Save Settings","ok-button-disabled-tooltip":M.value?void 0:"Change the player's ban state or duration to proceed.",permission:"api.players.ban",onShow:z,"data-testid":"action-ban-player"},{default:P(()=>[e[34]||(e[34]=o("p",{class:"tw-mb-3"},"Banning a player will prevent them from logging in to the game.",-1)),o("div",se,[k(t(C),{options:j,label:"Ban Status","model-value":s.value,"onUpdate:modelValue":q,"data-testid":"player-ban-dropdown"},{option:P(({option:m})=>[o("div",re,d(m.label),1),m.value==="permanent"?(l(),r("div",ue,"The player is unable to log in to the game.")):m.value==="temporary"?(l(),r("div",ie,"The player is unable to log in to the game for the ban duration.")):m.value==="none"?(l(),r("div",de,"The player is able to log in to the game.")):i("",!0)]),_:1},8,["model-value"]),s.value==="temporary"?(l(),r("div",me,[k(t(C),{options:G,label:"Duration","model-value":p.value,"onUpdate:modelValue":e[0]||(e[0]=m=>p.value=m)},null,8,["model-value"]),p.value==="customDate"?(l(),f(t(ae),{key:0,label:"Custom End Date","model-value":D.value,"onUpdate:modelValue":e[1]||(e[1]=m=>D.value=m)},null,8,["model-value"])):p.value==="customDuration"?(l(),f(t(te),{key:1,label:"Custom Time Period","model-value":B.value,"onUpdate:modelValue":e[2]||(e[2]=m=>B.value=m)},null,8,["model-value"])):i("",!0)])):i("",!0),s.value!=="none"?(l(),r("div",pe,[e[5]||(e[5]=o("span",{class:"tw-text-sm tw-font-bold"},"Player Message (Optional)",-1)),o("span",ve,[e[4]||(e[4]=n("Player's language: ",-1)),k(ee,{language:t(a).model.language,variant:"badge"},null,8,["language"])]),k(t(ne),{class:"tw-mt-1","model-value":u.value,placeholder:"You are banned for...","onUpdate:modelValue":e[3]||(e[3]=m=>u.value=m)},null,8,["model-value"])])):i("",!0)]),M.value?(l(),r("div",be,[e[33]||(e[33]=o("span",{class:"tw-text-sm tw-font-bold"},"Status Preview",-1)),k(t(Q),{class:"tw-rounded-md tw-border tw-border-neutral-200 tw-px-5"},{"bottom-left":P(()=>[o("div",fe,[t(a).model.isBanned&&s.value==="none"?(l(),r("span",ye,[e[6]||(e[6]=n("The player's ban state will change from ",-1)),o("span",we,d(t(a).model.isPermaBanned?"permanently":"temporarily")+" banned",1),e[7]||(e[7]=n(" to ",-1)),e[8]||(e[8]=o("span",{class:"tw-font-semibold"},"not banned",-1)),e[9]||(e[9]=n(".",-1))])):!t(a).model.isPermaBanned&&s.value==="permanent"?(l(),r("span",ge,[e[10]||(e[10]=n("The player's ban state will change from ",-1)),o("span",ke,d(t(a).model.isBanned?"temporarily":"not")+" banned",1),e[11]||(e[11]=n(" to ",-1)),e[12]||(e[12]=o("span",{class:"tw-font-semibold"},"permanently banned",-1)),e[13]||(e[13]=n(" .",-1))])):s.value==="temporary"&&t(a).model.isPermaBanned?(l(),r("span",Be,[e[14]||(e[14]=n("The player's ban state will change from ",-1)),e[15]||(e[15]=o("span",{class:"tw-font-semibold"},"permanently banned",-1)),e[16]||(e[16]=n(" to ",-1)),e[17]||(e[17]=o("span",{class:"tw-font-semibold"},"temporarily banned until",-1)),e[18]||(e[18]=n()),b.value?(l(),f(t(c),{key:0,class:"tw-font-semibold",instant:b.value,showAs:"dateTime"},null,8,["instant"])):i("",!0),e[19]||(e[19]=n(".",-1))])):s.value==="temporary"&&!t(a).model.isBanned?(l(),r("span",De,[e[20]||(e[20]=n("The player's ban state will change from ",-1)),o("span",Te,d(t(a).model.isPermaBanned?"permanently":"not")+" banned",1),e[21]||(e[21]=n(" to ",-1)),e[22]||(e[22]=o("span",{class:"tw-font-semibold"},"temporarily banned until",-1)),e[23]||(e[23]=n()),b.value?(l(),f(t(c),{key:0,class:"tw-font-semibold",instant:b.value,showAs:"dateTime"},null,8,["instant"])):i("",!0),e[24]||(e[24]=n(".",-1))])):s.value==="temporary"&&!$.value?(l(),r("span",Ie,[e[25]||(e[25]=n("The player's ban end date will change from ",-1)),t(a).model.banInfo?.endTimeOrNull?(l(),f(t(c),{key:0,class:"tw-font-semibold",instant:t(g).fromISO(t(a).model.banInfo?.endTimeOrNull),showAs:"dateTime"},null,8,["instant"])):i("",!0),e[26]||(e[26]=n(" to ",-1)),b.value?(l(),f(t(c),{key:1,class:"tw-font-semibold",instant:b.value,showAs:"dateTime"},null,8,["instant"])):i("",!0),e[27]||(e[27]=n(".",-1))])):i("",!0),s.value!=="none"?(l(),r("div",Oe,[t(a).model.banInfo?.playerMessage?(l(),r("span",Se,[u.value?t(a).model.banInfo?.playerMessage!==u.value?(l(),r("span",_e,[n(d(w.value)+" message will change from ",1),o("span",xe,d(t(a).model.banInfo?.playerMessage),1),e[29]||(e[29]=n(" to ",-1)),o("span",Ne,d(u.value),1),e[30]||(e[30]=n(".",-1))])):i("",!0):(l(),r("span",Pe,[n(d(w.value)+" will no longer receive the ",1),o("span",ce,d(t(a).model.banInfo?.playerMessage),1),e[28]||(e[28]=n(" message.",-1))]))])):u.value?(l(),r("span",Me,[n(d(w.value)+" will receive the message: ",1),o("span",$e,d(u.value),1),e[31]||(e[31]=n(".",-1))])):(l(),r("span",Ce,d(w.value)+" will not receive a message.",1))])):i("",!0),e[32]||(e[32]=o("div",{class:"tw-mt-3"},"All good?",-1))])]),default:P(()=>[o("span",null,[k(L,{icon:"user"}),n(" "+d(w.value),1)])],void 0,!0),_:1})])):i("",!0)],void 0,!0),_:1},8,["trigger-button-label","ok-button-label","ok-button-disabled-tooltip"])):i("",!0)}}});export{We as default};
