import{d as C,bz as E,af as z,r as N,e as h,o as x,f as s,w as r,q as t,j as i,bs as R,bt as V,E as B,c5 as k,c as b,D as c,h as I,k as y,y as D,t as A,m as P,_ as U}from"./index-B-VT6L6o.js";import{_ as j}from"./MetaAudienceSizeEstimate.vue_vue_type_script_setup_true_lang-kl1v2Ekb.js";import{_ as q}from"./MActionModalButton.vue_vue_type_script_setup_true_lang-CzHe6hW1.js";import{_ as T}from"./BroadcastFormButton.vue_vue_type_script_setup_true_lang-gPn7C_TP.js";import{C as S}from"./CoreUiPlacement-CjMnxsui.js";import{g as F}from"./analyticsEvents-B4g3w6s0.js";import{a as G}from"./broadcasts-D4Gj1r2O.js";import{_ as H}from"./MTabLayout.vue_vue_type_script_setup_true_lang-FP3nWndb.js";import{_ as K}from"./MRawDataCard.vue_vue_type_script_setup_true_lang-DhJnJrxb.js";import{_ as L,a as W}from"./MViewContainer.vue_vue_type_script_setup_true_lang-sbviMV0h.js";import{_ as J}from"./MAbbreviateNumber.vue_vue_type_script_setup_true_lang-B4a9hmVO.js";import"./MActionModal.vue_vue_type_script_setup_true_lang-DbjMhR13.js";import"./index-D9XvAc_V.js";import"./MetaGeneratedForm.vue_vue_type_script_setup_true_lang-DQCVqnhW.js";import"./GeneratedUiFormDynamicComponent.vue_vue_type_script_setup_true_lang-DFWvQe41.js";import"./MInputMultiSelectCheckbox.vue_vue_type_script_setup_true_lang-DB0nHSfN.js";import"./MInputCheckbox.vue_vue_type_script_setup_true_lang-x_WXETV5.js";import"./MInputHintMessage.vue_vue_type_script_setup_true_lang-CBCiJKqn.js";import"./MInputSingleSelectDropdown.vue_vue_type_script_setup_true_lang-Dv81Anyh.js";import"./PlayerSegmentsInput.vue_vue_type_script_setup_true_lang-CPg3Ztz0.js";import"./actionDebouncer-D31HA7Ay.js";import"./numberUtils-CkF0oMe2.js";import"./MInputToggleGroup.vue_vue_type_script_setup_true_lang-AjXCbOkF.js";import"./MInputSwitch.vue_vue_type_script_setup_true_lang-jCyUDcM1.js";import"./MInputSingleSelectSwitch.vue_vue_type_script_setup_true_lang-CetibaW-.js";import"./index-llZsRYZ2.js";import"./MInputTextArea.vue_vue_type_script_setup_true_lang-CaKBOzTC.js";import"./debounce-B6LajIyo.js";import"./isSymbol-BpirMJeh.js";import"./MInputText.vue_vue_type_script_setup_true_lang-Dfga_g5u.js";import"./MInputDateTime.vue_vue_type_script_setup_true_lang-C6JS_loc.js";import"./index-FJT0vWS8.js";import"./MInputDurationOrEndDateTime.vue_vue_type_script_setup_true_lang-Bm9sy_C1.js";import"./MInputDuration.vue_vue_type_script_setup_true_lang-B-nZ-aUD.js";import"./MInputNumber.vue_vue_type_script_setup_true_lang-CZUuOOV2.js";import"./MSingleColumnLayout-Bc4oHrRo.js";const M={class:"tw-flex tw-flex-col tw-space-y-2"},Q=C({__name:"BroadcastDeleteFormButton",props:{id:{}},emits:["refresh"],setup($,{emit:p}){const l=$,o=R(),v=E(),_=z(),a=p,{showSuccessNotification:g}=V();async function d(){await o.delete(`/broadcasts/${l.id}`);const m=`Broadcast with id ${l.id} deleted.`;g(m),v.path.includes(l.id)&&await _.push("/broadcasts"),a("refresh")}return(m,f)=>{const w=N("meta-no-seatbelts");return x(),h(s(q),{"modal-title":"Delete broadcast",action:d,"trigger-button-label":"Delete","ok-button-label":"Delete",variant:"danger",permission:"api.broadcasts.edit","data-testid":"action-delete-broadcast"},{default:r(()=>[t("div",M,[f[0]||(f[0]=t("p",null,"Deleting this broadcast will prevent any more players from receiving it. However, it will not be removed from the inbox of those who have already received it.",-1)),i(w,{class:"tw-mx-auto tw-w-3/4"})])],void 0,!0),_:1})}}}),X={class:"tw-font-semibold"},Y={class:"tw-w-full"},Z={class:"tw-divide-y tw-divide-neutral-200 tw-border-t tw-border-neutral-200 *:*:tw-py-1"},tt={class:"tw-text-right"},et={class:"tw-text-right"},at={class:"tw-text-right"},st={class:"tw-text-right"},it={class:"tw-text-right"},qt=C({__name:"BroadcastDetailView",setup($){const p=E(),{data:l}=B(F()),{data:o,refresh:v,error:_}=B(G(k(p.params.id)||"")),a=b(()=>{if(!o.value)return;const n=c.utc(),e=c.fromISO(o.value.message.params.startAt),u=c.fromISO(o.value.message.params.endAt);return u>n&&e<n?{...o.value,decoration:{status:"Active",variant:"success",icon:"broadcast-tower"}}:u>n?{...o.value,decoration:{status:"Scheduled",variant:"primary",icon:"calendar-alt"}}:{...o.value,decoration:{status:"Expired",variant:"neutral",icon:"times"}}}),g=b(()=>a.value?.audienceSizeEstimate),d=b(()=>a.value?.message.params),m=b(()=>a.value.message.params.triggerCondition==null?void 0:l.value?.find(n=>n.typeCode===a.value.message?.params.triggerCondition.eventTypeCode)?.displayName??"UNKNOWN"),f=[{label:"Content"},{label:"Audience & Targeting"},{label:"Audit Logs"}],w=I(0);return(n,e)=>{const u=N("fa-icon");return x(),h(s(W),{permission:"api.broadcasts.view","is-loading":!s(o),error:s(_),"full-width":""},{overview:r(()=>[i(s(L),{id:`${a.value.message.params.id}`,title:a.value.message.params.name,"data-testid":"broadcast-details-overview-card"},{badge:r(()=>[i(s(U),{variant:a.value.decoration.variant},{icon:r(()=>[i(u,{icon:a.value.decoration.icon},null,8,["icon"])]),default:r(()=>[y(A(a.value.decoration.status),1)],void 0,!0),_:1},8,["variant"])]),buttons:r(()=>[d.value?(x(),h(T,{key:0,"button-text":"Duplicate","prefill-data":d.value,"edit-broadcast":!1,onRefresh:e[0]||(e[0]=O=>s(v)())},null,8,["prefill-data"])):P("",!0),i(T,{"button-text":"Edit","prefill-data":d.value,"disabled-tooltip":a.value.decoration.status==="Expired"?"The broadcast has expired and can not be edited.":void 0,"edit-broadcast":!0,onRefresh:e[1]||(e[1]=O=>s(v)())},null,8,["prefill-data","disabled-tooltip"]),i(Q,{id:`${s(p).params.id}`},{default:r(()=>e[8]||(e[8]=[y("Delete",-1)]),void 0,!0),_:1,__:[8]},8,["id"])]),default:r(()=>[t("div",null,[t("span",X,[i(u,{icon:"chart-bar"}),e[2]||(e[2]=y(" Overview",-1))]),t("table",Y,[t("tbody",Z,[t("tr",null,[e[3]||(e[3]=t("td",null,"Audience Size Estimate",-1)),t("td",tt,[i(j,{sizeEstimate:a.value.message.params.isTargeted?g.value:void 0},null,8,["sizeEstimate"])])]),t("tr",null,[e[4]||(e[4]=t("td",null,"Start Time",-1)),t("td",et,[i(s(D),{instant:s(c).fromISO(a.value.message.params.startAt),showAs:"dateTime"},null,8,["instant"])])]),t("tr",null,[e[5]||(e[5]=t("td",null,"Expiry Time",-1)),t("td",at,[i(s(D),{instant:s(c).fromISO(a.value.message.params.endAt),showAs:"dateTime"},null,8,["instant"])])]),t("tr",null,[e[6]||(e[6]=t("td",null,"Received By",-1)),t("td",st,[i(s(J),{number:a.value.message.stats.receivedCount,unit:"player"},null,8,["number"])])]),t("tr",null,[e[7]||(e[7]=t("td",null,"Trigger",-1)),t("td",it,A(m.value?`On ${m.value}`:"Immediate"),1)])])])])],void 0,!0),_:1},8,["id","title"])]),default:r(()=>[i(s(H),{tabs:f,"current-tab":w.value},{"tab-0":r(()=>[i(S,{"placement-id":"Broadcasts/Details/Tab0","broadcast-id":String(a.value.message.params.id)},null,8,["broadcast-id"])]),"tab-1":r(()=>[i(S,{"placement-id":"Broadcasts/Details/Tab1","broadcast-id":String(a.value.message.params.id)},null,8,["broadcast-id"])]),"tab-2":r(()=>[i(S,{"placement-id":"Broadcasts/Details/Tab2","broadcast-id":String(a.value.message.params.id)},null,8,["broadcast-id"])]),_:1},8,["current-tab"]),i(s(K),{data:s(o),label:"broadcast"},null,8,["data"])],void 0,!0),_:1},8,["is-loading","error"])}}});export{qt as default};
