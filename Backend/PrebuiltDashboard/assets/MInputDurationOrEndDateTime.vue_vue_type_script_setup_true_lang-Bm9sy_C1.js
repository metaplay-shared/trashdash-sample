import{d as I,c as T,h as f,K as m,D as o,i as U,cn as k,a as L,o as d,q as u,e as c,Q as b,j as $,t as v,m as _,w,a7 as h,f as y}from"./index-B-VT6L6o.js";import{_ as j}from"./MInputDateTime.vue_vue_type_script_setup_true_lang-C6JS_loc.js";import{_ as B}from"./MInputDuration.vue_vue_type_script_setup_true_lang-B-nZ-aUD.js";import{_ as S}from"./MInputHintMessage.vue_vue_type_script_setup_true_lang-CBCiJKqn.js";import{_ as H}from"./MInputSwitch.vue_vue_type_script_setup_true_lang-jCyUDcM1.js";const O={class:"tw-space-y-1"},F={"data-testid":"duration-preview"},A={"data-testid":"end-time-preview"},Q=I({__name:"MInputDurationOrEndDateTime",props:{modelValue:{},referenceDateTime:{default:"utcNow"},inputMode:{default:"duration"},label:{default:void 0},disabled:{type:Boolean},hintMessage:{default:void 0}},emits:["update:modelValue","update:duration","update:endDateTime"],setup(E,{emit:V}){const t=E,r=V,p=T(()=>a.value==="duration"?t.label?.duration??"Duration":t.label?.endDateTime??"End (UTC)"),a=f(t.inputMode);m(()=>t.inputMode,e=>{a.value=e},{immediate:!0});const i=f(t.referenceDateTime==="utcNow"?o.utc():t.referenceDateTime.toUTC()),g=T(()=>t.referenceDateTime==="utcNow"?"utcNow":i.value.plus({minutes:1}).startOf("minute"));m(()=>t.referenceDateTime,e=>{i.value=e==="utcNow"?o.utc():e.toUTC()});let D;U(()=>{D=setInterval(()=>{t.referenceDateTime==="utcNow"&&a.value==="duration"&&(i.value=o.utc(),l.value=s(t.modelValue,i.value))},1e3)}),k(()=>{clearInterval(D)});const l=f(s(t.modelValue,i.value));m(()=>t.modelValue,e=>{l.value=s(e,i.value)},{immediate:!0}),m(()=>t.referenceDateTime,e=>{l.value=s(t.modelValue,e==="utcNow"?o.utc():e)});function s(e,n){return n.toUTC().plus(e)}function C(e){e&&(r("update:modelValue",e),r("update:duration",e))}function N(e){if(!e)throw new Error("Invalid date time value in MInputDurationOrEndDateTime",{cause:e});const n=e.diff(i.value,["days","hours","minutes"]);r("update:modelValue",n),r("update:endDateTime",e)}return(e,n)=>(d(),L("div",O,[u("div",{class:b(["tw-flex",{"tw-justify-end":!p.value,"tw-justify-between":p.value}])},[u("label",{class:b(["tw-block tw-text-sm tw-font-bold tw-leading-6",{"tw-text-neutral-400":e.disabled,"tw-text-neutral-900":!e.disabled}])},v(p.value),3),$(H,{"model-value":a.value==="endDateTime",size:"extraSmall",label:"Exact date picker","disabled-tooltip":e.disabled?"Disabled":void 0,"onUpdate:modelValue":n[0]||(n[0]=M=>a.value=M?"endDateTime":"duration"),"data-testid":"input-mode"},null,8,["model-value","disabled-tooltip"])],2),u("div",null,[a.value==="duration"?(d(),c(B,{key:0,"model-value":e.modelValue,disabled:e.disabled,"onUpdate:modelValue":C},null,8,["model-value","disabled"])):_("",!0),a.value==="endDateTime"?(d(),c(j,{key:1,"model-value":l.value,"min-date-time":g.value,disabled:e.disabled,"onUpdate:modelValue":N,"data-testid":"end-datetime"},null,8,["model-value","min-date-time","disabled"])):_("",!0)]),a.value==="duration"?(d(),c(S,{key:0},{default:w(()=>[h(e.$slots,"duration-input-hint",{projectedEndDate:l.value.toLocaleString(y(o).DATETIME_FULL_WITH_SECONDS)},()=>[u("span",F,"Selected duration will last until "+v(l.value.toLocaleString(y(o).DATETIME_FULL_WITH_SECONDS))+".",1)])],void 0,!0),_:3})):(d(),c(S,{key:1},{default:w(()=>[h(e.$slots,"end-time-input-hint",{projectedDuration:e.modelValue.shiftTo("days","hours","minutes").toHuman({listStyle:"long",unitDisplay:"short",maximumFractionDigits:0})},()=>[u("span",A,"Selected end time is "+v(e.modelValue.shiftTo("days","hours","minutes").toHuman({listStyle:"long",unitDisplay:"short",maximumFractionDigits:0}))+" after start time.",1)])],void 0,!0),_:3}))]))}});export{Q as _};
