import{d as E,by as C,af as R,r as N,e as S,o as x,f as s,w as r,q as t,j as i,bs as V,bt as k,E as B,c7 as z,c as b,D as p,h as I,k as y,y as D,t as A,m as q,_ as P}from"./index-jY1EWd09.js";import{_ as U}from"./MetaAudienceSizeEstimate.vue_vue_type_script_setup_true_lang-wU-8cgN7.js";import{_ as j}from"./MActionModalButton.vue_vue_type_script_setup_true_lang-CTycXHot.js";import{_ as T}from"./BroadcastFormButton.vue_vue_type_script_setup_true_lang-BQ8Iz67z.js";import{C as h}from"./CoreUiPlacement-BNT2Q2Hu.js";import{g as F}from"./analyticsEvents-CULxlf4Q.js";import{a as G}from"./broadcasts-B3cSZUxz.js";import{_ as H}from"./MTabLayout.vue_vue_type_script_setup_true_lang-B1ekLQtC.js";import{_ as K}from"./MRawDataCard.vue_vue_type_script_setup_true_lang-Db7v8Vrj.js";import{_ as L,a as W}from"./MViewContainer.vue_vue_type_script_setup_true_lang-C_1W2rCL.js";import{_ as J}from"./MAbbreviateNumber.vue_vue_type_script_setup_true_lang-C_9AAI8F.js";import"./MActionModal.vue_vue_type_script_setup_true_lang-CihjvaoM.js";import"./index-qe4CXcF2.js";import"./MetaGeneratedForm.vue_vue_type_script_setup_true_lang-C4tXbiPC.js";import"./GeneratedUiFormDynamicComponent.vue_vue_type_script_setup_true_lang-YgpMK99r.js";import"./MInputMultiSelectCheckbox.vue_vue_type_script_setup_true_lang-BmEacL49.js";import"./MInputCheckbox.vue_vue_type_script_setup_true_lang-Bzg4Lkt_.js";import"./MInputHintMessage.vue_vue_type_script_setup_true_lang-CYiRxbPX.js";import"./MInputSingleSelectDropdown.vue_vue_type_script_setup_true_lang-CqJL3vnO.js";import"./PlayerSegmentsInput.vue_vue_type_script_setup_true_lang-0j5ld439.js";import"./actionDebouncer-D31HA7Ay.js";import"./numberUtils-CkF0oMe2.js";import"./MInputToggleGroup.vue_vue_type_script_setup_true_lang-BfBi0Sfr.js";import"./MInputSwitch.vue_vue_type_script_setup_true_lang-D2jAqk4R.js";import"./MInputSingleSelectSwitch.vue_vue_type_script_setup_true_lang-DPh05re_.js";import"./index-Dec9dGh3.js";import"./MInputTextArea.vue_vue_type_script_setup_true_lang-BahEDGWU.js";import"./debounce-DkFP0rfT.js";import"./isSymbol-B-tfGeoT.js";import"./MInputText.vue_vue_type_script_setup_true_lang-Wwv8TYAB.js";import"./MInputDateTime.vue_vue_type_script_setup_true_lang-BJgw3K8v.js";import"./index-DtO9IDi2.js";import"./MInputDurationOrEndDateTime.vue_vue_type_script_setup_true_lang-CKRXnU8E.js";import"./MInputDuration.vue_vue_type_script_setup_true_lang-Cl7Z5XKO.js";import"./MInputNumber.vue_vue_type_script_setup_true_lang-B50CLeRK.js";import"./MSingleColumnLayout-BSf_YwiY.js";const M={class:"tw-flex tw-flex-col tw-space-y-2"},Q=E({__name:"BroadcastDeleteFormButton",props:{id:{}},emits:["refresh"],setup($,{emit:d}){const l=$,o=V(),v=C(),g=R(),a=d,{showSuccessNotification:_}=k();async function m(){await o.delete(`/broadcasts/${l.id}`);const u=`Broadcast with id ${l.id} deleted.`;_(u),v.path.includes(l.id)&&await g.push("/broadcasts"),a("refresh")}return(u,f)=>{const w=N("meta-no-seatbelts");return x(),S(s(j),{"modal-title":"Delete broadcast",action:m,"trigger-button-label":"Delete","ok-button-label":"Delete",variant:"danger",permission:"api.broadcasts.edit","data-testid":"action-delete-broadcast"},{default:r(()=>[t("div",M,[f[0]||(f[0]=t("p",null,"Deleting this broadcast will prevent any more players from receiving it. However, it will not be removed from the inbox of those who have already received it.",-1)),i(w,{class:"tw-mx-auto tw-w-3/4"})])],void 0,!0),_:1})}}}),X={class:"tw-font-semibold"},Y={class:"tw-w-full"},Z={class:"tw-divide-y tw-divide-neutral-200 tw-border-t tw-border-neutral-200 *:*:tw-py-1"},tt={class:"tw-text-right"},et={class:"tw-text-right"},at={class:"tw-text-right"},st={class:"tw-text-right"},it={class:"tw-text-right"},jt=E({__name:"BroadcastDetailView",setup($){const d=C(),{data:l}=B(F());if(d.params.id===void 0)throw new Error("id route param is required.");const{data:o,refresh:v,error:g}=B(G(z(d.params.id))),a=b(()=>{if(!o.value)return;const n=p.utc(),e=p.fromISO(o.value.message.params.startAt),c=p.fromISO(o.value.message.params.endAt);return c>n&&e<n?{...o.value,decoration:{status:"Active",variant:"success",icon:"broadcast-tower"}}:c>n?{...o.value,decoration:{status:"Scheduled",variant:"primary",icon:"calendar-alt"}}:{...o.value,decoration:{status:"Expired",variant:"neutral",icon:"times"}}}),_=b(()=>a.value?.audienceSizeEstimate),m=b(()=>a.value?.message.params),u=b(()=>a.value.message.params.triggerCondition==null?void 0:l.value?.find(n=>n.typeCode===a.value.message?.params.triggerCondition.eventTypeCode)?.displayName??"UNKNOWN"),f=[{label:"Content"},{label:"Audience & Targeting"},{label:"Audit Logs"}],w=I(0);return(n,e)=>{const c=N("fa-icon");return x(),S(s(W),{permission:"api.broadcasts.view","is-loading":!s(o),error:s(g),"full-width":""},{overview:r(()=>[i(s(L),{id:`${a.value.message.params.id}`,title:a.value.message.params.name,"data-testid":"broadcast-details-overview-card"},{badge:r(()=>[i(s(P),{variant:a.value.decoration.variant},{icon:r(()=>[i(c,{icon:a.value.decoration.icon},null,8,["icon"])]),default:r(()=>[y(A(a.value.decoration.status),1)],void 0,!0),_:1},8,["variant"])]),buttons:r(()=>[m.value?(x(),S(T,{key:0,"button-text":"Duplicate","prefill-data":m.value,"edit-broadcast":!1,onRefresh:e[0]||(e[0]=O=>s(v)())},null,8,["prefill-data"])):q("",!0),i(T,{"button-text":"Edit","prefill-data":m.value,"disabled-tooltip":a.value.decoration.status==="Expired"?"The broadcast has expired and can not be edited.":void 0,"edit-broadcast":!0,onRefresh:e[1]||(e[1]=O=>s(v)())},null,8,["prefill-data","disabled-tooltip"]),i(Q,{id:`${s(d).params.id}`},{default:r(()=>[...e[8]||(e[8]=[y("Delete",-1)])],void 0,!0),_:1},8,["id"])]),default:r(()=>[t("div",null,[t("span",X,[i(c,{icon:"chart-bar"}),e[2]||(e[2]=y(" Overview",-1))]),t("table",Y,[t("tbody",Z,[t("tr",null,[e[3]||(e[3]=t("td",null,"Audience Size Estimate",-1)),t("td",tt,[i(U,{sizeEstimate:a.value.message.params.isTargeted?_.value:void 0},null,8,["sizeEstimate"])])]),t("tr",null,[e[4]||(e[4]=t("td",null,"Start Time",-1)),t("td",et,[i(s(D),{instant:s(p).fromISO(a.value.message.params.startAt),showAs:"dateTime"},null,8,["instant"])])]),t("tr",null,[e[5]||(e[5]=t("td",null,"Expiry Time",-1)),t("td",at,[i(s(D),{instant:s(p).fromISO(a.value.message.params.endAt),showAs:"dateTime"},null,8,["instant"])])]),t("tr",null,[e[6]||(e[6]=t("td",null,"Received By",-1)),t("td",st,[i(s(J),{number:a.value.message.stats.receivedCount,unit:"player"},null,8,["number"])])]),t("tr",null,[e[7]||(e[7]=t("td",null,"Trigger",-1)),t("td",it,A(u.value?`On ${u.value}`:"Immediate"),1)])])])])],void 0,!0),_:1},8,["id","title"])]),default:r(()=>[i(s(H),{tabs:f,"current-tab":w.value},{"tab-0":r(()=>[i(h,{"placement-id":"Broadcasts/Details/Tab0","broadcast-id":String(a.value.message.params.id)},null,8,["broadcast-id"])]),"tab-1":r(()=>[i(h,{"placement-id":"Broadcasts/Details/Tab1","broadcast-id":String(a.value.message.params.id)},null,8,["broadcast-id"])]),"tab-2":r(()=>[i(h,{"placement-id":"Broadcasts/Details/Tab2","broadcast-id":String(a.value.message.params.id)},null,8,["broadcast-id"])]),_:1},8,["current-tab"]),i(s(K),{data:s(o),label:"broadcast"},null,8,["data"])],void 0,!0),_:1},8,["is-loading","error"])}}});export{jt as default};
