import{d as A,h as P,E as O,H as Y,c as C,J as d,i as H,c7 as I,r as w,e as r,f as y,o as l,w as o,j as u,m as h,cD as ee,p as $,x as j,k as U,t as K,s as Z,g as ae,G,K as le,a3 as ie,ca as te,a as f,v as W,F as x,b as D,n as X,a4 as ne,aP as se,M as oe,q as re}from"./index-B-VT6L6o.js";import{g as ue}from"./utils-3nJB3c7R.js";const q=A({__name:"MetaGeneratedCard",props:{typeName:{type:String,default:void 0},list:{type:Boolean,default:!1},dictionary:{type:Boolean,default:!1},icon:{type:String,default:void 0},value:{type:null,required:!1,default:void 0},title:{type:String,required:!0},previewLocale:{type:String,default:void 0},logicVersion:{type:Number,default:void 0},isTargetingMultiplePlayers:{type:Boolean,default:!1}},setup(a){const n=a,i=P(),{data:T}=O(Y()),c=C(()=>({fieldName:void 0,fieldType:i.value?.typeName??"",typeKind:i.value?.typeKind??d.Class,isLocalized:i.value?.isLocalized,addedInVersion:i.value?.addedInVersion,removedInVersion:void 0})),b=C(()=>{if(i.value?.isLocalized)return n.previewLocale??T.value?.defaultLanguage});return H(async()=>{if(n.typeName)i.value=await I(n.typeName);else if(n.value&&typeof n.value=="object"&&"$type"in n.value)i.value=await I(n.value.$type);else throw Error("No typeName or value with $type given")}),(N,v)=>{const m=w("b-skeleton"),p=w("b-card"),S=w("meta-list-card"),L=w("fa-icon"),V=w("b-card-title");return!i.value||!y(T)?(l(),r(p,{key:0,class:"h-100"},{default:o(()=>[u(m,{width:"85%"}),u(m,{width:"55%"}),u(m,{width:"70%"})],void 0,!0),_:1})):a.list?(l(),r(S,{key:1,class:"h-100",title:a.title,icon:a.icon||"list",itemList:a.value?a.value:[]},{"item-card":o(e=>[c.value&&i.value?(l(),r(ee,{key:0,fieldInfo:c.value,fieldSchema:i.value,value:e.item,index:Number(e.index),previewLocale:b.value,"logic-version":a.logicVersion,isTargetingMultiplePlayers:a.isTargetingMultiplePlayers},null,8,["fieldInfo","fieldSchema","value","index","previewLocale","logic-version","isTargetingMultiplePlayers"])):h("",!0)]),_:1},8,["title","icon","itemList"])):a.dictionary?(l(),r(S,{key:2,class:"h-100",title:a.title,icon:a.icon||"list",itemList:Object.keys(a.value||{}).map(e=>({key:e,value:a.value[e]}))},{"item-card":o(({item:e})=>[u(y(Z),{extraMListItemMargin:""},{header:o(()=>[u(y(j),{noLeftPadding:""},{default:o(()=>[U(K(e.key),1)],void 0,!0),_:2},1024)]),default:o(()=>[c.value?(l(),r($,{key:0,fieldInfo:c.value,value:e.value,previewLocale:b.value,"logic-version":a.logicVersion,isTargetingMultiplePlayers:a.isTargetingMultiplePlayers},null,8,["fieldInfo","value","previewLocale","logic-version","isTargetingMultiplePlayers"])):h("",!0)]),_:2},1024)]),_:1},8,["title","icon","itemList"])):(l(),r(p,{key:3,class:"h-100 shadow-sm","no-body":""},{default:o(()=>[u(V,{class:"d-flex align-items-center"},{default:o(()=>[a.icon?(l(),r(L,{key:0,class:"mr-2",icon:a.icon},null,8,["icon"])):h("",!0),U(K(a.title),1)],void 0,!0),_:1}),c.value?(l(),r($,{key:0,fieldInfo:{...c.value},value:a.value,previewLocale:b.value,"logic-version":a.logicVersion,isTargetingMultiplePlayers:a.isTargetingMultiplePlayers},null,8,["fieldInfo","value","previewLocale","logic-version","isTargetingMultiplePlayers"])):h("",!0)],void 0,!0),_:1}))}}}),de={class:"tw-m-auto tw-flex tw-flex-wrap tw-justify-items-center"},ce={key:0,class:"tw-w-full tw-p-2 @2xl:tw-w-1/2"},ve={key:1,class:"tw-w-full tw-p-2 @2xl:tw-w-1/2"},fe=A({__name:"GeneratedUiViewSectionContent",props:ae,setup(a){const n=a,i=P();H(async()=>{n.fieldInfo.typeKind===d.Abstract?i.value=n.value.$type?await G(n.value.$type):void 0:i.value=n.fieldSchema});const T=e=>!e.notEditable,c=e=>e.typeKind===d.Primitive||e.typeKind===d.StringId||e.typeKind===d.ConfigLibraryItem||e.typeKind===d.Enum||e.typeKind===d.DynamicEnum||e.typeKind===d.Nullable||e.fieldType==="Metaplay.Core.MetaTime",b=e=>e.typeKind===d.Localized,N=P([]),v=P([]),m=P([]);le(()=>[i.value,n.value],async([e,F],[J,B])=>{if(!e||(N.value.length>0||v.value.length>0||m.value.length>0)&&se(F,B))return;const t=[],g=[{schema:e,value:F}];for(N.value=[],v.value=[],m.value=[];g.length>0;){const{schema:M,value:Q,namePrefix:z}=g.pop();if(!t.find(s=>M.typeName===s)){t.push(M.typeName);for(const s of M.fields){if(!T(s))continue;const k=Q?Q[oe(s.fieldName)]:void 0,_={field:{...s,fieldName:(z??"")+s.fieldName},value:k};if(s.typeKind===d.ValueCollection?_.arrayType=s.typeParams[0]:s.typeKind===d.KeyValueCollection&&(_.dictionaryType=s.typeParams[1]),s.typeKind===d.Class){const E=await G(s.fieldType);g.push({schema:E,value:k,namePrefix:M.fields.length>1?s.fieldName:z})}else if(s.typeKind===d.Abstract&&k&&"$type"in k){const E=k.$type,R=await G(E);g.push({schema:R,value:k,namePrefix:M.fields.length>1?s.fieldName:z})}else c(s)?N.value.push(_):b(s)?v.value.push(_):m.value.push(_)}}}},{deep:!0});const p=C(()=>N.value.length===0?null:{title:"General",fields:N.value}),{data:S}=O(ie(["Languages"])),L=C(()=>v.value.length===0?null:{title:"Localizations",languages:te(n.value,S.value).map(e=>({displayName:ue(e,S.value),lang:e})),fields:v.value});function V(e){return e.fieldName?ne(e.fieldName):"Untitled"}return(e,F)=>{const J=w("b-card"),B=w("meta-list-card");return l(),f("div",de,[p.value?(l(),f("div",ce,[u(J,{class:"h-100 shadow-sm",title:p.value.title},{default:o(()=>[p.value.fields&&p.value.fields.length>0?(l(),r(y(W),{key:0,showBorder:""},{default:o(()=>[(l(!0),f(x,null,D(p.value.fields,t=>(l(),r(y(j),{key:t.field.fieldName},{"bottom-left":o(()=>[u($,X(e.$props,{fieldInfo:t.field,value:t.value,"logic-version":e.logicVersion}),null,16,["fieldInfo","value","logic-version"])]),_:2},1024))),128))],void 0,!0),_:1})):h("",!0)],void 0,!0),_:1},8,["title"])])):h("",!0),L.value?(l(),f("div",ve,[u(B,{class:"h-100",title:"Localizations",icon:"language",itemList:L.value.languages},{"item-card":o(({item:t})=>[u(y(Z),{extraMListItemMargin:""},{header:o(()=>[u(y(j),{noLeftPadding:""},{default:o(()=>[U(K(t.displayName),1)],void 0,!0),_:2},1024)]),default:o(()=>[L.value.fields&&L.value.fields.length>0?(l(),r(y(W),{key:0,showBorder:"",noLeftPadding:""},{default:o(()=>[(l(!0),f(x,null,D(L.value.fields,g=>(l(),f("div",{class:"tw-py-2",key:g.field.fieldName},[u($,X(e.$props,{fieldInfo:g.field,value:g.value,previewLocale:t.lang,"logic-version":e.logicVersion}),null,16,["fieldInfo","value","previewLocale","logic-version"])]))),128))],void 0,!0),_:2},1024)):h("",!0)]),_:2},1024)]),_:1},8,["itemList"])])):h("",!0),(l(!0),f(x,null,D(m.value,t=>(l(),f("div",{class:"tw-w-full tw-p-2 @2xl:tw-w-1/2",key:t.field.fieldName},[t.arrayType?(l(),r(q,{key:0,typeName:t.arrayType,value:t.value,title:V(t.field),list:"","logic-version":e.logicVersion},null,8,["typeName","value","title","logic-version"])):t.dictionaryType?(l(),r(q,{key:1,typeName:t.dictionaryType,value:t.value,title:V(t.field),dictionary:"","logic-version":e.logicVersion},null,8,["typeName","value","title","logic-version"])):(l(),r(q,{key:2,typeName:t.field.fieldType,value:t.value,title:V(t.field),"logic-version":e.logicVersion},null,8,["typeName","value","title","logic-version"]))]))),128))])}}}),ye={class:"tw-relative"},me={key:0},we=A({__name:"MetaGeneratedSection",props:{typeName:{type:String,default:void 0},value:{type:null,required:!1,default:void 0},title:{type:String,required:!1,default:void 0},previewLocale:{type:String,default:void 0},logicVersion:{type:Number,default:void 0},isTargetingMultiplePlayers:{type:Boolean,default:!1}},setup(a){const n=a,i=P(),{data:T}=O(Y()),c=C(()=>({fieldName:void 0,fieldType:i.value?.typeName??"",typeKind:i.value?.typeKind??d.Class,isLocalized:i.value?.isLocalized,addedInVersion:i.value?.addedInVersion,removedInVersion:void 0}));return H(async()=>{if(n.typeName)i.value=await I(n.typeName);else if(n.value&&typeof n.value=="object"&&"$type"in n.value)i.value=await I(n.value.$type);else throw Error("No typeName or value with $type given")}),(b,N)=>{const v=w("b-skeleton");return l(),f("div",ye,[re("h3",null,K(a.title),1),!i.value||!y(T)?(l(),f("div",me,[u(v,{width:"85%"}),u(v,{width:"55%"}),u(v,{width:"70%"})])):(l(),r(fe,{key:1,class:"tw-@container",fieldInfo:c.value,fieldSchema:i.value,value:a.value,previewLocale:a.previewLocale,"logic-version":a.logicVersion,isTargetingMultiplePlayers:a.isTargetingMultiplePlayers},null,8,["fieldInfo","fieldSchema","value","previewLocale","logic-version","isTargetingMultiplePlayers"]))])}}});export{we as _,q as a};
