import{d as S,E as D,h as N,c as P,r as b,a as d,m as y,f as a,o as r,j as e,w as p,q as n,e as O,k as s,_ as f,t as c,bk as $,a6 as z,bs as A,by as I}from"./index-B-VT6L6o.js";import{r as B}from"./utils-3nJB3c7R.js";import{a as C}from"./players-CbfgGr44.js";import{_ as v}from"./MAbbreviateNumber.vue_vue_type_script_setup_true_lang-B4a9hmVO.js";import{_ as V}from"./MActionModalButton.vue_vue_type_script_setup_true_lang-CzHe6hW1.js";const j={key:0},F={class:"tw-mb-1"},J={class:"tw-mb-1"},L={key:0},T={class:"code-box tw-h-[10rem] tw-text-wrap tw-rounded-md tw-border tw-border-neutral-200 tw-bg-neutral-100 tw-text-neutral-600"},Y={key:0,"data-testid":"export-payload"},q={key:1},G={key:0,class:"tw-mb-4 tw-mt-2 tw-w-full tw-text-right tw-text-xs tw-text-neutral-500"},x=3e5,W=S({__name:"PlayerActionExport",props:{playerId:{},allowDebugExport:{type:Boolean}},setup(g){const u=g,_=A(),{data:m}=D(C(u.playerId)),o=N(),w=P(()=>B(o.value));async function k(){o.value=void 0;const l={player:[u.playerId]};m.value?.guild&&(l.guild=[m.value.guild.id]);const t={entities:l,allowExportOnFailure:u.allowDebugExport};o.value=JSON.stringify((await _.post("/entityArchive/export",t)).data)}function h(){const l=`${u.playerId.replace(":","_")}.export`;I(o.value,l)}return(l,t)=>{const i=b("b-skeleton"),E=b("fa-icon");return a(m)||l.allowDebugExport?(r(),d("div",j,[e(a(V),{"modal-title":"Export Player",action:h,"trigger-button-label":"Export Player",variant:"danger","ok-button-label":"Download","ok-button-disabled-tooltip":o.value?void 0:"No data to export.","disable-safety-lock":"",permission:"api.entity_archive.export",onShow:t[0]||(t[0]=H=>k()),"data-testid":"export-player"},{default:p(()=>[n("p",F,[t[2]||(t[2]=s("This is the persisted player data for ",-1)),e(a(f),null,{default:p(()=>[s(c(a(m)?.model.playerName||"n/a"),1)],void 0,!0),_:1}),t[3]||(t[3]=s(" as an ",-1)),e(a(f),null,{default:p(()=>t[1]||(t[1]=[s("entity archive",-1)]),void 0,!0),_:1,__:[1]}),t[4]||(t[4]=s(". You can use it for raw debugging as well as copying players between deployments.",-1))]),t[10]||(t[10]=n("p",{class:"tw-mb-4 tw-text-sm tw-text-neutral-500"},"Please note that you are taking a copy of a player's personally identifiable information (PII) and you should only do this if you have a legitimate reason or the player's consent.",-1)),n("h6",J,[t[5]||(t[5]=s("Serialized Player Data",-1)),e(a($),{class:"tw-ml-1",contents:o.value,disabled:w.value>=x,"data-testid":"copy-player-to-clipboard"},null,8,["contents","disabled"])]),w.value<x?(r(),d("div",L,[n("pre",T,[o.value?(r(),d("span",Y,c(o.value),1)):(r(),d("span",q,[e(i,{width:"85%"}),e(i,{width:"55%"}),e(i,{width:"70%"}),e(i,{class:"tw-mt-4",width:"80%"}),e(i,{width:"65%"})]))]),o.value?(r(),d("div",G,[t[6]||(t[6]=n("span",null,"Export archive size:Â ",-1)),e(a(v),{number:w.value},null,8,["number"])])):y("",!0)])):(r(),O(a(z),{key:1,title:"Export Preview Disabled"},{default:p(()=>[n("p",null,[t[7]||(t[7]=s("Export preview and copying disabled because of its large size of ",-1)),e(a(v),{number:w.value},null,8,["number"]),t[8]||(t[8]=s("b! You can still download the data ðŸ‘",-1))]),t[9]||(t[9]=n("p",{class:"tw-text-sm tw-text-orange-800"},"Some OS & browser combinations are known to have performance issues parsing large blobs of data. Let us know if you are one of them and we'll figure it out!",-1))],void 0,!0),_:1,__:[9]}))]),"ok-button-icon":p(()=>[e(E,{class:"tw-mb-[0.05rem] tw-h-3.5 tw-w-4",icon:"file-download"})]),_:1},8,["ok-button-disabled-tooltip"])])):y("",!0)}}});export{W as _};
