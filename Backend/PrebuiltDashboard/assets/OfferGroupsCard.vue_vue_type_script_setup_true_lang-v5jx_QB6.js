import{d as L,E as b,H as R,c as h,e as g,o as t,f as n,w as r,j as m,k as d,a,m as v,y as B,D as T,x as f,B as O,A as S,b as M,t as p,ad as E,F,bx as G}from"./index-jY1EWd09.js";import{M as o,a as l}from"./metaListUtils-B-xQ0HnD.js";import{g as $,a as j}from"./offers-DBtp9gqX.js";import{_ as V}from"./MetaActivablePhaseBadge.vue_vue_type_script_setup_true_lang-SumaTD3C.js";import{_ as z}from"./MetaActivablesBaseCard.vue_vue_type_script_setup_true_lang-C4azyES_.js";const U={key:0},H={key:1},q={key:0,class:"tw-ml-1"},J={key:1,class:"ml-1"},K={key:2},Q={key:0,class:"tw-italic tw-text-neutral-400"},W={key:1},X={key:2,class:"tw-italic tw-text-neutral-400"},Y={key:3,class:"tw-italic tw-text-neutral-400"},Z={key:1,class:"tw-italic tw-text-neutral-400"},I={key:2,class:"tw-italic tw-text-neutral-400"},ee={key:1,class:"tw-italic tw-text-neutral-400"},te={key:2,class:"tw-italic tw-text-neutral-400"},ae={key:0,class:"tw-text-neutral-400"},le=L({__name:"OfferGroupsCard",props:{title:{},emptyMessage:{},hideDisabled:{type:Boolean},hideConversion:{type:Boolean},hidePlacement:{type:Boolean},hidePriority:{type:Boolean},hideRevenue:{type:Boolean},playerId:{},customEvaluationIsoDateTime:{},placement:{},longList:{type:Boolean},hideCollapse:{type:Boolean},defaultSortOption:{}},setup(i){const c=i,{data:C}=b(R()),k=h(()=>C.value?.activablesMetadata),x=h(()=>k.value?.categories.OfferGroup?.shortSingularDisplayName),{data:w,refresh:D}=b(()=>c.playerId?$(c.playerId,c.customEvaluationIsoDateTime):j(c.customEvaluationIsoDateTime)),P=h(()=>w.value?{OfferGroup:{activables:Object.fromEntries(Object.entries(w.value.offerGroups).filter(([s,e])=>!c.placement||e.config.placement===c.placement))}}:null),N=["activable.config.displayName","activable.config.description","phaseDisplayString"],_=h(()=>{const u=[o.asUnsorted(),new o("Priority","activable.config.priority",l.Ascending),new o("Priority","activable.config.priority",l.Descending),new o("Phase","phaseSortOrder",l.Ascending),new o("Phase","phaseSortOrder",l.Descending),new o("Name","activable.config.displayName",l.Ascending),new o("Name","activable.config.displayName",l.Descending)];return c.hideConversion||(u.push(new o("Conversion","conversion",l.Ascending)),u.push(new o("Conversion","conversion",l.Descending))),c.hideRevenue||(u.push(new o("Revenue","activable.revenue",l.Ascending)),u.push(new o("Revenue","activable.revenue",l.Descending))),u});return(u,s)=>(t(),g(z,{hideDisabled:i.hideDisabled,hideConversion:i.hideConversion,activables:P.value,playerId:i.playerId,category:"OfferGroup",longList:i.longList,emptyMessage:i.emptyMessage,title:i.title,hideCollapse:i.hideCollapse,linkUrlPrefix:"/offerGroups",searchFields:N,sortOptions:_.value,defaultSortOption:i.defaultSortOption,permission:"api.activables.view",onRefreshActivables:n(D)},{additionalTexts:r(({item:e})=>[i.hidePlacement?v("",!0):(t(),a("div",U,"Placement: "+p(e.activable.config.placement),1)),i.hidePriority?v("",!0):(t(),a("div",H,[s[0]||(s[0]=d("Priority:",-1)),e.activable.config.priority>0?(t(),a("span",q,p(n(G)(e.activable.config.priority)),1)):(t(),a("span",J,p(e.activable.config.priority),1))])),i.hideRevenue?v("",!0):(t(),a("div",K,"Revenue: $"+p(e.activable.revenue.toFixed(2)),1))]),collapseContents:r(({item:e})=>[m(n(f),{condensed:""},{"top-right":r(()=>[e.activable.config.activableParams.isEnabled?e.nextPhase?(t(),a("span",W,[m(V,{activable:e.activable,phase:e.nextPhase,playerId:i.playerId,typeName:`${x.value?.toLocaleLowerCase()}`},null,8,["activable","phase","playerId","typeName"]),s[1]||(s[1]=d()),e.nextPhaseStartTime?(t(),g(n(B),{key:0,instant:n(T).fromISO(e.nextPhaseStartTime)},null,8,["instant"])):v("",!0)])):e.scheduleStatus?(t(),a("span",X,"None")):(t(),a("span",Y,"No schedule")):(t(),a("span",Q,"Disabled"))]),default:r(()=>[s[2]||(s[2]=d("Next Schedule Phase",-1))],void 0,!0),_:2},1024),m(n(f),{condensed:""},{"top-right":r(()=>[e.activable.state.hasOngoingActivation&&e.activable.state.activationRemaining!==null?(t(),g(n(O),{key:0,duration:n(S)(e.activable.state.activationRemaining),showAs:"humanizedSentenceCase"},null,8,["duration"])):e.activable.state.hasOngoingActivation?(t(),a("span",Z,"Forever")):(t(),a("span",I,"n/a"))]),default:r(()=>[s[3]||(s[3]=d("Lifetime Left",-1))],void 0,!0),_:2},1024),m(n(f),{condensed:""},{"top-right":r(()=>[e.activable.state.isInCooldown&&e.activable.state.cooldownRemaining!==null?(t(),g(n(O),{key:0,duration:n(S)(e.activable.state.cooldownRemaining),showAs:"humanizedSentenceCase"},null,8,["duration"])):e.activable.state.isInCooldown?(t(),a("span",ee,"Forever")):(t(),a("span",te,"n/a"))]),default:r(()=>[s[4]||(s[4]=d("Cooldown Left",-1))],void 0,!0),_:2},1024),m(n(f),{condensed:""},{"top-right":r(()=>[(t(!0),a(F,null,M(e.activable.offers,(y,A)=>(t(),a("div",{key:A},[d(p(y.config.displayName)+" ",1),y.referencePrice!==null?(t(),a("span",ae,"("+p(y.referencePrice)+")",1)):v("",!0),d(" - "+p(n(E)(y.state.numPurchasedInGroup,"purchase",!0)),1)]))),128))]),default:r(()=>[s[5]||(s[5]=d("Individual Offers",-1))],void 0,!0),_:2},1024)]),_:1},8,["hideDisabled","hideConversion","activables","playerId","longList","emptyMessage","title","hideCollapse","sortOptions","defaultSortOption","onRefreshActivables"]))}});export{le as _};
