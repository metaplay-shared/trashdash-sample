import{d as M,by as R,C as q,c7 as H,E as W,c as m,bJ as j,bv as G,h as J,r as f,e as u,o as n,w as t,j as e,f as l,m as S,q as p,k as s,_ as b,a as _,y as g,D as h,t as x,Q,T as K,bs as X,bt as Y}from"./index-jY1EWd09.js";import{_ as Z}from"./LocalizationActionArchive.vue_vue_type_script_setup_true_lang-hqONebFw.js";import{_ as tt}from"./LocalizationActionPublish.vue_vue_type_script_setup_true_lang-CPEIbMpg.js";import{C as D}from"./CoreUiPlacement-BNT2Q2Hu.js";import{g as et}from"./localization-TVVxfgEw.js";import{_ as at}from"./MTabLayout.vue_vue_type_script_setup_true_lang-B1ekLQtC.js";import{_ as it}from"./MRawDataCard.vue_vue_type_script_setup_true_lang-Db7v8Vrj.js";import{_ as lt,a as ot}from"./MViewContainer.vue_vue_type_script_setup_true_lang-C_1W2rCL.js";import{_ as st}from"./MActionModalButton.vue_vue_type_script_setup_true_lang-CTycXHot.js";import{_ as nt}from"./MInputText.vue_vue_type_script_setup_true_lang-Wwv8TYAB.js";import{_ as rt}from"./MInputTextArea.vue_vue_type_script_setup_true_lang-BahEDGWU.js";import"./MInputCheckbox.vue_vue_type_script_setup_true_lang-Bzg4Lkt_.js";import"./MInputHintMessage.vue_vue_type_script_setup_true_lang-CYiRxbPX.js";import"./MActionModal.vue_vue_type_script_setup_true_lang-CihjvaoM.js";import"./index-qe4CXcF2.js";import"./MInputSingleSelectDropdown.vue_vue_type_script_setup_true_lang-CqJL3vnO.js";import"./MSingleColumnLayout-BSf_YwiY.js";import"./debounce-DkFP0rfT.js";import"./isSymbol-B-tfGeoT.js";const ut={class:"font-weight-bold"},dt={key:1,class:"text-muted tw-italic"},vt={key:2,class:"text-muted tw-italic"},ct={key:1,class:"text-muted tw-italic"},ft={class:"font-weight-bold"},mt={key:0},pt={key:1,class:"text-muted tw-italic"},_t={class:"font-weight-bold"},bt={class:"text-monospace small"},Ut=M({__name:"LocalizationDetailView",setup(gt){const E=X(),B=R();if(q(),B.params.id===void 0)throw new Error("id route param is required.");const d=H(B.params.id),{data:C,refresh:L,error:I}=W(et()),i=m(()=>C.value?.find(r=>r.id===d)),$=m(()=>{if(!C.value?.find(r=>r.id===d))return new j("Localization Not Found",`The localization with the ID '${d}' does not exist. Are you looking in the right deployment?.`)});G().setDynamicTitle(i,r=>`View ${r.value?.name??"Localization"}`);const w=m(()=>{const r=[];return i.value?.publishBlockingErrors.length&&r.push({title:"Build Cannot Be Published",message:"This build contains errors and cannot be published.",variant:"danger",dataTest:"cannot-publish-alert"}),i.value?.bestEffortStatus==="Building"&&r.push({title:"Config building...",message:"This localization is still building and has no content to view for now.",variant:"warning",dataTest:"building-alert"}),r}),N=m(()=>w.value.find(r=>r.variant==="danger")?"danger":w.value.find(r=>r.variant==="warning")?"warning":void 0),v=J({name:"",description:"",isArchived:!1});function T(){v.value={name:i.value?.name??"",description:i.value?.description??"",isArchived:i.value?.isArchived??!1}}const{showSuccessNotification:V}=Y();async function O(){const r={name:v.value.name,description:v.value.description,isArchived:v.value.isArchived};await E.post(`/localization/${d}`,r),V("Localization updated."),L()}const U=m(()=>i.value?.isActive?"Cannot diff this localization against itself.":i.value?.bestEffortStatus!=="Success"?"Cannot diff a localization that is not in a valid state.":void 0),P=[{label:"Details"},{label:"Audit Log"}];return(r,a)=>{const A=f("fa-icon"),o=f("b-td"),c=f("b-tr"),z=f("b-tbody"),k=f("b-table-simple"),F=f("meta-username");return n(),u(l(ot),{variant:N.value,"is-loading":!i.value,error:l(I)??$.value,"full-width":"",alerts:w.value,permission:"api.localization.view"},{overview:t(()=>[i.value?(n(),u(l(lt),{key:0,title:i.value.name||"No Name Available",subtitle:i.value.description,id:l(d),"data-testid":"localization-detail-overview-card"},{buttons:t(()=>[e(Z,{localizationId:l(d),"trigger-style":"button"},null,8,["localizationId"]),e(l(st),{"modal-title":"Edit Localization Archive",action:O,"trigger-button-label":"Edit","ok-button-label":"Update",permission:"api.localization.edit",onShow:T,"data-testid":"edit-config"},{default:t(()=>[e(l(nt),{class:"tw-mb-2",label:"Name","model-value":v.value.name,variant:v.value.name.length>0?"success":void 0,placeholder:"For example: 1.0.4 release candidate","onUpdate:modelValue":a[0]||(a[0]=y=>v.value.name=y)},null,8,["model-value","variant"]),e(l(rt),{label:"Description","model-value":v.value.description,variant:v.value.description.length>0?"success":void 0,placeholder:"What is unique about this config build that will help you find it later?",rows:3,"onUpdate:modelValue":a[1]||(a[1]=y=>v.value.description=y)},null,8,["model-value","variant"])],void 0,!0),_:1}),e(l(K),{"disabled-tooltip":U.value,to:`diff?newRoot=${l(d)}`},{default:t(()=>[...a[19]||(a[19]=[s("Diff to Active",-1)])],void 0,!0),_:1},8,["disabled-tooltip","to"]),e(tt,{localizationId:l(d),publishBlocked:i.value?.publishBlockingErrors.length>0},null,8,["localizationId","publishBlocked"])]),default:t(()=>[p("span",ut,[e(A,{icon:"chart-bar"}),a[2]||(a[2]=s(" Overview",-1))]),e(k,{small:"",responsive:""},{default:t(()=>[e(z,null,{default:t(()=>[e(c,null,{default:t(()=>[e(o,null,{default:t(()=>[...a[3]||(a[3]=[s("Status",-1)])],void 0,!0),_:1}),e(o,{class:"text-right"},{default:t(()=>[i.value.isArchived?(n(),u(l(b),{key:0,class:"tw-mr-1",variant:"neutral"},{default:t(()=>[...a[4]||(a[4]=[s("Archived",-1)])],void 0,!0),_:1})):S("",!0),i.value.isActive?(n(),u(l(b),{key:1,class:"tw-mr-1",variant:"success"},{default:t(()=>[...a[5]||(a[5]=[s("Active",-1)])],void 0,!0),_:1})):(n(),u(l(b),{key:2},{default:t(()=>[...a[6]||(a[6]=[s("Not active",-1)])],void 0,!0),_:1}))],void 0,!0),_:1})],void 0,!0),_:1}),e(c,null,{default:t(()=>[e(o,null,{default:t(()=>[...a[7]||(a[7]=[s("Last Published At",-1)])],void 0,!0),_:1}),e(o,{class:"text-right"},{default:t(()=>[i.value?.publishedAt?(n(),u(l(g),{key:0,instant:l(h).fromISO(i.value.publishedAt),showAs:"relativeSentenceCase"},null,8,["instant"])):i.value?.isActive?(n(),_("span",dt,"No time recorded")):(n(),_("span",vt,"Never"))],void 0,!0),_:1})],void 0,!0),_:1}),e(c,null,{default:t(()=>[e(o,null,{default:t(()=>[...a[8]||(a[8]=[s("Last Unpublished At",-1)])],void 0,!0),_:1}),e(o,{class:"text-right"},{default:t(()=>[i.value?.unpublishedAt?(n(),u(l(g),{key:0,instant:l(h).fromISO(i.value.unpublishedAt),showAs:"relativeSentenceCase"},null,8,["instant"])):(n(),_("span",ct,"Never"))],void 0,!0),_:1})],void 0,!0),_:1})],void 0,!0),_:1})],void 0,!0),_:1}),p("span",ft,[e(A,{icon:"chart-bar"}),a[9]||(a[9]=s(" Build Status",-1))]),e(k,{small:"",responsive:""},{default:t(()=>[e(z,null,{default:t(()=>[e(c,null,{default:t(()=>[e(o,null,{default:t(()=>[...a[10]||(a[10]=[s("Build Status",-1)])],void 0,!0),_:1}),e(o,{class:"text-right"},{default:t(()=>[p("div",null,x(i.value?.bestEffortStatus),1)],void 0,!0),_:1})],void 0,!0),_:1}),e(c,null,{default:t(()=>[e(o,null,{default:t(()=>[...a[11]||(a[11]=[s("Built By",-1)])],void 0,!0),_:1}),e(o,{class:"text-right"},{default:t(()=>[i.value.source==="disk"?(n(),u(l(b),{key:0},{default:t(()=>[...a[12]||(a[12]=[s("Built-in with the server",-1)])],void 0,!0),_:1})):(n(),u(F,{key:1,username:i.value.source},null,8,["username"]))],void 0,!0),_:1})],void 0,!0),_:1}),e(c,{class:Q({"text-danger":i.value.publishBlockingErrors.length>0})},{default:t(()=>[e(o,null,{default:t(()=>[...a[13]||(a[13]=[s("Publish Blocking Errors",-1)])],void 0,!0),_:1}),e(o,{class:"text-right"},{default:t(()=>[i.value.publishBlockingErrors.length?(n(),_("span",mt,x(i.value.publishBlockingErrors.length),1)):(n(),_("span",pt,"None"))],void 0,!0),_:1})],void 0,!0),_:1},8,["class"])],void 0,!0),_:1})],void 0,!0),_:1}),p("span",_t,[e(A,{icon:"chart-bar"}),a[14]||(a[14]=s(" Technical Details",-1))]),e(k,{small:"",responsive:""},{default:t(()=>[e(z,null,{default:t(()=>[e(c,null,{default:t(()=>[e(o,null,{default:t(()=>[...a[15]||(a[15]=[s("Built At",-1)])],void 0,!0),_:1}),e(o,{class:"text-right"},{default:t(()=>[e(l(g),{instant:l(h).fromISO(i.value?.buildStartedAt),showAs:"relativeSentenceCase"},null,8,["instant"])],void 0,!0),_:1})],void 0,!0),_:1}),e(c,null,{default:t(()=>[e(o,null,{default:t(()=>[...a[16]||(a[16]=[s("Last Modified At",-1)])],void 0,!0),_:1}),e(o,{class:"text-right"},{default:t(()=>[i.value?(n(),u(l(g),{key:0,instant:l(h).fromISO(i.value?.lastModifiedAt),showAs:"relativeSentenceCase"},null,8,["instant"])):S("",!0)],void 0,!0),_:1})],void 0,!0),_:1}),e(c,null,{default:t(()=>[e(o,null,{default:t(()=>[...a[17]||(a[17]=[s("Version Hash",-1)])],void 0,!0),_:1}),i.value?(n(),u(o,{key:1,class:"text-right"},{default:t(()=>[p("div",bt,x(i.value.versionHash),1)],void 0,!0),_:1})):(n(),u(o,{key:0,class:"text-right text-muted tw-italic"},{default:t(()=>[...a[18]||(a[18]=[s("Loading...",-1)])],void 0,!0),_:1}))],void 0,!0),_:1})],void 0,!0),_:1})],void 0,!0),_:1})],void 0,!0),_:1},8,["title","subtitle","id"])):S("",!0)]),default:t(()=>[e(l(at),{tabs:P},{"tab-0":t(()=>[e(D,{placementId:"Localizations/Details/Tab0",localizationId:l(d),alwaysFullWidth:""},null,8,["localizationId"])]),"tab-1":t(()=>[e(D,{placementId:"Localizations/Details/Tab1",localizationId:l(d)},null,8,["localizationId"])]),_:1}),e(l(it),{data:i.value,label:"localizationData"},null,8,["data"])]),_:1},8,["variant","is-loading","error","alerts"])}}});export{Ut as default};
