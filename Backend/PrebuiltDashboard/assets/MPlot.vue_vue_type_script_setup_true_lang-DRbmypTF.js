import{cQ as W,cR as w,cS as tt,cT as nt,cU as et,cV as lt,cW as rt,cX as $,cY as dt,cZ as ht,c_ as pt,c$ as yt,d0 as mt,d1 as gt,d2 as vt,d3 as K,d4 as wt,d5 as st,d6 as ot,d7 as C,d8 as k,d9 as M,da as S,db as xt,dc as bt,dd as _t,de as At,df as T,dg as kt,dh as Ct,di as Mt,dj as St,dk as q,dl as Et,dm as It,dn as Ot,dp as Ft,dq as Tt,dr as P,ds as Xt,dt as V,du as G,d as jt,h as H,i as N,cn as Rt,c as Q,dv as Ut,K as zt,a as Bt,o as Dt}from"./index-B-VT6L6o.js";function Lt(e,n){var t=0;return Float64Array.from(e,r=>t+=+r||0)}function X(e,n,t){return(n.length!==2?W(tt(e,n,t),([r,s],[o,a])=>w(s,a)||w(r,o)):W(nt(e,t),([r,s],[o,a])=>n(s,a)||w(r,o))).map(([r])=>r)}function ct(e,n=w){let t,r=!1;if(n.length===1){let s;for(const o of e){const a=n(o);(r?w(a,s)>0:w(a,a)===0)&&(t=o,s=a,r=!0)}}else for(const s of e)(r?n(s,t)>0:n(s,s)===0)&&(t=s,r=!0);return t}function Wt(e={},n="y"){return lt(e)?e:{...e,[n]:et}}function $t(e,n){if(n.length===1)return{data:e,facets:n};const t=rt(e),r=new Uint8Array(t);let s=0;for(const c of n)for(const i of c)r[i]&&++s,r[i]=1;if(s===0)return{data:e,facets:n};e=$(e);const o=e[dt]=new Uint32Array(t+s);n=n.map(c=>$(c,Uint32Array));let a=t;r.fill(0);for(const c of n)for(let i=0,u=c.length;i<u;++i){const d=c[i];r[d]?(c[i]=a,e[a]=e[d],o[a]=d,++a):o[d]=d,r[d]=1}return{data:e,facets:n}}function Kt(e={},n={}){arguments.length===1&&([e,n]=Pt(e));const{x1:t,x:r=t,y:s,...o}=n,[a,c,i,u]=Gt(r,s,"x","y",e,o);return{...a,x1:t,x:c,y1:i,y2:u,y:mt(i,u)}}function qt({y:e,y1:n,y2:t,...r}={}){return r=ht(r,"x"),n===void 0&&t===void 0?Kt({y:e,...r}):([n,t]=pt(e,n,t),{...r,y1:n,y2:t})}function Pt(e){const{offset:n,order:t,reverse:r,...s}=e;return[{offset:n,order:t,reverse:r},s]}const Vt={length:!0};function Gt(e,n=yt,t,r,{offset:s,order:o,reverse:a},c){if(n===null)throw new Error(`stack requires ${r}`);const i=gt(c),[u,d]=vt(e),[f,p]=K(n),[l,y]=K(n);return f.hint=l.hint=Vt,s=Ht(s),o=Zt(o,s,r),[wt(c,(h,g,x)=>{({data:h,facets:g}=$t(h,g));const I=e==null?void 0:d(bt(k(h,e),x?.[t])),j=k(h,n,Float64Array),R=k(h,i),U=o&&o(h,I,j,R),z=rt(h),b=p(new Float64Array(z)),_=y(new Float64Array(z)),B=[];for(const D of g){const O=I?Array.from(nt(D,v=>I[v]).values()):[D];if(U)for(const v of O)v.sort(U);for(const v of O){let L=0,F=0;a&&v.reverse();for(const m of v){const A=j[m];A<0?L=_[m]=(b[m]=L)+A:A>0?F=_[m]=(b[m]=F)+A:_[m]=b[m]=F}}B.push(O)}return s&&s(B,b,_,R),{data:h,facets:g}}),u,f,l]}function Ht(e){if(e!=null){if(typeof e=="function")return e;switch(`${e}`.toLowerCase()){case"expand":case"normalize":return Nt;case"center":case"silhouette":return Qt;case"wiggle":return it}throw new Error(`unknown offset: ${e}`)}}function at(e,n){let t=0,r=0;for(const s of e){const o=n[s];o<t&&(t=o),o>r&&(r=o)}return[t,r]}function Nt(e,n,t){for(const r of e)for(const s of r){const[o,a]=at(s,t);for(const c of s){const i=1/(a-o||1);n[c]=i*(n[c]-o),t[c]=i*(t[c]-o)}}}function Qt(e,n,t){for(const r of e){for(const s of r){const[o,a]=at(s,t);for(const c of s){const i=(a+o)/2;n[c]-=i,t[c]-=i}}ut(r,n,t)}ft(e,n,t)}function it(e,n,t,r){for(const s of e){const o=new ot;let a=0;for(const c of s){let i=-1;const u=c.map(l=>Math.abs(t[l]-n[l])),d=c.map(l=>{i=r?r[l]:++i;const y=t[l]-n[l],h=o.has(i)?y-o.get(i):0;return o.set(i,y),h}),f=[0,...Lt(d)];for(const l of c)n[l]+=a,t[l]+=a;const p=C(u);p&&(a-=C(u,(l,y)=>(d[y]/2+f[y])*l)/p)}ut(s,n,t)}ft(e,n,t)}function ut(e,n,t){const r=S(e,s=>S(s,o=>n[o]));for(const s of e)for(const o of s)n[o]-=r,t[o]-=r}function ft(e,n,t){const r=e.length;if(r===1)return;const s=e.map(c=>c.flat()),o=s.map(c=>(S(c,i=>n[i])+xt(c,i=>t[i]))/2),a=S(o);for(let c=0;c<r;c++){const i=a-o[c];for(const u of s[c])n[u]+=i,t[u]+=i}}function Zt(e,n,t){if(e===void 0&&n===it)return Z(M);if(e!=null){if(typeof e=="string"){const r=e.startsWith("-"),s=r?_t:M;switch((r?e.slice(1):e).toLowerCase()){case"value":case t:return Jt(s);case"z":return Yt(s);case"sum":return tn(s);case"appearance":return nn(s);case"inside-out":return Z(s)}return J(At(e))}if(typeof e=="function")return(e.length===1?J:en)(e);if(st(e))return rn(e);throw new Error(`invalid order: ${e}`)}}function Jt(e){return(n,t,r)=>(s,o)=>e(r[s],r[o])}function Yt(e){return(n,t,r,s)=>(o,a)=>e(s[o],s[a])}function tn(e){return E(e,(n,t,r,s)=>X(T(n),o=>C(o,a=>r[a]),o=>s[o]))}function nn(e){return E(e,(n,t,r,s)=>X(T(n),o=>t[ct(o,a=>r[a])],o=>s[o]))}function Z(e){return E(e,(n,t,r,s)=>{const o=T(n),a=X(o,f=>t[ct(f,p=>r[p])],f=>s[f]),c=tt(o,f=>C(f,p=>r[p]),f=>s[f]),i=[],u=[];let d=0;for(const f of a)d<0?(d+=c.get(f),i.push(f)):(d-=c.get(f),u.push(f));return u.reverse().concat(i)})}function J(e){return n=>{const t=k(n,e);return(r,s)=>M(t[r],t[s])}}function en(e){return n=>st(n)?(t,r)=>e(n[t],n[r]):(t,r)=>e(n.get(t),n.get(r))}function rn(e){return E(M,()=>e)}function E(e,n){return(t,r,s,o)=>{if(!o)throw new Error("missing channel: z");const a=new ot(n(t,r,s,o).map((c,i)=>[c,i]));return(c,i)=>e(a.get(o[c]),a.get(o[i]))}}const sn={ariaLabel:"bar"};class on extends Et{constructor(n,t,r={},s=sn){super(n,t,r,s),It(this,r),Ot(this,r)}render(n,t,r,s,o){const{rx:a,ry:c,rx1y1:i,rx1y2:u,rx2y1:d,rx2y2:f}=this,p=this._x(t,r,s),l=this._y(t,r,s),y=this._width(t,r,s),h=this._height(t,r,s);return Ft("svg:g",o).call(Tt,this,s,o).call(this._transform,this,t).call(g=>g.selectAll().data(n).enter().call(i||u||d||f?x=>x.append("path").call(P,this).call(Xt,p,l,Y(p,y),Y(l,h),this).call(V,this,r):x=>x.append("rect").call(P,this).attr("x",p).attr("width",y).attr("y",l).attr("height",h).call(G,"rx",a).call(G,"ry",c).call(V,this,r))).node()}_x(n,{x:t},{marginLeft:r}){const{insetLeft:s}=this;return t?o=>t[o]+s:r+s}_y(n,{y:t},{marginTop:r}){const{insetTop:s}=this;return t?o=>t[o]+s:r+s}_width({x:n},{x:t},{marginRight:r,marginLeft:s,width:o}){const{insetLeft:a,insetRight:c}=this,i=t&&n?n.bandwidth():o-r-s;return Math.max(0,i-a-c)}_height({y:n},{y:t},{marginTop:r,marginBottom:s,height:o}){const{insetTop:a,insetBottom:c}=this,i=t&&n?n.bandwidth():o-r-s;return Math.max(0,i-a-c)}}function Y(e,n){return typeof e=="function"&&typeof n=="function"?t=>e(t)+n(t):typeof e=="function"?t=>e(t)+n:typeof n=="function"?t=>e+n(t):e+n}class cn extends on{constructor(n,t={},r){const{x:s,y1:o,y2:a}=t;super(n,{y1:{value:o,scale:"y"},y2:{value:a,scale:"y"},x:{value:s,scale:"x",type:"band",optional:!0}},t,r)}_transform(n,t,{y:r}){n.call(St,t,{y:r},0,0)}_y({y:n},{y1:t,y2:r},{marginTop:s}){const{insetTop:o}=this;return q(n)?s+o:a=>Math.min(t[a],r[a])+o}_height({y:n},{y1:t,y2:r},{marginTop:s,marginBottom:o,height:a}){const{insetTop:c,insetBottom:i}=this;return q(n)?a-s-o-c-i:u=>Math.max(0,Math.abs(r[u]-t[u])-c-i)}}function un(e,n={}){return kt(n)||(n={...n,x:Ct,y2:et}),new cn(e,qt(Mt(Wt(n))))}const fn=jt({__name:"MPlot",props:{options:{}},setup(e){const n=e,t=H(),r=H();let s;N(()=>{t.value&&(r.value=t.value.clientWidth,s=new ResizeObserver(()=>{r.value=t.value?.clientWidth}),s.observe(t.value))}),Rt(()=>{s&&s.disconnect()});const o=Q(()=>{const c={};return c.width=r.value,c.style={fill:"#737373",fontFamily:'ui-sans-serif, system-ui, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji"'},{...c,...n.options}}),a=Q(()=>Ut(o.value));return zt(a,c=>{t.value&&(t.value.innerHTML="",t.value.append(c))}),N(()=>{t.value?.append(a.value)}),(c,i)=>(Dt(),Bt("div",{ref_key:"container",ref:t},null,512))}});export{fn as _,un as b};
