import{d as R,E as w,H as x,c as y,e as h,o as t,f as n,w as r,j as u,k as c,a as s,m,y as B,D as T,x as g,B as _,A as b,b as M,t as p,ad as E,F,bx as G}from"./index-B-VT6L6o.js";import{M as o,a as l}from"./metaListUtils-B-xQ0HnD.js";import{g as $,a as j}from"./offers-Dp3_UdYq.js";import{_ as V}from"./MetaActivablePhaseBadge.vue_vue_type_script_setup_true_lang-CRWiJBnG.js";import{_ as z}from"./MetaActivablesBaseCard.vue_vue_type_script_setup_true_lang-B4qXSmal.js";const U={key:0},H={key:1},q={key:0,class:"tw-ml-1"},J={key:1,class:"ml-1"},K={key:2},Q={key:0,class:"tw-italic tw-text-neutral-400"},W={key:1},X={key:2,class:"tw-italic tw-text-neutral-400"},Y={key:3,class:"tw-italic tw-text-neutral-400"},Z={key:1,class:"tw-italic tw-text-neutral-400"},I={key:2,class:"tw-italic tw-text-neutral-400"},ee={key:1,class:"tw-italic tw-text-neutral-400"},te={key:2,class:"tw-italic tw-text-neutral-400"},ae={key:0,class:"tw-text-neutral-400"},le=R({__name:"OfferGroupsCard",props:{title:{},emptyMessage:{},hideDisabled:{type:Boolean},hideConversion:{type:Boolean},hidePlacement:{type:Boolean},hidePriority:{type:Boolean},hideRevenue:{type:Boolean},playerId:{},customEvaluationIsoDateTime:{},placement:{},longList:{type:Boolean},hideCollapse:{type:Boolean},defaultSortOption:{}},setup(O){const d=O,{data:S}=w(x()),C=y(()=>S.value?.activablesMetadata),k=y(()=>C.value?.categories.OfferGroup.shortSingularDisplayName),{data:f,refresh:D}=w(()=>d.playerId?$(d.playerId,d.customEvaluationIsoDateTime):j(d.customEvaluationIsoDateTime)),P=y(()=>f.value?{OfferGroup:{activables:Object.fromEntries(Object.entries(f.value.offerGroups).filter(([i,e])=>!d.placement||e.config.placement===d.placement))}}:null),N=["activable.config.displayName","activable.config.description","phaseDisplayString"],A=y(()=>{const a=[o.asUnsorted(),new o("Priority","activable.config.priority",l.Ascending),new o("Priority","activable.config.priority",l.Descending),new o("Phase","phaseSortOrder",l.Ascending),new o("Phase","phaseSortOrder",l.Descending),new o("Name","activable.config.displayName",l.Ascending),new o("Name","activable.config.displayName",l.Descending)];return d.hideConversion||(a.push(new o("Conversion","conversion",l.Ascending)),a.push(new o("Conversion","conversion",l.Descending))),d.hideRevenue||(a.push(new o("Revenue","activable.revenue",l.Ascending)),a.push(new o("Revenue","activable.revenue",l.Descending))),a});return(a,i)=>(t(),h(z,{hideDisabled:a.hideDisabled,hideConversion:a.hideConversion,activables:P.value,playerId:a.playerId,category:"OfferGroup",longList:a.longList,emptyMessage:a.emptyMessage,title:a.title,hideCollapse:a.hideCollapse,linkUrlPrefix:"/offerGroups",searchFields:N,sortOptions:A.value,defaultSortOption:a.defaultSortOption,permission:"api.activables.view",onRefreshActivables:n(D)},{additionalTexts:r(({item:e})=>[a.hidePlacement?m("",!0):(t(),s("div",U,"Placement: "+p(e.activable.config.placement),1)),a.hidePriority?m("",!0):(t(),s("div",H,[i[0]||(i[0]=c("Priority:",-1)),e.activable.config.priority>0?(t(),s("span",q,p(n(G)(e.activable.config.priority)),1)):(t(),s("span",J,p(e.activable.config.priority),1))])),a.hideRevenue?m("",!0):(t(),s("div",K,"Revenue: $"+p(e.activable.revenue.toFixed(2)),1))]),collapseContents:r(({item:e})=>[u(n(g),{condensed:""},{"top-right":r(()=>[e.activable.config.activableParams.isEnabled?e.nextPhase?(t(),s("span",W,[u(V,{activable:e.activable,phase:e.nextPhase,playerId:a.playerId,typeName:`${k.value?.toLocaleLowerCase()}`},null,8,["activable","phase","playerId","typeName"]),i[1]||(i[1]=c()),e.nextPhaseStartTime?(t(),h(n(B),{key:0,instant:n(T).fromISO(e.nextPhaseStartTime)},null,8,["instant"])):m("",!0)])):e.scheduleStatus?(t(),s("span",X,"None")):(t(),s("span",Y,"No schedule")):(t(),s("span",Q,"Disabled"))]),default:r(()=>[i[2]||(i[2]=c("Next Schedule Phase",-1))],void 0,!0),_:2,__:[2]},1024),u(n(g),{condensed:""},{"top-right":r(()=>[e.activable.state.hasOngoingActivation&&e.activable.state.activationRemaining!==null?(t(),h(n(_),{key:0,duration:n(b)(e.activable.state.activationRemaining),showAs:"humanizedSentenceCase"},null,8,["duration"])):e.activable.state.hasOngoingActivation?(t(),s("span",Z,"Forever")):(t(),s("span",I,"n/a"))]),default:r(()=>[i[3]||(i[3]=c("Lifetime Left",-1))],void 0,!0),_:2,__:[3]},1024),u(n(g),{condensed:""},{"top-right":r(()=>[e.activable.state.isInCooldown&&e.activable.state.cooldownRemaining!==null?(t(),h(n(_),{key:0,duration:n(b)(e.activable.state.cooldownRemaining),showAs:"humanizedSentenceCase"},null,8,["duration"])):e.activable.state.isInCooldown?(t(),s("span",ee,"Forever")):(t(),s("span",te,"n/a"))]),default:r(()=>[i[4]||(i[4]=c("Cooldown Left",-1))],void 0,!0),_:2,__:[4]},1024),u(n(g),{condensed:""},{"top-right":r(()=>[(t(!0),s(F,null,M(e.activable.offers,(v,L)=>(t(),s("div",{key:L},[c(p(v.config.displayName)+" ",1),v.referencePrice!==null?(t(),s("span",ae,"("+p(v.referencePrice)+")",1)):m("",!0),c(" - "+p(n(E)(v.state.numPurchasedInGroup,"purchase",!0)),1)]))),128))]),default:r(()=>[i[5]||(i[5]=c("Individual Offers",-1))],void 0,!0),_:2,__:[5]},1024)]),_:1},8,["hideDisabled","hideConversion","activables","playerId","longList","emptyMessage","title","hideCollapse","sortOptions","defaultSortOption","onRefreshActivables"]))}});export{le as _};
