import{d as P,c as j,bH as L,e as l,o as i,f as e,w as a,j as n,s as Y,m as _,bl as M,v as U,x as g,k as d,y as N,D as C,t as S,q as m,_ as B,a as h,B as $,z as E,I as z,ae as q,h as k,K as J,bs as Q,ci as X,ad as Z,E as F,e7 as ee}from"./index-B-VT6L6o.js";import{_ as te,a as ae}from"./LiveOpsEventFormModalButton.vue_vue_type_script_setup_true_lang-BoTPyDB_.js";import oe from"./MetaListCard-CeJPPsYv.js";import{d as K}from"./debounce-B6LajIyo.js";import{_ as ie}from"./MActionModalButton.vue_vue_type_script_setup_true_lang-CzHe6hW1.js";import{_ as ne}from"./MInputSingleFileContents.vue_vue_type_script_setup_true_lang-CgnKBW1n.js";import{_ as se}from"./MInputSingleSelectSwitch.vue_vue_type_script_setup_true_lang-CetibaW-.js";import{C as re}from"./CoreUiPlacement-CjMnxsui.js";import{_ as le}from"./GameServerEventTimeline.vue_vue_type_script_setup_true_lang-ekzPvPX4.js";import{b as ue,a as de}from"./liveOpsEvents-e5xOesDH.js";import{M as pe}from"./MSingleColumnLayout-Bc4oHrRo.js";import{_ as H}from"./MRawDataCard.vue_vue_type_script_setup_true_lang-DhJnJrxb.js";import{_ as ve,a as me}from"./MViewContainer.vue_vue_type_script_setup_true_lang-sbviMV0h.js";import"./MInputTextArea.vue_vue_type_script_setup_true_lang-CaKBOzTC.js";import"./MInputHintMessage.vue_vue_type_script_setup_true_lang-CBCiJKqn.js";import"./actionDebouncer-D31HA7Ay.js";import"./axiosActionHandler-DT2wb6Ky.js";import"./MetaGeneratedForm.vue_vue_type_script_setup_true_lang-DQCVqnhW.js";import"./GeneratedUiFormDynamicComponent.vue_vue_type_script_setup_true_lang-DFWvQe41.js";import"./MInputMultiSelectCheckbox.vue_vue_type_script_setup_true_lang-DB0nHSfN.js";import"./MInputCheckbox.vue_vue_type_script_setup_true_lang-x_WXETV5.js";import"./MInputSingleSelectDropdown.vue_vue_type_script_setup_true_lang-Dv81Anyh.js";import"./PlayerSegmentsInput.vue_vue_type_script_setup_true_lang-CPg3Ztz0.js";import"./numberUtils-CkF0oMe2.js";import"./MInputToggleGroup.vue_vue_type_script_setup_true_lang-AjXCbOkF.js";import"./MInputSwitch.vue_vue_type_script_setup_true_lang-jCyUDcM1.js";import"./MInputText.vue_vue_type_script_setup_true_lang-Dfga_g5u.js";import"./MInputDuration.vue_vue_type_script_setup_true_lang-B-nZ-aUD.js";import"./MInputNumber.vue_vue_type_script_setup_true_lang-CZUuOOV2.js";import"./index-FJT0vWS8.js";import"./MInputDateTime.vue_vue_type_script_setup_true_lang-C6JS_loc.js";import"./metaListUtils-B-xQ0HnD.js";import"./utils-3nJB3c7R.js";import"./_baseIteratee-BEmxe7KQ.js";import"./isSymbol-BpirMJeh.js";import"./identity-DKeuBCMA.js";import"./MInputSingleSelectRadio.vue_vue_type_script_setup_true_lang-zO3FqeNb.js";import"./index-llZsRYZ2.js";import"./button-group-Bl0hWwU-.js";import"./MActionModal.vue_vue_type_script_setup_true_lang-DbjMhR13.js";import"./index-D9XvAc_V.js";import"./MInputSingleFile-CNXgN5gF.js";import"./MAbbreviateNumber.vue_vue_type_script_setup_true_lang-B4a9hmVO.js";var T=(p=>(p.Disallow="Disallow",p.Overwrite="Overwrite",p.KeepOld="KeepOld",p))(T||{}),G=(p=>(p.ConflictError="ConflictError",p.GeneralError="GeneralError",p.CreateNew="CreateNew",p.OverwriteExisting="OverwriteExisting",p.IgnoreDueToExisting="IgnoreDueToExisting",p))(G||{});const ce={key:0},fe={key:1,class:"tw-italic tw-text-neutral-500"},we={key:0},ge={key:1,class:"tw-italic tw-text-neutral-500"},_e={key:0},be={key:1,class:"tw-italic tw-text-neutral-500"},ye={key:0},he={key:1,class:"tw-italic tw-text-neutral-500"},R=P({__name:"LiveOpsEventImportListCard",props:{listMode:{},isImportValid:{type:Boolean},importResults:{}},setup(p){const I=p,O=j(()=>{if(I.importResults===void 0)return;if(I.importResults.length===0)return[];const r=I.importResults.map(s=>{const u=f(s.diagnostics);return{...s,badgeVariant:x(s.outcome,u),badgeText:w[s.outcome].badgeName,displayError:D(s.outcome,u)}}),o={danger:0,warning:1,success:2,primary:3,neutral:4};return r.sort((s,u)=>o[s.badgeVariant]-o[u.badgeVariant])});function f(r){return Object.values(r).flatMap(o=>o)}const w={ConflictError:{message:"The event cannot be imported because an event already exists with the same ID.",variant:"danger",badgeName:"Conflict"},GeneralError:{message:"The event cannot be imported due to an error. More details can be found below.",variant:"danger",badgeName:"Error"},CreateNew:{message:"The import will cause a new event to be created in this environment, but there are warnings that you might want to take into consideration.",variant:"success",badgeName:"Create New"},OverwriteExisting:{message:"The import will overwrite the existing event in this environment.",variant:"warning",badgeName:"Overwrite"},IgnoreDueToExisting:{message:"The import will be ignored because the event already exists in this environment.",variant:"warning",badgeName:"Keep Old"}};function x(r,o){return r===G.CreateNew&&o.some(s=>s.level==="Warning")?"warning":w[r].variant}function D(r,o){if(o.length>0){const t=new L(w[r].badgeName,w[r].message),s={Error:0,Warning:1,Info:2,Uneditable:3};return o.sort((u,y)=>s[u.level]-s[y.level]).forEach(u=>{t.addDetail(u.level,u.message??"No reason provided.")}),t}else return}return(r,o)=>(i(),l(e(oe),{title:r.listMode==="preview"?"Import Preview":"Import Results",dangerous:!r.isImportValid,"item-list":O.value,"page-size":r.listMode==="preview"?4:6,"empty-message":"No results available to preview yet."},{"item-card":a(({item:t})=>[n(e(Y),{"extra-m-list-item-margin":"","hide-collapse":r.listMode==="result"},{header:a(()=>[n(e(g),{"no-left-padding":""},z({"bottom-left":a(()=>[d(S(t.eventId),1)]),"top-right":a(()=>[n(e(B),{variant:t.badgeVariant},{default:a(()=>[d(S(t.badgeText),1)],void 0,!0),_:2},1032,["variant"])]),default:a(()=>[t?.eventInfo?.displayName?(i(),h("span",ce,S(t?.eventInfo?.displayName),1)):(i(),h("span",fe,"No Name Available"))],void 0,!0),_:2},[r.listMode==="result"&&r.isImportValid?{name:"bottom-right",fn:a(()=>[n(e(q),{to:`/liveOpsEvents/${t.eventId}`},{default:a(()=>o[0]||(o[0]=[d("View event",-1)]),void 0,!0),_:2,__:[0]},1032,["to"])]),key:"0"}:void 0]),1024)]),default:a(()=>[t.displayError?(i(),l(e(M),{key:0,class:"tw-mb-3",error:t.displayError},null,8,["error"])):_("",!0),t.eventInfo?(i(),l(e(U),{key:1,"show-border":"",striped:""},{default:a(()=>[n(e(g),{condensed:""},{"top-right":a(()=>[n(e(N),{instant:e(C).fromISO(t.eventInfo.createdAt),showAs:"dateTime"},null,8,["instant"])]),default:a(()=>[o[1]||(o[1]=d("Created At",-1))],void 0,!0),_:2,__:[1]},1024),n(e(g),{condensed:""},{"top-right":a(()=>[d(S(t.eventInfo.eventTypeName),1)]),default:a(()=>[o[2]||(o[2]=d("Event Type",-1))],void 0,!0),_:2,__:[2]},1024),t.eventInfo.useSchedule?_("",!0):(i(),l(e(g),{key:0,condensed:""},{"top-right":a(()=>o[3]||(o[3]=[m("span",{class:"tw-italic tw-text-neutral-500"},"None",-1)])),default:a(()=>[o[4]||(o[4]=d("Schedule",-1))],void 0,!0),_:1,__:[4]})),t.eventInfo.useSchedule?(i(),l(e(g),{key:1,condensed:""},{"top-right":a(()=>[n(e(B),null,{default:a(()=>[d(S(t.eventInfo.schedule?.isPlayerLocalTime?"Player Local":"UTC"),1)],void 0,!0),_:2},1024)]),default:a(()=>[o[5]||(o[5]=d("Time Mode",-1))],void 0,!0),_:2,__:[5]},1024)):_("",!0),t.eventInfo.useSchedule?(i(),l(e(g),{key:2,condensed:""},{"top-right":a(()=>[t.eventInfo.schedule?.enabledStartTime?(i(),l(e(N),{key:0,instant:e(C).fromISO(t.eventInfo.schedule.enabledStartTime),"disable-tooltip":t.eventInfo.schedule?.isPlayerLocalTime,showAs:"dateTime"},null,8,["instant","disable-tooltip"])):_("",!0)]),default:a(()=>[o[6]||(o[6]=d("Start Time",-1))],void 0,!0),_:2,__:[6]},1024)):_("",!0),t.eventInfo.useSchedule?(i(),l(e(g),{key:3,condensed:""},{"top-right":a(()=>[t.eventInfo.schedule?.enabledEndTime?(i(),l(e(N),{key:0,instant:e(C).fromISO(t.eventInfo.schedule.enabledEndTime),"disable-tooltip":t.eventInfo.schedule?.isPlayerLocalTime,showAs:"dateTime"},null,8,["instant","disable-tooltip"])):_("",!0)]),default:a(()=>[o[7]||(o[7]=d("End Time",-1))],void 0,!0),_:2,__:[7]},1024)):_("",!0),t.eventInfo.useSchedule?(i(),l(e(g),{key:4,condensed:""},{"top-right":a(()=>[t.eventInfo.schedule?.previewDuration&&t.eventInfo.schedule?.previewDuration!=="P0Y0M0DT0H0M0S"?(i(),h("span",we,[n(e($),{duration:e(E).fromISO(t.eventInfo.schedule.previewDuration)},null,8,["duration"])])):(i(),h("span",ge,"None"))]),default:a(()=>[o[8]||(o[8]=d("Preview duration",-1))],void 0,!0),_:2,__:[8]},1024)):_("",!0),t.eventInfo?.useSchedule?(i(),l(e(g),{key:5,condensed:""},{"top-right":a(()=>[t.eventInfo.schedule?.previewDuration&&t.eventInfo.schedule?.endingSoonDuration!=="P0Y0M0DT0H0M0S"?(i(),h("span",_e,[n(e($),{duration:e(E).fromISO(t.eventInfo.schedule.endingSoonDuration)},null,8,["duration"])])):(i(),h("span",be,"None"))]),default:a(()=>[o[9]||(o[9]=d("Ending Soon Duration",-1))],void 0,!0),_:2,__:[9]},1024)):_("",!0),t.eventInfo.useSchedule?(i(),l(e(g),{key:6,condensed:""},{"top-right":a(()=>[t.eventInfo.schedule?.reviewDuration&&t.eventInfo.schedule?.reviewDuration!=="P0Y0M0DT0H0M0S"?(i(),h("span",ye,[n(e($),{duration:e(E).fromISO(t.eventInfo?.schedule?.reviewDuration)},null,8,["duration"])])):(i(),h("span",he,"None"))]),default:a(()=>[o[10]||(o[10]=d("Review Duration",-1))],void 0,!0),_:2,__:[10]},1024)):_("",!0)],void 0,!0),_:2},1024)):(i(),l(e(U),{key:2,"show-border":"",striped:""},{default:a(()=>[n(e(g),{condensed:""},{default:a(()=>o[11]||(o[11]=[m("span",{class:"tw-italic tw-text-neutral-500"},"No event info available",-1)]),void 0,!0),_:1,__:[11]})],void 0,!0),_:1}))],void 0,!0),_:2},1032,["hide-collapse"])]),_:1},8,["title","dangerous","item-list","page-size"]))}}),Ie={class:"tw-space-y-4"},De=P({__name:"LiveOpsEventActionImport",setup(p){const I=Q();function O(){f.value=void 0,D.value=T.Disallow,s.value=[]}const f=k();function w(v){x(v),s.value=void 0,u.value=[],y.value=!1}const x=K(v=>{f.value===v&&(f.value=void 0),f.value=v},300),D=k(T.Disallow),r=[{value:T.Disallow,label:"Disallow"},{value:T.Overwrite,label:"Overwrite"},{value:T.KeepOld,label:"Keep Old"}];function o(v){t(v),s.value=void 0,u.value=[],y.value=!1}const t=K(v=>{D.value=v},300);J([f,D],async()=>{await V(!0)},{deep:!0});const s=k([]),u=k([]),y=k(!1);async function V(v){if(f.value){const c={validateOnly:v,conflictPolicy:D.value,package:f.value},b=(await I.post("/importLiveOpsEvents",c)).data;s.value=b.eventResults,u.value=b.generalDiagnostics,y.value=b.isValid}else s.value=[],u.value=[]}const A=j(()=>{if(u.value.length>0){const v=u.value.length,c=new L("Validation Failed",`There ${X(v,"was","were")} ${Z(v,"error",!0)} while validating the import file.`,"Error");return u.value.forEach(b=>{c.addDetail(b.level,b.message??"No reason provided.")}),c}else return}),W=new L("Import Failed",`This is most likely because the server state changed between validation and import.
  The events listed below have not been imported and no server state was changed by this operation.`,"Error");return(v,c)=>(i(),l(e(ie),{"modal-title":"Import LiveOps Events",action:()=>V(!1),"trigger-button-label":"Import","ok-button-label":"Import Events","ok-button-disabled-tooltip":y.value?void 0:"Upload a valid file to proceed.",permission:"api.liveops_events.import","trigger-button-full-width":"",onShow:O},{default:a(()=>[m("div",Ie,[c[2]||(c[2]=m("div",null,"You can import LiveOps Events into this environment by uploading a LiveOps Event JSON file. This allows you to move events between environments.",-1)),n(e(ne),{"model-value":f.value,label:"Upload a File","accepted-file-types":".json","onUpdate:modelValue":c[0]||(c[0]=b=>w(b))},null,8,["model-value"]),n(e(se),{class:"tw-mt-3","model-value":D.value,label:"Conflict Policy",options:r,"onUpdate:modelValue":c[1]||(c[1]=b=>o(b))},null,8,["model-value"]),c[3]||(c[3]=m("div",{class:"tw-space-y-0.5 tw-text-xs tw-text-neutral-500"},[m("p",null,"Conflict policy determines how to deal with conflicting events during import:"),m("p",null,[m("span",{class:"tw-font-semibold"},"Disallow"),d(" - Duplicate events will not be allowed.")]),m("p",null,[m("span",{class:"tw-font-semibold"},"Overwrite"),d(" - Duplicate events will overwrite existing ones.")]),m("p",null,[m("span",{class:"tw-font-semibold"},"Keep Old"),d(" - Duplicate events will be ignored.")])],-1))])]),"right-panel":a(()=>[A.value?(i(),l(e(M),{key:0,error:A.value},null,8,["error"])):(i(),l(R,{key:1,"list-mode":"preview","is-import-valid":y.value,"import-results":s.value},null,8,["is-import-valid","import-results"]))]),"result-panel":a(()=>[y.value?_("",!0):(i(),l(e(M),{key:0,class:"tw-mb-3",error:e(W)},null,8,["error"])),n(R,{"list-mode":"result","is-import-valid":y.value,"import-results":s.value},null,8,["is-import-valid","import-results"])]),_:1},8,["action","ok-button-disabled-tooltip"]))}}),mt=P({__name:"LiveOpsEventListView",setup(p){const{data:I}=F(ue()),{data:O}=F(de());return(f,w)=>(i(),l(e(me),{permission:"api.liveops_events.view","full-width":""},{overview:a(()=>[n(e(ve),{title:"LiveOps Events","data-testid":"live-ops-event-list-overview-card"},{buttons:a(()=>[n(te,{"form-mode":"create"}),n(De),n(ae)]),default:a(()=>[w[0]||(w[0]=m("p",{class:"tw-mb-1"},"LiveOps Events are dynamic in-game events that you can create and manage on this page.",-1)),w[1]||(w[1]=m("p",{class:"tw-text-xs tw-text-neutral-500"},"LiveOps Events are under active development and not yet feature-complete. They are safe to use in production but the UI and underlying API will change over the next few releases as we continue to work on them.",-1))],void 0,!0),_:1,__:[0,1]})]),default:a(()=>[n(le,{class:"tw-mb-4","start-expanded":"","initial-expanded-data-sources":[e(ee)]},null,8,["initial-expanded-data-sources"]),n(re,{class:"tw-mx-auto tw-max-w-6xl",placementId:"LiveOpsEvents/List"}),n(e(pe),null,{default:a(()=>[n(e(H),{data:e(I),label:"liveOpsEventsData"},null,8,["data"]),n(e(H),{data:e(O),label:"liveOpsEventTypesData"},null,8,["data"])],void 0,!0),_:1})]),_:1}))}});export{mt as default};
