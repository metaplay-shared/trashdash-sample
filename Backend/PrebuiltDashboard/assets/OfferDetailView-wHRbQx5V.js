import{d as V,by as B,c7 as R,E as I,c as _,r as v,e as d,o as f,w as t,j as i,f as a,x as q,I as E,q as g,_ as j,k as l,t as u,ae as W,m as z,U as c,ad as y}from"./index-jY1EWd09.js";import{a as N}from"./numberUtils-CkF0oMe2.js";import{M as b,a as x,b as H,c as O}from"./metaListUtils-B-xQ0HnD.js";import{r as J}from"./rewardUtils-DXeMkd5o.js";import{_ as K}from"./PlayerConditionsCard.vue_vue_type_script_setup_true_lang-B5TAo8AR.js";import{_ as Q}from"./SegmentsCard.vue_vue_type_script_setup_true_lang-bDQVBVkC.js";import{b as X}from"./offers-DBtp9gqX.js";import{_ as Y}from"./MTabLayout.vue_vue_type_script_setup_true_lang-B1ekLQtC.js";import{_ as A}from"./MTwoColumnLayout.vue_vue_type_script_setup_true_lang-B5zJm1QQ.js";import{M as Z}from"./MSingleColumnLayout-BSf_YwiY.js";import{_ as h}from"./MRawDataCard.vue_vue_type_script_setup_true_lang-Db7v8Vrj.js";import{_ as tt,a as et}from"./MViewContainer.vue_vue_type_script_setup_true_lang-C_1W2rCL.js";import"./MetaAudienceSizeEstimate.vue_vue_type_script_setup_true_lang-wU-8cgN7.js";import"./MAbbreviateNumber.vue_vue_type_script_setup_true_lang-C_9AAI8F.js";import"./MInputSingleSelectDropdown.vue_vue_type_script_setup_true_lang-CqJL3vnO.js";import"./MInputHintMessage.vue_vue_type_script_setup_true_lang-CYiRxbPX.js";const it={class:"font-weight-bold"},at={class:"font-weight-bold tw-mb-1"},lt={class:"font-weight-bold tw-mb-1"},rt={class:"tw-ml-1"},Tt=V({__name:"OfferDetailView",setup(ot){const T=B();if(T.params.id===void 0)throw new Error("id route param is required.");const F=R(T.params.id),{data:o,error:G}=I(X(F)),$=_(()=>{const s=o.value.statistics.numActivatedForFirstTime,e=o.value.statistics.numPurchasedForFirstTime;return s===0?0:e/s*100}),C=_(()=>{const s=o.value.statistics.numActivatedForFirstTime,e=o.value.statistics.numPurchasedForFirstTime;return s===0?"Not activated by any players yet.":`Activated by ${N(s)} players and purchased by ${N(e)}.`}),M=_(()=>J(o.value.config.rewards??[])),U=_(()=>o.value.usedBy.map(s=>{switch(s.type){case"OfferGroup":return{type:s.type,displayName:s.displayName,icon:"tags",linkUrl:`/offerGroups/offerGroup/${s.id}`,linkText:"Offer Group"};case"Offer":return{type:s.type,displayName:s.displayName,icon:"tags",linkUrl:`/offerGroups/offer/${s.id}`,linkText:"Offer"};default:return{type:s.type,displayName:s.displayName,icon:"question-circle",linkUrl:"",linkText:""}}})),L=[new b("Type","type",x.Ascending),new b("Type","type",x.Descending),new b("Name","displayName",x.Ascending),new b("Name","displayName",x.Descending)],D=_(()=>[new H("type",[new O("Offer Groups",s=>s.type==="OfferGroup"),new O("Offers",s=>s.type==="Offer")].sort((s,e)=>{const p=s.displayName.toUpperCase(),r=e.displayName.toUpperCase();return p<r?-1:p>r?1:0}))]);return(s,e)=>{const p=v("fa-icon"),r=v("b-td"),n=v("b-tr"),w=v("b-tbody"),P=v("b-table-simple"),S=v("meta-reward-badge"),k=v("meta-list-card");return f(),d(a(et),{"is-loading":!a(o),error:a(G),permission:"api.activables.view","full-width":""},{overview:t(()=>[i(a(tt),{id:a(o).config.offerId,title:a(o).config.displayName,subtitle:a(o).config.description,"data-testid":"offer-detail-overview-card"},{default:t(()=>[g("span",it,[i(p,{icon:"chart-bar"}),e[0]||(e[0]=l(" Overview",-1))]),i(P,{small:"",responsive:""},{default:t(()=>[i(w,null,{default:t(()=>[i(n,null,{default:t(()=>[i(r,null,{default:t(()=>[...e[1]||(e[1]=[l("In App Product",-1)])],void 0,!0),_:1}),a(o).config.inAppProduct!==null?(f(),d(r,{key:0,class:"text-right"},{default:t(()=>[l(u(a(o).config.inAppProduct),1)],void 0,!0),_:1})):(f(),d(r,{key:1,class:"text-right text-muted tw-italic"},{default:t(()=>[...e[2]||(e[2]=[l("None",-1)])],void 0,!0),_:1}))],void 0,!0),_:1}),a(o).referencePrice!==null?(f(),d(n,{key:0},{default:t(()=>[i(r,null,{default:t(()=>[...e[3]||(e[3]=[l("Reference Price",-1)])],void 0,!0),_:1}),i(r,{class:"text-right"},{default:t(()=>[l(u(a(o).referencePrice),1)],void 0,!0),_:1})],void 0,!0),_:1})):z("",!0)],void 0,!0),_:1})],void 0,!0),_:1}),g("div",at,[i(p,{icon:"times"}),e[4]||(e[4]=l(" Limits",-1))]),i(P,{small:"",responsive:""},{default:t(()=>[i(w,null,{default:t(()=>[i(n,null,{default:t(()=>[i(r,null,{default:t(()=>[...e[5]||(e[5]=[l("Max Activations",-1)])],void 0,!0),_:1}),a(o).config.maxActivationsPerPlayer===null?(f(),d(r,{key:0,class:"text-right text-muted tw-italic"},{default:t(()=>[...e[6]||(e[6]=[l("Unlimited",-1)])],void 0,!0),_:1})):(f(),d(r,{key:1,class:"text-right"},{default:t(()=>[l(u(a(o).config.maxActivationsPerPlayer),1)],void 0,!0),_:1}))],void 0,!0),_:1}),i(n,null,{default:t(()=>[i(r,null,{default:t(()=>[...e[7]||(e[7]=[l("Max Total Purchases",-1)])],void 0,!0),_:1}),a(o).config.maxPurchasesPerPlayer===null?(f(),d(r,{key:0,class:"text-right text-muted tw-italic"},{default:t(()=>[...e[8]||(e[8]=[l("Unlimited",-1)])],void 0,!0),_:1})):(f(),d(r,{key:1,class:"text-right"},{default:t(()=>[l(u(a(o).config.maxPurchasesPerPlayer),1)],void 0,!0),_:1}))],void 0,!0),_:1}),i(n,null,{default:t(()=>[i(r,null,{default:t(()=>[...e[9]||(e[9]=[l("Max Total Purchases Per Offer Group",-1)])],void 0,!0),_:1}),a(o).config.maxPurchasesPerOfferGroup===null?(f(),d(r,{key:0,class:"text-right text-muted tw-italic"},{default:t(()=>[...e[10]||(e[10]=[l("Unlimited",-1)])],void 0,!0),_:1})):(f(),d(r,{key:1,class:"text-right"},{default:t(()=>[l(u(a(o).config.maxPurchasesPerOfferGroup),1)],void 0,!0),_:1}))],void 0,!0),_:1}),i(n,null,{default:t(()=>[i(r,null,{default:t(()=>[...e[11]||(e[11]=[l("Max Purchases Per Activation",-1)])],void 0,!0),_:1}),a(o).config.maxPurchasesPerActivation===null?(f(),d(r,{key:0,class:"text-right text-muted tw-italic"},{default:t(()=>[...e[12]||(e[12]=[l("Unlimited",-1)])],void 0,!0),_:1})):(f(),d(r,{key:1,class:"text-right"},{default:t(()=>[l(u(a(o).config.maxPurchasesPerActivation),1)],void 0,!0),_:1}))],void 0,!0),_:1})],void 0,!0),_:1})],void 0,!0),_:1}),g("div",lt,[i(p,{icon:"chart-line"}),e[13]||(e[13]=l(" Statistics",-1))]),i(P,{small:"",responsive:""},{default:t(()=>[i(w,null,{default:t(()=>[i(n,null,{default:t(()=>[i(r,null,{default:t(()=>[i(a(c),{content:"Total value across all offer groups."},{default:t(()=>[...e[14]||(e[14]=[l("Global",-1)])],void 0,!0),_:1}),e[15]||(e[15]=l(" Seen by",-1))],void 0,!0),_:1}),i(r,{class:"text-right"},{default:t(()=>[l(u(a(y)(a(o).statistics.numActivatedForFirstTime,"player",!0)),1)],void 0,!0),_:1})],void 0,!0),_:1}),i(n,null,{default:t(()=>[i(r,null,{default:t(()=>[i(a(c),{content:"Total value across all offer groups."},{default:t(()=>[...e[16]||(e[16]=[l("Global",-1)])],void 0,!0),_:1}),e[17]||(e[17]=l(" Purchased by",-1))],void 0,!0),_:1}),i(r,{class:"text-right"},{default:t(()=>[l(u(a(y)(a(o).statistics.numPurchasedForFirstTime,"player",!0)),1)],void 0,!0),_:1})],void 0,!0),_:1}),i(n,null,{default:t(()=>[i(r,null,{default:t(()=>[i(a(c),{content:"Total value across all offer groups."},{default:t(()=>[...e[18]||(e[18]=[l("Global",-1)])],void 0,!0),_:1}),e[19]||(e[19]=l(" Conversion",-1))],void 0,!0),_:1}),i(r,{class:"text-right"},{default:t(()=>[i(a(c),{content:C.value},{default:t(()=>[l(u($.value.toFixed(0))+"%",1)],void 0,!0),_:1},8,["content"])],void 0,!0),_:1})],void 0,!0),_:1}),i(n,null,{default:t(()=>[i(r,null,{default:t(()=>[e[21]||(e[21]=l("Total ",-1)),i(a(c),{content:"Total value across all offer groups."},{default:t(()=>[...e[20]||(e[20]=[l("Global",-1)])],void 0,!0),_:1}),e[22]||(e[22]=l(" Seen Count",-1))],void 0,!0),_:1}),i(r,{class:"text-right"},{default:t(()=>[l(u(a(y)(a(o).statistics.numActivated,"time",!0)),1)],void 0,!0),_:1})],void 0,!0),_:1}),i(n,null,{default:t(()=>[i(r,null,{default:t(()=>[e[24]||(e[24]=l("Total ",-1)),i(a(c),{content:"Total value across all offer groups."},{default:t(()=>[...e[23]||(e[23]=[l("Global",-1)])],void 0,!0),_:1}),e[25]||(e[25]=l(" Purchased Count",-1))],void 0,!0),_:1}),i(r,{class:"text-right"},{default:t(()=>[l(u(a(y)(a(o).statistics.numPurchased,"time",!0)),1)],void 0,!0),_:1})],void 0,!0),_:1}),i(n,null,{default:t(()=>[i(r,null,{default:t(()=>[e[27]||(e[27]=l("Total ",-1)),i(a(c),{content:"Total value across all offer groups."},{default:t(()=>[...e[26]||(e[26]=[l("Global",-1)])],void 0,!0),_:1}),e[28]||(e[28]=l(" Revenue",-1))],void 0,!0),_:1}),i(r,{class:"text-right"},{default:t(()=>[l("$"+u(a(o).statistics.revenue.toFixed(2)),1)],void 0,!0),_:1})],void 0,!0),_:1})],void 0,!0),_:1})],void 0,!0),_:1})],void 0,!0),_:1},8,["id","title","subtitle"])]),default:t(()=>[i(a(Y),{tabs:[{label:"Configuration"},{label:"Targeting"}]},{"tab-0":t(()=>[i(a(A),null,{default:t(()=>[i(k,{title:"Contents","item-list":M.value,"list-layout":"flex","data-testid":"offer-detail-contents-card"},{"item-card":t(m=>[i(S,{reward:m.item},null,8,["reward"])]),_:1},8,["item-list"]),i(k,{title:"Referenced by",icon:"exchange-alt","item-list":U.value,"filter-sets":D.value,"sort-options":L,"search-fields":["displayName","type"],"empty-message":"No offer groups or other offers reference this offer.","data-testid":"offer-detail-references-card"},{"item-card":t(({item:m})=>[i(a(q),null,E({default:t(()=>[i(a(j),null,{icon:t(()=>[i(p,{icon:m.icon},null,8,["icon"])]),default:t(()=>[l(u(m.type),1)],void 0,!0),_:2},1024),g("span",rt,u(m.displayName),1)],void 0,!0),_:2},[m.linkUrl?{name:"top-right",fn:t(()=>[i(a(W),{to:m.linkUrl},{default:t(()=>[l("View "+u(`${m.linkText.toLocaleLowerCase()}`),1)],void 0,!0),_:2},1032,["to"])]),key:"0"}:void 0]),1024)]),_:1},8,["item-list","filter-sets"])],void 0,!0),_:1})]),"tab-1":t(()=>[i(a(A),null,{default:t(()=>[i(Q,{segments:a(o).config.segments,"owner-title":"This offer"},null,8,["segments"]),i(K,{"player-conditions":a(o).config.additionalConditions},null,8,["player-conditions"])],void 0,!0),_:1})]),_:1}),i(a(Z),{class:"tw-max-w-6xl"},{default:t(()=>[i(a(h),{data:a(o),label:"singleOfferData"},null,8,["data"])],void 0,!0),_:1})]),_:1},8,["is-loading","error"])}}});export{Tt as default};
