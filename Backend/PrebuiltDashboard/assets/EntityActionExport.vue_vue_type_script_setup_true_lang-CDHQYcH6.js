import{d as k,h,c as E,r as N,e as c,o as n,f as s,w as m,j as r,a7 as _,q as a,a as d,k as u,t as p,bk as S,m as $,a6 as D,bs as z,bG as A}from"./index-jY1EWd09.js";import{a as C}from"./utils-B01yCWQ7.js";import{_ as K}from"./MActionModalButton.vue_vue_type_script_setup_true_lang-CTycXHot.js";import{_ as b}from"./MAbbreviateNumber.vue_vue_type_script_setup_true_lang-C_9AAI8F.js";const O={class:"tw-mb-1"},B={key:0},L={class:"code-box tw-rounded-md tw-border tw-border-neutral-200 tw-bg-neutral-100 tw-p-2 tw-text-neutral-600"},V={key:0,class:"tw-max-h-52 tw-text-wrap","data-testid":"export-payload"},T={key:1,class:"tw-m-2 tw-animate-pulse"},j={key:0,class:"tw-mt-2 tw-w-full tw-text-right tw-text-xs tw-text-neutral-500"},v=3e5,P=k({__name:"EntityActionExport",props:{entityId:{},entityKindName:{},displayName:{},entitiesToExport:{},allowDebugExport:{type:Boolean}},setup(o){const w=o,f=z(),e=h(),i=E(()=>C(e.value));async function x(){e.value=void 0;const t={entities:w.entitiesToExport,allowExportOnFailure:w.allowDebugExport};e.value=JSON.stringify((await f.post("/entityArchive/export",t)).data)}function y(){if(e.value){const l=`${w.entityId.replace(":","_")}.export`;A(e.value,l)}}return(l,t)=>{const g=N("fa-icon");return n(),c(s(K),{"modal-title":`Export ${o.entityKindName}`,action:y,"trigger-button-label":`Export ${o.entityKindName}`,variant:"danger","ok-button-label":"Download","ok-button-disabled-tooltip":e.value?void 0:"No data to export.","disable-safety-lock":"",permission:"api.entity_archive.export",onShow:t[0]||(t[0]=F=>x()),"data-testid":`export-${o.entityKindName.toLowerCase()}`},{default:m(()=>[_(l.$slots,"default"),a("h6",O,[u("Serialized "+p(o.entityKindName)+" Data",1),r(s(S),{class:"tw-ml-1",contents:e.value,disabled:i.value>=v,"data-testid":`copy-${o.entityKindName.toLowerCase()}-to-clipboard`},null,8,["contents","disabled","data-testid"])]),i.value<v?(n(),d("div",B,[a("div",L,[e.value?(n(),d("pre",V,p(e.value),1)):(n(),d("div",T,[...t[1]||(t[1]=[a("div",{class:"tw-mb-2 tw-h-4 tw-w-11/12 tw-rounded tw-bg-neutral-200"},null,-1),a("div",{class:"tw-mb-2 tw-h-4 tw-w-9/12 tw-rounded tw-bg-neutral-200"},null,-1),a("div",{class:"tw-mb-2 tw-h-4 tw-w-11/12 tw-rounded tw-bg-neutral-200"},null,-1),a("div",{class:"tw-mb-2 tw-h-4 tw-w-9/12 tw-rounded tw-bg-neutral-200"},null,-1),a("div",{class:"tw-mb-2 tw-h-4 tw-w-11/12 tw-rounded tw-bg-neutral-200"},null,-1)])]))]),e.value?(n(),d("div",j,[t[2]||(t[2]=u("Export archive size: ",-1)),r(s(b),{number:i.value,unit:"byte"},null,8,["number"])])):$("",!0)])):(n(),c(s(D),{key:1,class:"tw--4",title:"Export Preview Disabled"},{default:m(()=>[a("p",null,[t[3]||(t[3]=u("Export preview and copying disabled because of its large size of ",-1)),r(s(b),{number:i.value,unit:"byte"},null,8,["number"]),t[4]||(t[4]=u("! You can still download the data ðŸ‘",-1))]),t[5]||(t[5]=a("p",{class:"tw-text-sm tw-text-orange-800"},"Some OS & browser combinations are known to have performance issues parsing large blobs of data. Let us know if you are using one of them and we'll figure it out!",-1))],void 0,!0),_:1}))]),"ok-button-icon":m(()=>[r(g,{class:"tw-mb-[0.05rem] tw-h-3.5 tw-w-4",icon:"file-download"})]),_:3},8,["modal-title","trigger-button-label","ok-button-disabled-tooltip","data-testid"])}}});export{P as _};
