import{d as S,h as _,E as x,c as k,ad as f,r as C,a as r,o as l,e as b,j as u,f as t,bD as N,w as s,q as c,T as H,k as o,t as v,m as I,_ as y,F as M,bs as U,bt as B}from"./index-jY1EWd09.js";import{g as O}from"./localization-TVVxfgEw.js";import{_ as T}from"./MInputCheckbox.vue_vue_type_script_setup_true_lang-Bzg4Lkt_.js";import{_ as D}from"./MInputHintMessage.vue_vue_type_script_setup_true_lang-CYiRxbPX.js";import{_ as E}from"./MActionModal.vue_vue_type_script_setup_true_lang-CihjvaoM.js";const F={key:1,class:"tw-inline-flex tw-h-4 tw-w-5",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 640 512"},R={key:0,class:"tw-mb-3"},Y={key:1},j={key:2},q={class:"tw-font-semibold"},Q=S({__name:"LocalizationActionArchive",props:{localizationId:{},triggerStyle:{}},setup(A){const w=U(),h=A,m=_(!1),p=_(),{data:d,refresh:V}=x(O()),a=k(()=>{if(d.value)return d.value.find(e=>e.id===h.localizationId)}),n=k(()=>{const e=d.value?.find(i=>i.id===h.localizationId);return e?(d.value??[]).filter(i=>!i.isArchived&&!(i.publishedAt!==null||i.unpublishedAt!==null||i.isActive)&&i.buildStartedAt<e.buildStartedAt).map(i=>i.id):[]});`${f(n.value?.length,"older, unpublished localizations.",!0)}`;const{showSuccessNotification:g}=B();async function $(){const e={isArchived:!a.value?.isArchived};await w.post(`/localization/${h.localizationId}`,e),m.value&&n.value.length>0?(await w.post("/localization/archive",n.value),g(`Archived ${n.value.length+1} localizations.`)):g(`Localization ${e.isArchived?"archived":"unarchived"}.`),V()}return(e,i)=>{const L=C("fa-icon");return l(),r(M,null,[A.triggerStyle=="icon"?(l(),b(t(N),{key:0,permission:"api.localization.edit","aria-label":a.value?.isArchived?"Unarchive this localization":"Archive this localization.","disabled-tooltip":a.value?.isActive?"Cannot archive the active localization.":void 0,onClick:i[0]||(i[0]=z=>p.value?.open()),"data-testid":"`archive-localization-${localizationId}`"},{default:s(()=>[a.value?.isArchived?(l(),r("svg",F,[...i[3]||(i[3]=[c("path",{d:"M256 48c0-26.5 21.5-48 48-48H592c26.5 0 48 21.5 48 48V464c0 26.5-21.5 48-48 48H381.3c1.8-5 2.7-10.4 2.7-16V253.3c18.6-6.6 32-24.4 32-45.3V176c0-26.5-21.5-48-48-48H256V48zM571.3 347.3c6.2-6.2 6.2-16.4 0-22.6l-64-64c-6.2-6.2-16.4-6.2-22.6 0l-64 64c-6.2 6.2-6.2 16.4 0 22.6s16.4 6.2 22.6 0L480 310.6V432c0 8.8 7.2 16 16 16s16-7.2 16-16V310.6l36.7 36.7c6.2 6.2 16.4 6.2 22.6 0zM0 176c0-8.8 7.2-16 16-16H368c8.8 0 16 7.2 16 16v32c0 8.8-7.2 16-16 16H16c-8.8 0-16-7.2-16-16V176zm352 80V480c0 17.7-14.3 32-32 32H64c-17.7 0-32-14.3-32-32V256H352zM144 320c-8.8 0-16 7.2-16 16s7.2 16 16 16h96c8.8 0 16-7.2 16-16s-7.2-16-16-16H144z"},null,-1)])])):(l(),b(L,{key:0,class:"tw-relative -tw-bottom-[3px] tw-h-4 tw-w-4",icon:"box-archive"}))],void 0,!0),_:1},8,["aria-label","disabled-tooltip"])):(l(),b(t(H),{key:1,permission:"api.localization.edit","disabled-tooltip":a.value?.isActive?"Cannot archive the active localization.":void 0,onClick:i[1]||(i[1]=z=>p.value?.open())},{default:s(()=>[o(v(a.value?.isArchived?"Unarchive":"Archive"),1)],void 0,!0),_:1},8,["disabled-tooltip"])),u(t(E),{ref_key:"localizationArchiveModal",ref:p,title:a.value?.isArchived?"Unarchive Localization":"Archive Localization",action:$,"ok-button-label":a.value?.isArchived?"Unarchive":"Archive","data-testid":"`archive-localization-${localizationId}`"},{default:s(()=>[a.value?.isArchived?(l(),r("div",Y,[c("p",null,[i[7]||(i[7]=o("You are about to unarchive the localization ",-1)),u(t(y),null,{default:s(()=>[o(v(a.value?.name||"No Name Available"),1)],void 0,!0),_:1}),i[8]||(i[8]=o(".",-1))]),i[9]||(i[9]=c("p",{class:"tw-mt-1 tw-text-xs+ tw-text-neutral-500"},"This will make the localization visible in the list of available localizations again.",-1))])):(l(),r("div",R,[c("p",null,[i[4]||(i[4]=o("You are about to archive the localization ",-1)),u(t(y),null,{default:s(()=>[o(v(a.value?.name||"No Name Available"),1)],void 0,!0),_:1}),i[5]||(i[5]=o(".",-1))]),i[6]||(i[6]=c("p",{class:"tw-mt-1 tw-text-xs+ tw-text-neutral-500"},"Archiving a localization will hide it from the list of available localizations. An archived localization can be unarchived at any time.",-1))])),!a.value?.isArchived&&n.value?.length>0?(l(),r("div",j,[u(t(T),{"model-value":m.value,size:"small","onUpdate:modelValue":i[2]||(i[2]=z=>m.value=z)},{default:s(()=>[c("p",q,"Also Archive "+v(t(f)(n.value?.length,"Older, Unpublished Localization",!0)),1)],void 0,!0),_:1},8,["model-value"]),u(t(D),null,{default:s(()=>[o("At the same time as archiving this localization, you can also archive "+v(t(f)(n.value?.length,"older, unpublished localization",!0))+". This is useful in keeping your localization history manageable.",1)],void 0,!0),_:1})])):I("",!0),i[10]||(i[10]=c("p",{class:"tw-mt-3"},"All good?",-1))],void 0,!0),_:1},8,["title","ok-button-label"])],64)}}});export{Q as _};
