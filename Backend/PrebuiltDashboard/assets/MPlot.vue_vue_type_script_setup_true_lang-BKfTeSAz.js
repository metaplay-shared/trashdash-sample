import{d5 as K,d6 as w,d7 as tt,d8 as nt,d9 as et,da as lt,db as rt,dc as W,dd as dt,de as ht,df as pt,dg as yt,dh as mt,di as gt,dj as vt,dk as $,dl as wt,dm as st,dn as ot,dp as C,dq as k,dr as M,ds as E,dt as xt,du as bt,dv as _t,dw as At,dx as j,dy as kt,dz as Ct,dA as Mt,dB as Et,dC as q,dD as It,dE as Ft,dF as Ot,dG as St,dH as jt,dI as G,dJ as zt,dK as H,dL as P,d as Bt,h as J,i as N,co as Dt,c as V,dM as Lt,K as Tt,a as Xt,o as Rt}from"./index-jY1EWd09.js";function Ut(e,n){var t=0;return Float64Array.from(e,r=>t+=+r||0)}function z(e,n,t){return(n.length!==2?K(tt(e,n,t),([r,s],[o,a])=>w(s,a)||w(r,o)):K(nt(e,t),([r,s],[o,a])=>n(s,a)||w(r,o))).map(([r])=>r)}function ct(e,n=w){let t,r=!1;if(n.length===1){let s;for(const o of e){const a=n(o);(r?w(a,s)>0:w(a,a)===0)&&(t=o,s=a,r=!0)}}else for(const s of e)(r?n(s,t)>0:n(s,s)===0)&&(t=s,r=!0);return t}function Kt(e={},n="y"){return lt(e)?e:{...e,[n]:et}}function Wt(e,n){if(n.length===1)return{data:e,facets:n};const t=rt(e),r=new Uint8Array(t);let s=0;for(const c of n)for(const i of c)r[i]&&++s,r[i]=1;if(s===0)return{data:e,facets:n};e=W(e);const o=e[dt]=new Uint32Array(t+s);n=n.map(c=>W(c,Uint32Array));let a=t;r.fill(0);for(const c of n)for(let i=0,u=c.length;i<u;++i){const d=c[i];r[d]?(c[i]=a,e[a]=e[d],o[a]=d,++a):o[d]=d,r[d]=1}return{data:e,facets:n}}function $t(e={},n={}){arguments.length===1&&([e,n]=Gt(e));const{x1:t,x:r=t,y:s,...o}=n,[a,c,i,u]=Pt(r,s,"x","y",e,o);return{...a,x1:t,x:c,y1:i,y2:u,y:mt(i,u)}}function qt({y:e,y1:n,y2:t,...r}={}){return r=ht(r,"x"),n===void 0&&t===void 0?$t({y:e,...r}):([n,t]=pt(e,n,t),{...r,y1:n,y2:t})}function Gt(e){const{offset:n,order:t,reverse:r,...s}=e;return[{offset:n,order:t,reverse:r},s]}const Ht={length:!0};function Pt(e,n=yt,t,r,{offset:s,order:o,reverse:a},c){if(n===null)throw new Error(`stack requires ${r}`);const i=gt(c),[u,d]=vt(e),[f,p]=$(n),[l,y]=$(n);return f.hint=l.hint=Ht,s=Jt(s),o=Qt(o,s,r),[wt(c,(h,g,x)=>{({data:h,facets:g}=Wt(h,g));const F=e==null?void 0:d(bt(k(h,e),x?.[t])),B=k(h,n,Float64Array),D=k(h,i),L=o&&o(h,F,B,D),T=rt(h),b=p(new Float64Array(T)),_=y(new Float64Array(T)),X=[];for(const R of g){const O=F?Array.from(nt(R,v=>F[v]).values()):[R];if(L)for(const v of O)v.sort(L);for(const v of O){let U=0,S=0;a&&v.reverse();for(const m of v){const A=B[m];A<0?U=_[m]=(b[m]=U)+A:A>0?S=_[m]=(b[m]=S)+A:_[m]=b[m]=S}}X.push(O)}return s&&s(X,b,_,D),{data:h,facets:g}}),u,f,l]}function Jt(e){if(e!=null){if(typeof e=="function")return e;switch(`${e}`.toLowerCase()){case"expand":case"normalize":return Nt;case"center":case"silhouette":return Vt;case"wiggle":return it}throw new Error(`unknown offset: ${e}`)}}function at(e,n){let t=0,r=0;for(const s of e){const o=n[s];o<t&&(t=o),o>r&&(r=o)}return[t,r]}function Nt(e,n,t){for(const r of e)for(const s of r){const[o,a]=at(s,t);for(const c of s){const i=1/(a-o||1);n[c]=i*(n[c]-o),t[c]=i*(t[c]-o)}}}function Vt(e,n,t){for(const r of e){for(const s of r){const[o,a]=at(s,t);for(const c of s){const i=(a+o)/2;n[c]-=i,t[c]-=i}}ut(r,n,t)}ft(e,n,t)}function it(e,n,t,r){for(const s of e){const o=new ot;let a=0;for(const c of s){let i=-1;const u=c.map(l=>Math.abs(t[l]-n[l])),d=c.map(l=>{i=r?r[l]:++i;const y=t[l]-n[l],h=o.has(i)?y-o.get(i):0;return o.set(i,y),h}),f=[0,...Ut(d)];for(const l of c)n[l]+=a,t[l]+=a;const p=C(u);p&&(a-=C(u,(l,y)=>(d[y]/2+f[y])*l)/p)}ut(s,n,t)}ft(e,n,t)}function ut(e,n,t){const r=E(e,s=>E(s,o=>n[o]));for(const s of e)for(const o of s)n[o]-=r,t[o]-=r}function ft(e,n,t){const r=e.length;if(r===1)return;const s=e.map(c=>c.flat()),o=s.map(c=>(E(c,i=>n[i])+xt(c,i=>t[i]))/2),a=E(o);for(let c=0;c<r;c++){const i=a-o[c];for(const u of s[c])n[u]+=i,t[u]+=i}}function Qt(e,n,t){if(e===void 0&&n===it)return Q(M);if(e!=null){if(typeof e=="string"){const r=e.startsWith("-"),s=r?_t:M;switch((r?e.slice(1):e).toLowerCase()){case"value":case t:return Zt(s);case"z":return Yt(s);case"sum":return tn(s);case"appearance":return nn(s);case"inside-out":return Q(s)}return Z(At(e))}if(typeof e=="function")return(e.length===1?Z:en)(e);if(st(e))return rn(e);throw new Error(`invalid order: ${e}`)}}function Zt(e){return(n,t,r)=>(s,o)=>e(r[s],r[o])}function Yt(e){return(n,t,r,s)=>(o,a)=>e(s[o],s[a])}function tn(e){return I(e,(n,t,r,s)=>z(j(n),o=>C(o,a=>r[a]),o=>s[o]))}function nn(e){return I(e,(n,t,r,s)=>z(j(n),o=>t[ct(o,a=>r[a])],o=>s[o]))}function Q(e){return I(e,(n,t,r,s)=>{const o=j(n),a=z(o,f=>t[ct(f,p=>r[p])],f=>s[f]),c=tt(o,f=>C(f,p=>r[p]),f=>s[f]),i=[],u=[];let d=0;for(const f of a)d<0?(d+=c.get(f),i.push(f)):(d-=c.get(f),u.push(f));return u.reverse().concat(i)})}function Z(e){return n=>{const t=k(n,e);return(r,s)=>M(t[r],t[s])}}function en(e){return n=>st(n)?(t,r)=>e(n[t],n[r]):(t,r)=>e(n.get(t),n.get(r))}function rn(e){return I(M,()=>e)}function I(e,n){return(t,r,s,o)=>{if(!o)throw new Error("missing channel: z");const a=new ot(n(t,r,s,o).map((c,i)=>[c,i]));return(c,i)=>e(a.get(o[c]),a.get(o[i]))}}const sn={ariaLabel:"bar"};class on extends It{constructor(n,t,r={},s=sn){super(n,t,r,s),Ft(this,r),Ot(this,r)}render(n,t,r,s,o){const{rx:a,ry:c,rx1y1:i,rx1y2:u,rx2y1:d,rx2y2:f}=this,p=this._x(t,r,s),l=this._y(t,r,s),y=this._width(t,r,s),h=this._height(t,r,s);return St("svg:g",o).call(jt,this,s,o).call(this._transform,this,t).call(g=>g.selectAll().data(n).enter().call(i||u||d||f?x=>x.append("path").call(G,this).call(zt,p,l,Y(p,y),Y(l,h),this).call(H,this,r):x=>x.append("rect").call(G,this).attr("x",p).attr("width",y).attr("y",l).attr("height",h).call(P,"rx",a).call(P,"ry",c).call(H,this,r))).node()}_x(n,{x:t},{marginLeft:r}){const{insetLeft:s}=this;return t?o=>t[o]+s:r+s}_y(n,{y:t},{marginTop:r}){const{insetTop:s}=this;return t?o=>t[o]+s:r+s}_width({x:n},{x:t},{marginRight:r,marginLeft:s,width:o}){const{insetLeft:a,insetRight:c}=this,i=t&&n?n.bandwidth():o-r-s;return Math.max(0,i-a-c)}_height({y:n},{y:t},{marginTop:r,marginBottom:s,height:o}){const{insetTop:a,insetBottom:c}=this,i=t&&n?n.bandwidth():o-r-s;return Math.max(0,i-a-c)}}function Y(e,n){return typeof e=="function"&&typeof n=="function"?t=>e(t)+n(t):typeof e=="function"?t=>e(t)+n:typeof n=="function"?t=>e+n(t):e+n}class cn extends on{constructor(n,t={},r){const{x:s,y1:o,y2:a}=t;super(n,{y1:{value:o,scale:"y"},y2:{value:a,scale:"y"},x:{value:s,scale:"x",type:"band",optional:!0}},t,r)}_transform(n,t,{y:r}){n.call(Et,t,{y:r},0,0)}_y({y:n},{y1:t,y2:r},{marginTop:s}){const{insetTop:o}=this;return q(n)?s+o:a=>Math.min(t[a],r[a])+o}_height({y:n},{y1:t,y2:r},{marginTop:s,marginBottom:o,height:a}){const{insetTop:c,insetBottom:i}=this;return q(n)?a-s-o-c-i:u=>Math.max(0,Math.abs(r[u]-t[u])-c-i)}}function un(e,n={}){return kt(n)||(n={...n,x:Ct,y2:et}),new cn(e,qt(Mt(Kt(n))))}const fn=Bt({__name:"MPlot",props:{options:{}},setup(e){const n=e,t=J(),r=J();let s;N(()=>{t.value&&(r.value=t.value.clientWidth,s=new ResizeObserver(()=>{r.value=t.value?.clientWidth}),s.observe(t.value))}),Dt(()=>{s&&s.disconnect()});const o=V(()=>{const c={};return c.width=r.value,c.style={fill:"#737373",fontFamily:'ui-sans-serif, system-ui, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji"',overflow:"visible"},{...c,...n.options}}),a=V(()=>Lt(o.value));return Tt(a,c=>{t.value&&(t.value.innerHTML="",t.value.append(c))}),N(()=>{t.value?.append(a.value)}),(c,i)=>(Rt(),Xt("div",{ref_key:"container",ref:t},null,512))}});export{fn as _,un as b};
