import{d as E,E as F,c as L,af as U,h as V,r,e as c,o,w as a,j as l,a as p,m,q as y,k as _,f as e,ag as B,ah as M,a6 as W,y as k,D as w,t as g,U as f}from"./index-B-VT6L6o.js";import{g as O}from"./players-CbfgGr44.js";import{M as R}from"./MSingleColumnLayout-Bc4oHrRo.js";import{_ as j}from"./MRawDataCard.vue_vue_type_script_setup_true_lang-DhJnJrxb.js";import{a as q}from"./MViewContainer.vue_vue_type_script_setup_true_lang-sbviMV0h.js";const z={class:"tw-mb-1 tw-ml-2","data-testid":"player-search"},J={key:0},G={key:0,class:"pt-5 tw-w-full tw-text-center"},H={key:1},te=E({__name:"PlayerListView",setup(K){const{isDeveloperUiEnabled:h}=B(),{data:d,error:A}=F(O()),I=L(()=>{const t=[{key:"entityId",label:"ID"},{key:"displayName",label:"Name"},"level",{key:"createdAt",label:"Joined"}];return Math.max(document.documentElement.clientWidth||0,window.innerWidth||0)<576?x(t,["entityId","displayName"]):t});function x(t,n){return t.filter(i=>{let u;return typeof i=="string"?u=i:u=i.key,n.includes(u)})}const v=U(),b=V();async function N(t){b.value=t,await v.push(`/players/${t.id}`)}async function S(t){await v.push(`/players/${t.entityId}`)}function D(t,n){return!t||n!=="row"?"":t.deletionStatus.startsWith("Deleted")?"text-danger table-row-link":"table-row-link"}return(t,n)=>{const i=r("fa-icon"),u=r("meta-input-player-select"),P=r("b-col"),C=r("b-row"),$=r("b-spinner"),T=r("b-table");return o(),c(e(q),{"is-loading":!e(d),error:e(A)},{default:a(()=>[l(C,{class:"justify-content-center",style:{"margin-top":"8rem","margin-bottom":"7rem"}},{default:a(()=>[l(P,{md:"10",lg:"7",xl:"5"},{default:a(()=>[y("h4",z,[l(i,{icon:"search"}),n[0]||(n[0]=_(" Find a player",-1))]),l(u,{value:b.value,onInput:N},null,8,["value"])],void 0,!0),_:1})],void 0,!0),_:1}),e(h)?(o(),p("div",J,[e(d)?(o(),p("div",H,[l(e(R),null,{default:a(()=>[l(e(M),{title:"Recently Active Players","data-testid":"active-players-list"},{default:a(()=>[e(d).length===0?(o(),c(e(W),{key:0,title:"No recently active players",variant:"neutral"},{default:a(()=>n[1]||(n[1]=[_("No players have logged in since last server reboot.",-1)]),void 0,!0),_:1,__:[1]})):(o(),c(T,{key:1,class:"table-fixed-column",small:"",striped:"",hover:"",responsive:"",items:e(d),fields:I.value,"primary-key":"entityId","sort-by":"startAt","sort-desc":"","tbody-tr-class":D,onRowClicked:S},{"cell(entityId)":a(s=>[s.item.deletionStatus.startsWith("Deleted")?(o(),c(e(f),{key:0,class:"tw-mr-1",content:"Player has been deleted"},{default:a(()=>n[2]||(n[2]=[_("☠️",-1)]),void 0,!0),_:1,__:[2]})):m("",!0),y("span",null,g(s.item.entityId),1)]),"cell(displayName)":a(s=>[y("span",null,g(s.item.displayName),1),s.item.totalIapSpend>0?(o(),c(e(f),{key:0,class:"tw-ml-2",content:"Total IAP spend: $"+s.item.totalIapSpend.toFixed(2,2),noUnderline:""},{default:a(()=>[l(i,{class:"text-muted",icon:"money-check-alt"})],void 0,!0),_:2},1032,["content"])):m("",!0),s.item.isDeveloper?(o(),c(e(f),{key:1,class:"tw-ml-2",content:"This player is a developer.",noUnderline:""},{default:a(()=>[l(i,{class:"text-muted",icon:"user-astronaut",size:"sm"})],void 0,!0),_:1})):m("",!0)]),"cell(createdAt)":a(s=>[l(e(k),{instant:e(w).fromISO(s.item.createdAt)},null,8,["instant"])]),"cell(lastLoginAt)":a(s=>[l(e(k),{instant:e(w).fromISO(s.item.lastLoginAt)},null,8,["instant"])]),_:1},8,["items","fields"]))],void 0,!0),_:1})],void 0,!0),_:1})])):(o(),p("div",G,[l($,{class:"mt-5",label:"Loading..."})]))])):m("",!0),l(e(j),{data:e(d),label:"activePlayers"},null,8,["data"])],void 0,!0),_:1},8,["is-loading","error"])}}});export{te as default};
